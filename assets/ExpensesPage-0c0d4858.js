import{c as De,i as Ue,r as q,j as t,B as fe,n as He,D as Xe,o as ht,f as yt,H as vt,p as Re,C as oe,a as se,b as le,d as gt,e as ce}from"./index-4214a3df.js";import{u as xt,L as jt,T as bt,P as wt,C as St,a as Tt}from"./Pagination-31c0700a.js";import{L as ue,I as Ce,C as Ot}from"./label-d32a9f38.js";import{S as we,a as Se,b as Te,c as Oe,d as _e}from"./select-2a702a5a.js";import{D as Ye,a as _t,P as Nt,b as qe,c as Ge,d as Qe,e as Pt,f as kt}from"./dialog-03105fa9.js";import{W as Ie,B as Rt,S as Mt,a as Dt}from"./wallet-a614880b.js";import{C as Fe}from"./credit-card-af0ae2ab.js";import{F as Et}from"./CategoryChart-b3422b9e.js";import{s as Ct,e as It,C as Ft,a as Lt}from"./CompactHeader-d249c32c.js";import{E as At,C as Bt}from"./ExpenseTrendChart-e36c07a2.js";import{T as zt,a as Wt,b as Le,c as Ae}from"./tabs-9ad4c601.js";import{a as Be,b as ze,p as We,s as $t}from"./index-b30782cb.js";import{T as Ut}from"./trash-2-7dc5b03a.js";import"./generateCategoricalChart-79d1dc4c.js";import"./index-a53a69e9.js";import"./index-65722b09.js";import"./trending-down-89cc9c73.js";import"./Area-864fea91.js";import"./YAxis-c5bfaba1.js";const Ht=De("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),Xt=De("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),Yt=De("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function qt({onSubmit:R,expenseToEdit:S,onOpenChange:te,isOpen:x}){const{categories:o,paymentMethods:r}=Ue(),u=o.filter(e=>e.tipo==="gasto"),l=e=>({cartao_credito:Fe,cartao_debito:Fe,dinheiro:Rt,pix:Mt,transferencia:Dt,boleto:Et,outros:Ie})[e]||Ie,f={descricao:"",valor:"",categoria_id:"",meio_pagamento_id:"",recorrente:!1,pago:!1,data:new Date().toISOString().split("T")[0]},[c,h]=q.useState(f),[v,j]=q.useState(""),P=q.useRef(null),N=e=>{if(e==null||e==="")return"";const s=Number(e);return isNaN(s)?"":s.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})};q.useEffect(()=>{S!=null&&S.id?h({descricao:S.descricao||"",valor:N(S.valor),categoria_id:S.categoria_id||"",meio_pagamento_id:S.meio_pagamento_id||"",recorrente:S.recorrente||!1,pago:S.pago||!1,data:S.data?new Date(S.data).toISOString().split("T")[0]:f.data}):h(f),j("")},[S,x]),q.useEffect(()=>{var s;const e=(s=P.current)==null?void 0:s.input;if(e){const g=e.value.length;e.setSelectionRange(g,g)}},[c.valor]);const O=e=>{if(!e)return 0;const s=String(e).replace(/\./g,"").replace(",","."),g=parseFloat(s);return isNaN(g)?0:g},i=e=>{e.preventDefault();const s=O(c.valor);if(s<=0){j("Informe um valor válido maior que zero.");return}if(!c.categoria_id){j("Por favor, selecione uma categoria para a despesa.");return}R({...c,valor:s},S==null?void 0:S.id),n()},n=()=>{h(f),j("")},y=e=>{te(e),e||n()},a=e=>{h({...c,valor:e})};return t.jsxs(Ye,{open:x,onOpenChange:y,children:[!(S!=null&&S.id)&&t.jsx(_t,{asChild:!0,children:t.jsxs(fe,{children:[t.jsx(Nt,{className:"w-4 h-4 mr-2"}),"Nova Despesa"]})}),t.jsxs(qe,{className:"sm:max-w-md",children:[t.jsxs(Ge,{children:[t.jsxs(Qe,{className:"flex items-center gap-2",children:[t.jsx(He,{className:"w-5 h-5"}),S!=null&&S.id?"Editar Despesa":"Adicionar Despesa"]}),t.jsx(Pt,{children:S!=null&&S.id?"Atualize os detalhes da sua despesa.":"Registre uma nova despesa para controlar seus gastos."})]}),t.jsxs("form",{onSubmit:i,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(ue,{htmlFor:"description",children:"Descrição"}),t.jsx(Ce,{id:"description",placeholder:"Ex: Almoço no restaurante",value:c.descricao,onChange:e=>h({...c,descricao:e.target.value}),required:!0})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(ue,{htmlFor:"amount",children:"Valor (R$)"}),t.jsx(Ot,{id:"amount",placeholder:"0,00",value:c.valor,onChange:a,ref:P,required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(ue,{htmlFor:"date",children:"Data"}),t.jsx(Ce,{id:"date",type:"date",value:c.data,onChange:e=>h({...c,data:e.target.value}),required:!0})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(ue,{htmlFor:"category",children:"Categoria"}),u.length>0?t.jsxs(t.Fragment,{children:[t.jsxs(we,{value:c.categoria_id,onValueChange:e=>{h({...c,categoria_id:e}),j("")},children:[t.jsx(Se,{children:t.jsx(Te,{placeholder:"Selecione uma categoria"})}),t.jsx(Oe,{children:u.map(e=>t.jsx(_e,{value:e.id.toString(),children:e.nome},e.id))})]}),v&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:v})]}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhuma categoria de gasto disponível."})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(ue,{htmlFor:"paymentMethod",children:"Meio de Pagamento"}),r.length>0?t.jsxs(we,{value:c.meio_pagamento_id,onValueChange:e=>{h({...c,meio_pagamento_id:e})},children:[t.jsx(Se,{children:t.jsx(Te,{placeholder:"Selecione um meio de pagamento"})}),t.jsx(Oe,{children:r.map(e=>{const s=l(e.tipo);return t.jsx(_e,{value:e.id.toString(),children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:e.cor+"20"},children:t.jsx(s,{className:"w-3 h-3",style:{color:e.cor}})}),t.jsx("span",{children:e.nome})]})},e.id)})})]}):t.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum meio de pagamento disponível."})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"checkbox",id:"isRecurring",checked:c.recorrente,onChange:e=>h({...c,recorrente:e.target.checked}),className:"rounded accent-primary"}),t.jsxs(ue,{htmlFor:"isRecurring",className:"flex items-center gap-2 text-sm",children:[t.jsx(Xt,{className:"w-4 h-4"}),"Despesa recorrente"]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("input",{type:"checkbox",id:"isPaid",checked:c.pago,onChange:e=>h({...c,pago:e.target.checked}),className:"rounded accent-primary"}),t.jsxs(ue,{htmlFor:"isPaid",className:"flex items-center gap-2 text-sm",children:[t.jsx(Xe,{className:"w-4 h-4"}),"Despesa já paga"]})]})]}),t.jsx(fe,{type:"submit",className:"w-full",children:S!=null&&S.id?"Salvar Alterações":"Adicionar Despesa"})]})]})]})}var Je={exports:{}};(function(R,S){(function(x,o){R.exports=o(q)})(ht,function(te){return function(x){var o={};function r(u){if(o[u])return o[u].exports;var l=o[u]={i:u,l:!1,exports:{}};return x[u].call(l.exports,l,l.exports,r),l.l=!0,l.exports}return r.m=x,r.c=o,r.d=function(u,l,f){r.o(u,l)||Object.defineProperty(u,l,{configurable:!1,enumerable:!0,get:f})},r.n=function(u){var l=u&&u.__esModule?function(){return u.default}:function(){return u};return r.d(l,"a",l),l},r.o=function(u,l){return Object.prototype.hasOwnProperty.call(u,l)},r.p="/",r(r.s=11)}([function(x,o,r){(function(u){x.exports=r(16)()}).call(o,r(2))},function(x,o){x.exports=te},function(x,o){var r=x.exports={},u,l;function f(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?u=setTimeout:u=f}catch{u=f}try{typeof clearTimeout=="function"?l=clearTimeout:l=c}catch{l=c}})();function h(e){if(u===setTimeout)return setTimeout(e,0);if((u===f||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch{try{return u.call(null,e,0)}catch{return u.call(this,e,0)}}}function v(e){if(l===clearTimeout)return clearTimeout(e);if((l===c||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch{try{return l.call(null,e)}catch{return l.call(this,e)}}}var j=[],P=!1,N,O=-1;function i(){!P||!N||(P=!1,N.length?j=N.concat(j):O=-1,j.length&&n())}function n(){if(!P){var e=h(i);P=!0;for(var s=j.length;s;){for(N=j,j=[];++O<s;)N&&N[O].run();O=-1,s=j.length}N=null,P=!1,v(e)}}r.nextTick=function(e){var s=new Array(arguments.length-1);if(arguments.length>1)for(var g=1;g<arguments.length;g++)s[g-1]=arguments[g];j.push(new y(e,s)),j.length===1&&!P&&h(n)};function y(e,s){this.fun=e,this.array=s}y.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function a(){}r.on=a,r.addListener=a,r.once=a,r.off=a,r.removeListener=a,r.removeAllListeners=a,r.emit=a,r.prependListener=a,r.prependOnceListener=a,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(u){return u.reduce(function(l,f){return l+f})/u.length}},function(x,o,r){function u(f){return function(){return f}}var l=function(){};l.thatReturns=u,l.thatReturnsFalse=u(!1),l.thatReturnsTrue=u(!0),l.thatReturnsNull=u(null),l.thatReturnsThis=function(){return this},l.thatReturnsArgument=function(f){return f},x.exports=l},function(x,o,r){(function(u){function l(f,c,h,v,j,P,N,O){if(!f){var i;if(c===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var n=[h,v,j,P,N,O],y=0;i=new Error(c.replace(/%s/g,function(){return n[y++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}}x.exports=l}).call(o,r(2))},function(x,o,r){var u="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";x.exports=u},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(u){return Math.min.apply(Math,u)}},function(x,o,r){(function(u){var l=r(4),f=l;x.exports=f}).call(o,r(2))},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(u){return Math.max.apply(Math,u)}},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=r(3),l=f(u);function f(c){return c&&c.__esModule?c:{default:c}}o.default=function(c){var h=(0,l.default)(c),v=c.map(function(P){return Math.pow(P-h,2)}),j=(0,l.default)(v);return Math.sqrt(j)}},function(x,o,r){x.exports=r(12)},function(x,o,r){x.exports=r(13)},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.SparklinesText=o.SparklinesNormalBand=o.SparklinesReferenceLine=o.SparklinesSpots=o.SparklinesBars=o.SparklinesCurve=o.SparklinesLine=o.Sparklines=void 0;var u=function(){function D(T,C){for(var M=0;M<C.length;M++){var G=C[M];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(T,G.key,G)}}return function(T,C,M){return C&&D(T.prototype,C),M&&D(T,M),T}}(),l=r(0),f=E(l),c=r(1),h=E(c),v=r(17),j=E(v),P=r(18),N=E(P),O=r(19),i=E(O),n=r(20),y=E(n),a=r(21),e=E(a),s=r(22),g=E(s),b=r(27),_=E(b),B=r(28),Y=E(B);function E(D){return D&&D.__esModule?D:{default:D}}function J(D,T){if(!(D instanceof T))throw new TypeError("Cannot call a class as a function")}function Q(D,T){if(!D)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:D}function K(D,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);D.prototype=Object.create(T&&T.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(D,T):D.__proto__=T)}var V=function(D){K(T,D);function T(C){return J(this,T),Q(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,C))}return u(T,[{key:"render",value:function(){var M=this.props,G=M.data,ae=M.limit,p=M.width,m=M.height,I=M.svgWidth,W=M.svgHeight,F=M.preserveAspectRatio,$=M.margin,A=M.style,z=M.max,H=M.min;if(G.length===0)return null;var X=(0,Y.default)({data:G,limit:ae,width:p,height:m,margin:$,max:z,min:H}),L={style:A,viewBox:"0 0 "+p+" "+m,preserveAspectRatio:F};return I>0&&(L.width=I),W>0&&(L.height=W),h.default.createElement("svg",L,h.default.Children.map(this.props.children,function(ie){return h.default.cloneElement(ie,{data:G,points:X,width:p,height:m,margin:$})}))}}]),T}(c.PureComponent);V.propTypes={data:f.default.array,limit:f.default.number,width:f.default.number,height:f.default.number,svgWidth:f.default.number,svgHeight:f.default.number,preserveAspectRatio:f.default.string,margin:f.default.number,style:f.default.object,min:f.default.number,max:f.default.number,onMouseMove:f.default.func},V.defaultProps={data:[],width:240,height:60,preserveAspectRatio:"none",margin:2},o.Sparklines=V,o.SparklinesLine=N.default,o.SparklinesCurve=i.default,o.SparklinesBars=y.default,o.SparklinesSpots=e.default,o.SparklinesReferenceLine=g.default,o.SparklinesNormalBand=_.default,o.SparklinesText=j.default},function(x,o,r){(function(u){var l=r(4),f=r(5),c=r(8),h=r(6),v=r(15);x.exports=function(j,P){var N=typeof Symbol=="function"&&Symbol.iterator,O="@@iterator";function i(p){var m=p&&(N&&p[N]||p[O]);if(typeof m=="function")return m}var n="<<anonymous>>",y={array:g("array"),bool:g("boolean"),func:g("function"),number:g("number"),object:g("object"),string:g("string"),symbol:g("symbol"),any:b(),arrayOf:_,element:B(),instanceOf:Y,node:K(),objectOf:J,oneOf:E,oneOfType:Q,shape:V};function a(p,m){return p===m?p!==0||1/p===1/m:p!==p&&m!==m}function e(p){this.message=p,this.stack=""}e.prototype=Error.prototype;function s(p){function m(W,F,$,A,z,H,X){return A=A||n,H=H||$,X!==h&&P&&f(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types"),F[$]==null?W?F[$]===null?new e("The "+z+" `"+H+"` is marked as required "+("in `"+A+"`, but its value is `null`.")):new e("The "+z+" `"+H+"` is marked as required in "+("`"+A+"`, but its value is `undefined`.")):null:p(F,$,A,z,H)}var I=m.bind(null,!1);return I.isRequired=m.bind(null,!0),I}function g(p){function m(I,W,F,$,A,z){var H=I[W],X=C(H);if(X!==p){var L=M(H);return new e("Invalid "+$+" `"+A+"` of type "+("`"+L+"` supplied to `"+F+"`, expected ")+("`"+p+"`."))}return null}return s(m)}function b(){return s(l.thatReturnsNull)}function _(p){function m(I,W,F,$,A){if(typeof p!="function")return new e("Property `"+A+"` of component `"+F+"` has invalid PropType notation inside arrayOf.");var z=I[W];if(!Array.isArray(z)){var H=C(z);return new e("Invalid "+$+" `"+A+"` of type "+("`"+H+"` supplied to `"+F+"`, expected an array."))}for(var X=0;X<z.length;X++){var L=p(z,X,F,$,A+"["+X+"]",h);if(L instanceof Error)return L}return null}return s(m)}function B(){function p(m,I,W,F,$){var A=m[I];if(!j(A)){var z=C(A);return new e("Invalid "+F+" `"+$+"` of type "+("`"+z+"` supplied to `"+W+"`, expected a single ReactElement."))}return null}return s(p)}function Y(p){function m(I,W,F,$,A){if(!(I[W]instanceof p)){var z=p.name||n,H=ae(I[W]);return new e("Invalid "+$+" `"+A+"` of type "+("`"+H+"` supplied to `"+F+"`, expected ")+("instance of `"+z+"`."))}return null}return s(m)}function E(p){if(!Array.isArray(p))return l.thatReturnsNull;function m(I,W,F,$,A){for(var z=I[W],H=0;H<p.length;H++)if(a(z,p[H]))return null;var X=JSON.stringify(p);return new e("Invalid "+$+" `"+A+"` of value `"+z+"` "+("supplied to `"+F+"`, expected one of "+X+"."))}return s(m)}function J(p){function m(I,W,F,$,A){if(typeof p!="function")return new e("Property `"+A+"` of component `"+F+"` has invalid PropType notation inside objectOf.");var z=I[W],H=C(z);if(H!=="object")return new e("Invalid "+$+" `"+A+"` of type "+("`"+H+"` supplied to `"+F+"`, expected an object."));for(var X in z)if(z.hasOwnProperty(X)){var L=p(z,X,F,$,A+"."+X,h);if(L instanceof Error)return L}return null}return s(m)}function Q(p){if(!Array.isArray(p))return l.thatReturnsNull;for(var m=0;m<p.length;m++){var I=p[m];if(typeof I!="function")return c(!1,"Invalid argument supplid to oneOfType. Expected an array of check functions, but received %s at index %s.",G(I),m),l.thatReturnsNull}function W(F,$,A,z,H){for(var X=0;X<p.length;X++){var L=p[X];if(L(F,$,A,z,H,h)==null)return null}return new e("Invalid "+z+" `"+H+"` supplied to "+("`"+A+"`."))}return s(W)}function K(){function p(m,I,W,F,$){return D(m[I])?null:new e("Invalid "+F+" `"+$+"` supplied to "+("`"+W+"`, expected a ReactNode."))}return s(p)}function V(p){function m(I,W,F,$,A){var z=I[W],H=C(z);if(H!=="object")return new e("Invalid "+$+" `"+A+"` of type `"+H+"` "+("supplied to `"+F+"`, expected `object`."));for(var X in p){var L=p[X];if(L){var ie=L(z,X,F,$,A+"."+X,h);if(ie)return ie}}return null}return s(m)}function D(p){switch(typeof p){case"number":case"string":case"undefined":return!0;case"boolean":return!p;case"object":if(Array.isArray(p))return p.every(D);if(p===null||j(p))return!0;var m=i(p);if(m){var I=m.call(p),W;if(m!==p.entries){for(;!(W=I.next()).done;)if(!D(W.value))return!1}else for(;!(W=I.next()).done;){var F=W.value;if(F&&!D(F[1]))return!1}}else return!1;return!0;default:return!1}}function T(p,m){return p==="symbol"||m["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&m instanceof Symbol}function C(p){var m=typeof p;return Array.isArray(p)?"array":p instanceof RegExp?"object":T(m,p)?"symbol":m}function M(p){if(typeof p>"u"||p===null)return""+p;var m=C(p);if(m==="object"){if(p instanceof Date)return"date";if(p instanceof RegExp)return"regexp"}return m}function G(p){var m=M(p);switch(m){case"array":case"object":return"an "+m;case"boolean":case"date":case"regexp":return"a "+m;default:return m}}function ae(p){return!p.constructor||!p.constructor.name?n:p.constructor.name}return y.checkPropTypes=v,y.PropTypes=y,y}}).call(o,r(2))},function(x,o,r){(function(u){function l(f,c,h,v,j){}x.exports=l}).call(o,r(2))},function(x,o,r){var u=r(4),l=r(5),f=r(6);x.exports=function(){function c(j,P,N,O,i,n){n!==f&&l(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}c.isRequired=c;function h(){return c}var v={array:c,bool:c,func:c,number:c,object:c,string:c,symbol:c,any:c,arrayOf:h,element:c,instanceOf:h,node:c,objectOf:h,oneOf:h,oneOfType:h,shape:h};return v.checkPropTypes=u,v.PropTypes=v,v}},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=function(){function i(n,y){for(var a=0;a<y.length;a++){var e=y[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(n,y,a){return y&&i(n.prototype,y),a&&i(n,a),n}}(),l=r(0),f=v(l),c=r(1),h=v(c);function v(i){return i&&i.__esModule?i:{default:i}}function j(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function P(i,n){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:i}function N(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(i,n):i.__proto__=n)}var O=function(i){N(n,i);function n(){return j(this,n),P(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u(n,[{key:"render",value:function(){var a=this.props,e=a.point,s=a.text,g=a.fontSize,b=a.fontFamily,_=e.x,B=e.y;return h.default.createElement("g",null,h.default.createElement("text",{x:_,y:B,fontFamily:b||"Verdana",fontSize:g||10},s))}}]),n}(h.default.Component);O.propTypes={text:f.default.string,point:f.default.object,fontSize:f.default.number,fontFamily:f.default.string},O.defaultProps={text:"",point:{x:0,y:0}},o.default=O},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=function(){function i(n,y){for(var a=0;a<y.length;a++){var e=y[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(n,y,a){return y&&i(n.prototype,y),a&&i(n,a),n}}(),l=r(0),f=v(l),c=r(1),h=v(c);function v(i){return i&&i.__esModule?i:{default:i}}function j(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function P(i,n){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:i}function N(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(i,n):i.__proto__=n)}var O=function(i){N(n,i);function n(){return j(this,n),P(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u(n,[{key:"render",value:function(){var a=this.props,e=a.data,s=a.points;a.width;var g=a.height,b=a.margin,_=a.color,B=a.style,Y=a.onMouseMove,E=s.map(function(T){return[T.x,T.y]}).reduce(function(T,C){return T.concat(C)}),J=[s[s.length-1].x,g-b,b,g-b,b,s[0].y],Q=E.concat(J),K={stroke:_||B.stroke||"slategray",strokeWidth:B.strokeWidth||"1",strokeLinejoin:B.strokeLinejoin||"round",strokeLinecap:B.strokeLinecap||"round",fill:"none"},V={stroke:B.stroke||"none",strokeWidth:"0",fillOpacity:B.fillOpacity||".1",fill:B.fill||_||"slategray",pointerEvents:"auto"},D=s.map(function(T,C){return h.default.createElement("circle",{key:C,cx:T.x,cy:T.y,r:2,style:V,onMouseEnter:function(G){return Y("enter",e[C],T)},onClick:function(G){return Y("click",e[C],T)}})});return h.default.createElement("g",null,D,h.default.createElement("polyline",{points:Q.join(" "),style:V}),h.default.createElement("polyline",{points:E.join(" "),style:K}))}}]),n}(h.default.Component);O.propTypes={color:f.default.string,style:f.default.object},O.defaultProps={style:{},onMouseMove:function(){}},o.default=O},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=function(){function i(n,y){for(var a=0;a<y.length;a++){var e=y[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(n,y,a){return y&&i(n.prototype,y),a&&i(n,a),n}}(),l=r(0),f=v(l),c=r(1),h=v(c);function v(i){return i&&i.__esModule?i:{default:i}}function j(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function P(i,n){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:i}function N(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(i,n):i.__proto__=n)}var O=function(i){N(n,i);function n(){return j(this,n),P(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u(n,[{key:"render",value:function(){var a=this.props,e=a.points;a.width;var s=a.height,g=a.margin,b=a.color,_=a.style,B=a.divisor,Y=B===void 0?.25:B,E=void 0,J=function(M){var G=void 0;if(!E)G=[M.x,M.y];else{var ae=(M.x-E.x)*Y;G=["C",E.x+ae,E.y,M.x-ae,M.y,M.x,M.y]}return E=M,G},Q=e.map(function(C){return J(C)}).reduce(function(C,M){return C.concat(M)}),K=["L"+e[e.length-1].x,s-g,g,s-g,g,e[0].y],V=Q.concat(K),D={stroke:b||_.stroke||"slategray",strokeWidth:_.strokeWidth||"1",strokeLinejoin:_.strokeLinejoin||"round",strokeLinecap:_.strokeLinecap||"round",fill:"none"},T={stroke:_.stroke||"none",strokeWidth:"0",fillOpacity:_.fillOpacity||".1",fill:_.fill||b||"slategray"};return h.default.createElement("g",null,h.default.createElement("path",{d:"M"+V.join(" "),style:T}),h.default.createElement("path",{d:"M"+Q.join(" "),style:D}))}}]),n}(h.default.Component);O.propTypes={color:f.default.string,style:f.default.object},O.defaultProps={style:{}},o.default=O},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=function(){function i(n,y){for(var a=0;a<y.length;a++){var e=y[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(n,y,a){return y&&i(n.prototype,y),a&&i(n,a),n}}(),l=r(0),f=v(l),c=r(1),h=v(c);function v(i){return i&&i.__esModule?i:{default:i}}function j(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function P(i,n){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:i}function N(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(i,n):i.__proto__=n)}var O=function(i){N(n,i);function n(){return j(this,n),P(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u(n,[{key:"render",value:function(){var a=this,e=this.props,s=e.points,g=e.height,b=e.style,_=e.barWidth,B=e.margin,Y=e.onMouseMove,E=1*(b&&b.strokeWidth||0),J=B?2*B:0,Q=_||(s&&s.length>=2?Math.max(0,s[1].x-s[0].x-E-J):0);return h.default.createElement("g",{transform:"scale(1,-1)"},s.map(function(K,V){return h.default.createElement("rect",{key:V,x:K.x-(Q+E)/2,y:-g,width:Q,height:Math.max(0,g-K.y),style:b,onMouseMove:Y&&Y.bind(a,K)})}))}}]),n}(h.default.Component);O.propTypes={points:f.default.arrayOf(f.default.object),height:f.default.number,style:f.default.object,barWidth:f.default.number,margin:f.default.number,onMouseMove:f.default.func},O.defaultProps={style:{fill:"slategray"}},o.default=O},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=function(){function i(n,y){for(var a=0;a<y.length;a++){var e=y[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(n,y,a){return y&&i(n.prototype,y),a&&i(n,a),n}}(),l=r(0),f=v(l),c=r(1),h=v(c);function v(i){return i&&i.__esModule?i:{default:i}}function j(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function P(i,n){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&(typeof n=="object"||typeof n=="function")?n:i}function N(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof n);i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(i,n):i.__proto__=n)}var O=function(i){N(n,i);function n(){return j(this,n),P(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return u(n,[{key:"lastDirection",value:function(a){return Math.sign=Math.sign||function(e){return e>0?1:-1},a.length<2?0:Math.sign(a[a.length-2].y-a[a.length-1].y)}},{key:"render",value:function(){var a=this.props,e=a.points;a.width,a.height;var s=a.size,g=a.style,b=a.spotColors,_=h.default.createElement("circle",{cx:e[0].x,cy:e[0].y,r:s,style:g}),B=h.default.createElement("circle",{cx:e[e.length-1].x,cy:e[e.length-1].y,r:s,style:g||{fill:b[this.lastDirection(e)]}});return h.default.createElement("g",null,g&&_,B)}}]),n}(h.default.Component);O.propTypes={size:f.default.number,style:f.default.object,spotColors:f.default.object},O.defaultProps={size:2,spotColors:{"-1":"red",0:"black",1:"green"}},o.default=O},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=function(){function a(e,s){for(var g=0;g<s.length;g++){var b=s[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(e,b.key,b)}}return function(e,s,g){return s&&a(e.prototype,s),g&&a(e,g),e}}(),l=r(0),f=N(l),c=r(1),h=N(c),v=r(23),j=P(v);function P(a){if(a&&a.__esModule)return a;var e={};if(a!=null)for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s]);return e.default=a,e}function N(a){return a&&a.__esModule?a:{default:a}}function O(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function i(a,e){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:a}function n(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(a,e):a.__proto__=e)}var y=function(a){n(e,a);function e(){return O(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return u(e,[{key:"render",value:function(){var g=this.props,b=g.points,_=g.margin,B=g.type,Y=g.style,E=g.value,J=b.map(function(K){return K.y}),Q=B=="custom"?E:j[B](J);return h.default.createElement("line",{x1:b[0].x,y1:Q+_,x2:b[b.length-1].x,y2:Q+_,style:Y})}}]),e}(h.default.Component);y.propTypes={type:f.default.oneOf(["max","min","mean","avg","median","custom"]),value:f.default.number,style:f.default.object},y.defaultProps={type:"mean",style:{stroke:"red",strokeOpacity:.75,strokeDasharray:"2, 2"}},o.default=y},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.variance=o.stdev=o.median=o.midRange=o.avg=o.mean=o.max=o.min=void 0;var u=r(7),l=y(u),f=r(3),c=y(f),h=r(24),v=y(h),j=r(25),P=y(j),N=r(10),O=y(N),i=r(26),n=y(i);function y(a){return a&&a.__esModule?a:{default:a}}o.min=l.default,o.max=l.default,o.mean=c.default,o.avg=c.default,o.midRange=v.default,o.median=P.default,o.stdev=O.default,o.variance=n.default},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=r(7),l=h(u),f=r(9),c=h(f);function h(v){return v&&v.__esModule?v:{default:v}}o.default=function(v){return(0,c.default)(v)-(0,l.default)(v)/2}},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(u){return u.sort(function(l,f){return l-f})[Math.floor(u.length/2)]}},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=r(3),l=f(u);function f(c){return c&&c.__esModule?c:{default:c}}o.default=function(c){var h=(0,l.default)(c),v=c.map(function(j){return Math.pow(j-h,2)});return(0,l.default)(v)}},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=function(){function e(s,g){for(var b=0;b<g.length;b++){var _=g[b];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(s,_.key,_)}}return function(s,g,b){return g&&e(s.prototype,g),b&&e(s,b),s}}(),l=r(0),f=O(l),c=r(1),h=O(c),v=r(3),j=O(v),P=r(10),N=O(P);function O(e){return e&&e.__esModule?e:{default:e}}function i(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function n(e,s){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s&&(typeof s=="object"||typeof s=="function")?s:e}function y(e,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof s);e.prototype=Object.create(s&&s.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),s&&(Object.setPrototypeOf?Object.setPrototypeOf(e,s):e.__proto__=s)}var a=function(e){y(s,e);function s(){return i(this,s),n(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments))}return u(s,[{key:"render",value:function(){var b=this.props,_=b.points,B=b.margin,Y=b.style,E=_.map(function(K){return K.y}),J=(0,j.default)(E),Q=(0,N.default)(E);return h.default.createElement("rect",{x:_[0].x,y:J-Q+B,width:_[_.length-1].x-_[0].x,height:N.default*2,style:Y})}}]),s}(h.default.Component);a.propTypes={style:f.default.object},a.defaultProps={style:{fill:"red",fillOpacity:.1}},o.default=a},function(x,o,r){Object.defineProperty(o,"__esModule",{value:!0});var u=r(7),l=h(u),f=r(9),c=h(f);function h(v){return v&&v.__esModule?v:{default:v}}o.default=function(v){var j=v.data,P=v.limit,N=v.width,O=N===void 0?1:N,i=v.height,n=i===void 0?1:i,y=v.margin,a=y===void 0?0:y,e=v.max,s=e===void 0?(0,c.default)(j):e,g=v.min,b=g===void 0?(0,l.default)(j):g,_=j.length;P&&P<_&&(j=j.slice(_-P));var B=(n-a*2)/(s-b||2),Y=(O-a*2)/((P||_)-(_>1?1:0));return j.map(function(E,J){return{x:J*Y+a,y:(s===b?1:s-E)*B+a}})}}])})})(Je);var ye=Je.exports;const $e=typeof TextDecoder<"u"?new TextDecoder("utf-8"):null;async function Gt(R){if(typeof R=="string")return R;if(typeof window<"u"&&R instanceof File)return await R.text();if(R&&R.byteLength!=null)return $e?$e.decode(R):String.fromCharCode.apply(null,new Uint8Array(R));throw new Error("Entrada inválida para leitura de texto OFX")}function Qt(R){if(!R)return null;const S=String(R).match(/(\d{4})(\d{2})(\d{2})/);if(!S)return null;const[te,x,o,r]=S,u=Number(x),l=Number(o)-1,f=Number(r);return new Date(u,l,f).toISOString().split("T")[0]}function Jt(R){if(R==null)return 0;const S=Number(String(R).replace(",","."));return isNaN(S)?0:S}function re(R,S){const te=new RegExp(`<${S}>([^\r
<]*)`,"i"),x=R.match(te);if(x)return x[1].trim();const o=new RegExp(`<${S}>([sS]*?)</${S}>`,"i"),r=R.match(o);return r?r[1].trim():""}function Kt(R){const S=/<STMTTRN>([\s\S]*?)<\/STMTTRN>/gi,te=[];let x;for(;(x=S.exec(R))!==null;)te.push(x[1]);if(te.length)return te;const o=/<STMTTRN>[\s\S]*?(?=<STMTTRN>|<\/BANKTRANLIST>|<\/STMTRS>|$)/gi;return(R.match(o)||[]).map(u=>u.replace(/^<STMTTRN>/i,""))}function Zt(R){return/<OFX[>\s]/i.test(R)||/<OFX>/i.test(R)}function Vt(R){var o;if(!R||!Zt(R))throw new Error("Arquivo OFX inválido ou não reconhecido");R.toLowerCase();const S=((o=/\<banktranlist\>([\s\S]*?)\<\/banktranlist\>/i.exec(R))==null?void 0:o[1])||R;return Kt(S).map(r=>{const u=re(r,"TRNTYPE")||re(r,"trntype"),l=re(r,"DTPOSTED")||re(r,"dtposted")||re(r,"DTUSER"),f=re(r,"TRNAMT")||re(r,"trnamt"),c=re(r,"MEMO")||re(r,"memo")||re(r,"NAME"),h=re(r,"FITID")||re(r,"fitid"),v=Qt(l),j=Jt(f),P=(c||"").trim(),N=(u||"").toUpperCase();return{data:v,valor:j,descricao:P,tipo:N,identificador:h}}).filter(r=>r.data&&(r.valor||r.valor===0))}async function en(R){const S=await Gt(R);return Vt(S)}const Me=10,tn="expensesPage";function wn(){var Ee;const{expenses:R,categories:S,paymentMethods:te,addExpense:x,updateExpense:o,deleteExpense:r,toggleExpensePayment:u}=Ue(),{toast:l}=yt(),[f,c]=q.useState(!1),[h,v]=q.useState(null),[j,P]=q.useState(1),[N,O]=q.useState(""),[i,n]=q.useState("all"),[y,a]=q.useState("all"),[e,s]=q.useState("date-desc"),[g,b]=q.useState(!1),[_,B]=q.useState(!1),[Y,E]=q.useState([]),[J,Q]=q.useState({}),[K,V]=q.useState({}),D=q.useMemo(()=>S.filter(d=>d.tipo==="gasto"),[S]),T=((Ee=D[0])==null?void 0:Ee.id)||"",[C,M]=q.useState(T),[G,ae]=q.useState(!1),p="ofx-file-input",[m,I]=xt(`filter_${tn}`,()=>({periodType:"monthly",dateRange:void 0,month:new Date().getMonth(),year:new Date().getFullYear()})),W=d=>{I({...m,dateRange:d})},F=d=>{I({dateRange:void 0,periodType:"monthly",month:d,year:m.year||new Date().getFullYear()})},$=d=>{I(w=>({...w,dateRange:void 0,year:d}))},A=d=>{I(w=>({...w,periodType:d,dateRange:void 0}))};q.useEffect(()=>{!C&&T&&M(T)},[T,C]);const z=()=>{const d=document.getElementById(p);d&&d.click()},H=async d=>{const w=d.target.files&&d.target.files[0];if(w)try{const ee=(await en(w)).filter(ne=>ne.valor<0||String(ne.tipo).toUpperCase()==="DEBIT").map(ne=>({...ne,valor:Math.abs(ne.valor)}));if(ee.length===0){l({title:"Nenhuma despesa encontrada no OFX",description:"Verifique se o arquivo contém lançamentos de saída.",variant:"destructive"}),d.target.value="";return}E(ee),Q({}),V(ee.reduce((ne,he,ge)=>(ne[ge]=he.descricao||"Lançamento OFX",ne),{})),b(!0)}catch(k){l({title:"Falha ao ler OFX",description:(k==null?void 0:k.message)||"Formato inválido.",variant:"destructive"})}finally{d.target.value=""}},X=async()=>{if(!(Y.some((w,k)=>J[k])||!!C)){l({title:"Selecione uma categoria",description:"Defina ao menos a categoria padrão ou por item.",variant:"destructive"});return}B(!0);try{let w=0;for(let k=0;k<Y.length;k++){const ee=Y[k],ne=J[k]||C;if(!ne)continue;const he={descricao:K[k]??ee.descricao??"Lançamento OFX",valor:Number(ee.valor)||0,categoria_id:ne,pago:G,recorrente:!1,data:ee.data||new Date().toISOString().split("T")[0]};try{await x(he),w++}catch{}}l({title:"Importação concluída",description:`${w} despesas adicionadas`}),b(!1),E([]),Q({}),V({})}catch(w){l({title:"Erro na importação",description:(w==null?void 0:w.message)||"Tente novamente.",variant:"destructive"})}finally{B(!1)}},{filteredExpenses:L,totalSpent:ie,trendData:xe,paidExpenses:ve,pendingExpenses:Ne,totalPaid:Ke,totalPending:Ze}=q.useMemo(()=>{let d=[],w,k;m.dateRange&&m.dateRange.from?(w=m.dateRange.from,k=m.dateRange.to||m.dateRange.from):m.periodType==="yearly"&&m.year?(w=Ct(new Date(m.year,0,1)),k=It(new Date(m.year,11,31))):m.periodType==="monthly"&&m.month!==void 0&&m.year&&(w=Be(new Date(m.year,m.month,1)),k=ze(new Date(m.year,m.month,1))),w&&k&&(k.setHours(23,59,59,999),d=R.filter(U=>{const Z=We(U.data);return Z>=w&&Z<=k})),N&&(d=d.filter(U=>U.descricao.toLowerCase().includes(N.toLowerCase()))),i!=="all"&&(d=d.filter(U=>U.categoria_id===i)),y!=="all"&&(d=d.filter(U=>y==="paid"?U.pago===!0:y==="pending"?U.pago===!1:!0)),d.sort((U,Z)=>{switch(e){case"date-asc":return new Date(U.data)-new Date(Z.data);case"date-desc":return new Date(Z.data)-new Date(U.data);case"value-asc":return U.valor-Z.valor;case"value-desc":return Z.valor-U.valor;case"description":return U.descricao.localeCompare(Z.descricao);default:return new Date(Z.data)-new Date(U.data)}});const ee=[];for(let U=6;U>=0;U--){const Z=m.periodType==="monthly"?new Date(m.year,m.month-U,1):$t(new Date,U),dt=Be(Z),pt=ze(Z),mt=d.filter(ke=>{const be=We(ke.data);return be>=dt&&be<=pt});ee.push(mt.reduce((ke,be)=>ke+be.valor,0))}const ne=d.reduce((U,Z)=>U+Z.valor,0),he=d.filter(U=>U.pago===!0),ge=d.filter(U=>U.pago===!1),ut=he.reduce((U,Z)=>U+Z.valor,0),ft=ge.reduce((U,Z)=>U+Z.valor,0);return{filteredExpenses:d,totalSpent:ne,trendData:ee,paidExpenses:he,pendingExpenses:ge,totalPaid:ut,totalPending:ft}},[R,m,N,i,y,e]);q.useMemo(()=>{if(L.length===0)return[];const d=D.reduce((w,k)=>(w[k.id]={categoryName:k.nome,total:0},w),{});return L.forEach(w=>{d[w.categoria_id]&&(d[w.categoria_id].total+=w.valor)}),Object.values(d).filter(w=>w.total>0).sort((w,k)=>k.total-w.total)},[L,D]);const Pe=Math.ceil(L.length/Me),Ve=L.slice((j-1)*Me,j*Me),[de,je]=q.useState([]),pe=de.length,et=(d,w)=>{je(k=>w?Array.from(new Set([...k,d])):k.filter(ee=>ee!==d))},tt=(d,w)=>{je(w?Array.from(new Set([...de,...d])):de.filter(k=>!d.includes(k)))},nt=async()=>{if(pe!==0)try{for(const d of de)await u(d);l({title:"Atualização concluída",description:`${pe} lançamento(s) atualizados`}),je([])}catch(d){l({title:"Erro ao atualizar em lote",description:d.message,variant:"destructive"})}},rt=async()=>{if(pe!==0)try{for(const d of de)await r(d);l({title:"Exclusão concluída",description:`${pe} lançamento(s) excluídos`}),je([])}catch(d){l({title:"Erro ao excluir em lote",description:d.message,variant:"destructive"})}},at=async(d,w)=>{try{w?(await o(w,d),l({title:"Despesa atualizada com sucesso!"})):(await x(d),l({title:"Despesa adicionada com sucesso!"})),c(!1),v(null)}catch(k){l({title:"Erro ao salvar despesa",description:k.message,variant:"destructive"})}},it=d=>{v({...d,categories:D}),c(!0)},ot=async d=>{try{await r(d),l({title:"Despesa excluída com sucesso!"})}catch(w){l({title:"Erro ao excluir despesa",description:w.message,variant:"destructive"})}},st=async d=>{try{await u(d),l({title:"Status de pagamento atualizado!"})}catch(w){l({title:"Erro ao atualizar status",description:w.message,variant:"destructive"})}},lt=d=>{d>0&&d<=Pe&&P(d)},ct=d=>{d||v(null),c(d)},me=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"});return t.jsxs(t.Fragment,{children:[t.jsxs(vt,{children:[t.jsx("title",{children:"Controle de Despesas - Lumify"}),t.jsx("meta",{name:"description",content:"Adicione e gerencie suas despesas."})]}),t.jsxs("div",{className:"space-y-3 md:space-y-4 page-top",children:[t.jsx(Ft,{title:"Controle de Despesas",subtitle:"Gerencie suas despesas e acompanhe seus gastos",actionButton:t.jsx(qt,{onSubmit:at,expenseToEdit:h,isOpen:f,onOpenChange:ct})}),t.jsxs(zt,{defaultValue:"relatorio",className:"w-full",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[t.jsxs(Wt,{className:"grid w-full md:w-auto grid-cols-2",children:[t.jsxs(Le,{value:"relatorio",className:"flex items-center gap-2",children:[t.jsx(jt,{className:"h-4 w-4"})," Relatório"]}),t.jsxs(Le,{value:"dashboard",className:"flex items-center gap-2",children:[t.jsx(Re,{className:"h-4 w-4"})," Dashboard"]})]}),t.jsxs("div",{className:"w-full md:w-auto flex items-center gap-2",children:[t.jsx("input",{id:p,type:"file",accept:".ofx,.qfx,.ofc,.xml,.txt",className:"hidden",onChange:H}),t.jsxs(fe,{variant:"outline",onClick:z,className:"flex items-center gap-2",children:[t.jsx(Yt,{className:"h-4 w-4"})," Importar OFX"]}),t.jsx(Lt,{periodType:m.periodType,setPeriodType:A,dateRange:m.dateRange,setDateRange:W,month:m.month,setMonth:F,year:m.year,setYear:$})]})]}),t.jsx(Ae,{value:"relatorio",className:"mt-4 md:mt-5 space-y-4 md:space-y-5",children:t.jsxs(oe,{children:[t.jsxs(se,{children:[t.jsx(le,{children:"Suas Despesas"}),t.jsx(gt,{children:"Lista de todas as despesas no período selecionado."})]}),t.jsxs(ce,{children:[pe>0&&t.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm",children:[t.jsxs("div",{className:"text-muted-foreground",children:["Selecionados: ",pe]}),t.jsxs(fe,{variant:"outline",size:"sm",onClick:nt,className:"flex items-center gap-2",children:[t.jsx(Ht,{className:"h-4 w-4"})," Marcar como pago"]}),t.jsxs(fe,{variant:"destructive",size:"sm",onClick:rt,className:"flex items-center gap-2",children:[t.jsx(Ut,{className:"h-4 w-4"})," Excluir"]})]}),t.jsx(bt,{transactions:Ve,categories:D,paymentMethods:te,type:"expense",onEdit:it,onDelete:ot,onTogglePayment:st,onUpdatePaymentMethod:o,selectable:!0,selectedIds:de,onSelectOne:et,onSelectAll:tt,searchTerm:N,onSearchChange:O,selectedCategory:i,onCategoryChange:n,paymentStatus:y,onPaymentStatusChange:a,sortBy:e,onSortChange:s}),Pe>1&&t.jsx(wt,{currentPage:j,totalPages:Pe,onPageChange:lt})]})]})}),t.jsxs(Ae,{value:"dashboard",className:"mt-4 md:mt-5 space-y-4 md:space-y-5",children:[t.jsxs("div",{className:"grid gap-3 md:gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(le,{className:"text-sm font-medium",children:"Despesas Pagas"}),t.jsx(St,{className:"h-4 w-4 text-green-600"})]}),t.jsxs(ce,{children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:me.format(Ke)}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[ve.length," despesa",ve.length!==1?"s":""," quitada",ve.length!==1?"s":""]})]})]}),t.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(le,{className:"text-sm font-medium",children:"Despesas Pendentes"}),t.jsx(Tt,{className:"h-4 w-4 text-orange-600"})]}),t.jsxs(ce,{children:[t.jsx("div",{className:"text-2xl font-bold text-orange-600",children:me.format(Ze)}),t.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ne.length," despesa",Ne.length!==1?"s":""," pendente",Ne.length!==1?"s":""]})]})]}),t.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(le,{className:"text-sm font-medium",children:"Gasto Total"}),t.jsx(Xe,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(ce,{children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:me.format(ie)}),t.jsx(ye.Sparklines,{data:xe,children:t.jsx(ye.SparklinesLine,{color:"#f87171"})}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Total de despesas no período selecionado."})]})]}),t.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(le,{className:"text-sm font-medium",children:"Número de Despesas"}),t.jsx(He,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(ce,{children:[t.jsx("div",{className:"text-2xl font-bold",children:L.length}),t.jsx(ye.Sparklines,{data:xe.map((d,w)=>L.length>0?L.length/xe.length:0),children:t.jsx(ye.SparklinesLine,{color:"#3b82f6"})}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Quantidade de despesas registradas."})]})]}),t.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(le,{className:"text-sm font-medium",children:"Despesa Média"}),t.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(ce,{children:[t.jsx("div",{className:"text-2xl font-bold",children:L.length>0?me.format(ie/L.length):"R$ 0,00"}),t.jsx(ye.Sparklines,{data:xe.map(d=>d/(L.length||1)),children:t.jsx(ye.SparklinesLine,{color:"#fbbf24"})}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Valor médio por despesa."})]})]}),t.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[t.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(le,{className:"text-sm font-medium",children:"Taxa de Quitação"}),t.jsx(Re,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(ce,{children:[t.jsx("div",{className:"text-2xl font-bold",children:L.length>0?`${Math.round(ve.length/L.length*100)}%`:"0%"}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:t.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:L.length>0?`${ve.length/L.length*100}%`:"0%"}})}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Percentual de despesas quitadas."})]})]})]}),t.jsx(At,{}),t.jsx(Bt,{expenses:L,categories:S})]})]}),t.jsx(Ye,{open:g,onOpenChange:b,children:t.jsxs(qe,{className:"sm:max-w-4xl",children:[t.jsx(Ge,{children:t.jsx(Qe,{children:"Importar despesas do OFX"})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[t.jsxs("div",{className:"text-sm text-muted-foreground",children:[Y.length," lançamento",Y.length!==1?"s":""," de despesa encontrados."]}),t.jsxs("div",{className:"text-sm font-medium",children:["Total a importar: ",me.format(Y.reduce((d,w)=>d+(Number(w.valor)||0),0))]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium",children:"Categoria para as despesas"}),t.jsxs(we,{value:C,onValueChange:M,children:[t.jsx(Se,{className:"w-full mt-1",children:t.jsx(Te,{placeholder:"Selecione uma categoria"})}),t.jsx(Oe,{children:D.map(d=>t.jsx(_e,{value:String(d.id),children:d.nome},d.id))})]})]}),t.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[t.jsx("input",{id:"importPaid",type:"checkbox",className:"rounded accent-primary",checked:G,onChange:d=>ae(d.target.checked)}),t.jsx("label",{htmlFor:"importPaid",className:"text-sm",children:"Marcar como pago"})]})]}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"Revise as descrições e categorias. Valores negativos são importados como despesas."}),t.jsxs("div",{className:"max-h-[60vh] overflow-auto border rounded-md",children:[t.jsxs("div",{className:"grid grid-cols-12 gap-2 p-2 text-xs text-muted-foreground border-b",children:[t.jsx("div",{className:"col-span-5",children:"Descrição"}),t.jsx("div",{className:"col-span-2",children:"Data"}),t.jsx("div",{className:"col-span-2 text-right",children:"Valor"}),t.jsx("div",{className:"col-span-3",children:"Categoria"})]}),Y.map((d,w)=>t.jsxs("div",{className:"grid grid-cols-12 gap-2 p-2 items-center border-b last:border-b-0",children:[t.jsx("div",{className:"col-span-5",children:t.jsx("input",{className:"w-full px-2 py-1 border rounded text-sm",value:K[w]??d.descricao??"Lançamento OFX",onChange:k=>V(ee=>({...ee,[w]:k.target.value}))})}),t.jsx("div",{className:"col-span-2 text-xs",children:d.data}),t.jsx("div",{className:"col-span-2 text-right font-medium",children:me.format(Number(d.valor)||0)}),t.jsx("div",{className:"col-span-3",children:t.jsxs(we,{value:J[w]||C||"",onValueChange:k=>Q(ee=>({...ee,[w]:k})),children:[t.jsx(Se,{className:"w-full",children:t.jsx(Te,{placeholder:"Categoria"})}),t.jsx(Oe,{children:D.map(k=>t.jsx(_e,{value:String(k.id),children:k.nome},k.id))})]})})]},w))]})]}),t.jsxs(kt,{children:[t.jsx(fe,{variant:"ghost",onClick:()=>b(!1),disabled:_,children:"Cancelar"}),t.jsx(fe,{onClick:X,disabled:_||!C,children:_?"Importando...":"Confirmar importação"})]})]})})]})]})}export{wn as ExpensesPage};
