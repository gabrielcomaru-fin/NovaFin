import{e as Te,r as d,w as oa,j as e,x as ts,z as na,Q as la,R as k,I as A,U as rs,B as T,o as ia,m as ca,K as da,M as ma,N as xa,O as ua,V as ha,W as pa,f as ga,A as Ae,C as _e,d as $e,D as ke,X as fa}from"./index-d0ea6d6a.js";import{f as os,T as ja,O as va,W as Na,g as wa,h as ba,i as ya,j as ns,k as Da,R as Ca,l as Ta,D as ls,b as is,c as cs,d as ds,e as Sa,C as Ze,m as Ia}from"./dialog-eae6d4ca.js";import{I as Aa}from"./label-cb1f6f9b.js";import{S as O,a as M,b as _,c as $,d as w}from"./select-16594779.js";import{P as qe,b as Xe,F as Le,c as ze,C as ka}from"./CompactPeriodFilter-ea56c5d3.js";import{B as ue,P as Pa}from"./badge-88e11e09.js";import{C as Ce}from"./check-circle-2-73519f16.js";import{C as es}from"./clock-16b511b3.js";import{S as Fa}from"./shield-check-3771e06e.js";import{T as Ea}from"./trash-2-1492001f.js";import{W as ss}from"./wallet-b404b181.js";import{C as Ra,a as Oa}from"./extends-6c7ae844.js";import{B as Ma,S as _a,F as ms}from"./smartphone-4570318b.js";import{B as $a}from"./building-2-42858704.js";const qa=Te("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Tt=Te("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),Ve=Te("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Xa=Te("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),La=Te("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function St(a,t){const o=d.useRef(!0),[i,m]=d.useState(()=>{try{const j=localStorage.getItem(a);return j!==null?JSON.parse(j):typeof t=="function"?t():t}catch{return typeof t=="function"?t():t}});return d.useEffect(()=>{if(o.current){o.current=!1;return}try{localStorage.setItem(a,JSON.stringify(i))}catch{}},[a,i]),[i,m]}var xs="AlertDialog",[za,It]=oa(xs,[os]),se=os(),us=a=>{const{__scopeAlertDialog:t,...o}=a,i=se(t);return e.jsx(Ca,{...i,...o,modal:!0})};us.displayName=xs;var Va="AlertDialogTrigger",hs=d.forwardRef((a,t)=>{const{__scopeAlertDialog:o,...i}=a,m=se(o);return e.jsx(ja,{...m,...i,ref:t})});hs.displayName=Va;var Ba="AlertDialogPortal",ps=a=>{const{__scopeAlertDialog:t,...o}=a,i=se(t);return e.jsx(Da,{...i,...o})};ps.displayName=Ba;var Ua="AlertDialogOverlay",gs=d.forwardRef((a,t)=>{const{__scopeAlertDialog:o,...i}=a,m=se(o);return e.jsx(va,{...m,...i,ref:t})});gs.displayName=Ua;var je="AlertDialogContent",[Ha,Wa]=za(je),Ga=la("AlertDialogContent"),fs=d.forwardRef((a,t)=>{const{__scopeAlertDialog:o,children:i,...m}=a,j=se(o),u=d.useRef(null),K=ts(t,u),P=d.useRef(null);return e.jsx(Na,{contentName:je,titleName:js,docsSlug:"alert-dialog",children:e.jsx(Ha,{scope:o,cancelRef:P,children:e.jsxs(wa,{role:"alertdialog",...j,...m,ref:K,onOpenAutoFocus:na(m.onOpenAutoFocus,S=>{var D;S.preventDefault(),(D=P.current)==null||D.focus({preventScroll:!0})}),onPointerDownOutside:S=>S.preventDefault(),onInteractOutside:S=>S.preventDefault(),children:[e.jsx(Ga,{children:i}),e.jsx(Ya,{contentRef:u})]})})})});fs.displayName=je;var js="AlertDialogTitle",vs=d.forwardRef((a,t)=>{const{__scopeAlertDialog:o,...i}=a,m=se(o);return e.jsx(ba,{...m,...i,ref:t})});vs.displayName=js;var Ns="AlertDialogDescription",ws=d.forwardRef((a,t)=>{const{__scopeAlertDialog:o,...i}=a,m=se(o);return e.jsx(ya,{...m,...i,ref:t})});ws.displayName=Ns;var Ka="AlertDialogAction",bs=d.forwardRef((a,t)=>{const{__scopeAlertDialog:o,...i}=a,m=se(o);return e.jsx(ns,{...m,...i,ref:t})});bs.displayName=Ka;var ys="AlertDialogCancel",Ds=d.forwardRef((a,t)=>{const{__scopeAlertDialog:o,...i}=a,{cancelRef:m}=Wa(ys,o),j=se(o),u=ts(t,m);return e.jsx(ns,{...j,...i,ref:u})});Ds.displayName=ys;var Ya=({contentRef:a})=>{const t=`\`${je}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${je}\` by passing a \`${Ns}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${je}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return d.useEffect(()=>{var i;document.getElementById((i=a.current)==null?void 0:i.getAttribute("aria-describedby"))||console.warn(t)},[t,a]),null},Ja=us,Qa=hs,Za=ps,Cs=gs,Ts=fs,Ss=bs,Is=Ds,As=vs,ks=ws;const et=Ja,st=Qa,at=Za,Ps=k.forwardRef(({className:a,...t},o)=>e.jsx(Cs,{className:A("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t,ref:o}));Ps.displayName=Cs.displayName;const Fs=k.forwardRef(({className:a,...t},o)=>e.jsxs(at,{children:[e.jsx(Ps,{}),e.jsx(Ts,{ref:o,className:A("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t})]}));Fs.displayName=Ts.displayName;const Es=({className:a,...t})=>e.jsx("div",{className:A("flex flex-col space-y-2 text-center sm:text-left",a),...t});Es.displayName="AlertDialogHeader";const Rs=({className:a,...t})=>e.jsx("div",{className:A("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});Rs.displayName="AlertDialogFooter";const Os=k.forwardRef(({className:a,...t},o)=>e.jsx(As,{ref:o,className:A("text-lg font-semibold",a),...t}));Os.displayName=As.displayName;const Ms=k.forwardRef(({className:a,...t},o)=>e.jsx(ks,{ref:o,className:A("text-sm text-muted-foreground",a),...t}));Ms.displayName=ks.displayName;const _s=k.forwardRef(({className:a,...t},o)=>e.jsx(Ss,{ref:o,className:A(rs(),a),...t}));_s.displayName=Ss.displayName;const $s=k.forwardRef(({className:a,...t},o)=>e.jsx(Is,{ref:o,className:A(rs({variant:"outline"}),"mt-2 sm:mt-0",a),...t}));$s.displayName=Is.displayName;const qs=k.forwardRef(({className:a,...t},o)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:o,className:A("w-full caption-bottom text-sm",a),...t})}));qs.displayName="Table";const Xs=k.forwardRef(({className:a,...t},o)=>e.jsx("thead",{ref:o,className:A("[&_tr]:border-b",a),...t}));Xs.displayName="TableHeader";const Ls=k.forwardRef(({className:a,...t},o)=>e.jsx("tbody",{ref:o,className:A("[&_tr:last-child]:border-0",a),...t}));Ls.displayName="TableBody";const tt=k.forwardRef(({className:a,...t},o)=>e.jsx("tfoot",{ref:o,className:A("bg-primary font-medium text-primary-foreground",a),...t}));tt.displayName="TableFooter";const Be=k.forwardRef(({className:a,...t},o)=>e.jsx("tr",{ref:o,className:A("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...t}));Be.displayName="TableRow";const G=k.forwardRef(({className:a,...t},o)=>e.jsx("th",{ref:o,className:A("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...t}));G.displayName="TableHead";const B=k.forwardRef(({className:a,...t},o)=>e.jsx("td",{ref:o,className:A("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...t}));B.displayName="TableCell";const rt=k.forwardRef(({className:a,...t},o)=>e.jsx("caption",{ref:o,className:A("mt-4 text-sm text-muted-foreground",a),...t}));rt.displayName="TableCaption";const At=({transactions:a,categories:t,accounts:o,paymentMethods:i,type:m,onEdit:j,onDelete:u,onTogglePayment:K,onUpdatePaymentMethod:P,selectable:S,selectedIds:D=[],onSelectOne:le,onSelectAll:U,searchTerm:F,onSearchChange:ie,selectedCategory:H,onCategoryChange:ce,paymentStatus:de,onPaymentStatusChange:b,sortBy:Y,onSortChange:E})=>{const v=m==="expense",[J,Q]=d.useState(!1),[L,ae]=d.useState(null),te=l=>{ae(l),Q(!0)},me=async l=>{if(!(!L||!P))try{await P(L.id,{meio_pagamento_id:l}),Q(!1),ae(null)}catch(N){console.error("Erro ao atualizar meio de pagamento:",N)}},Z=l=>({cartao_credito:Ze,cartao_debito:Ze,dinheiro:Ma,pix:_a,transferencia:$a,boleto:ms,outros:ss})[l]||ss,re=l=>{if(!l)return"hsl(var(--primary))";if(!document.documentElement.classList.contains("dark"))return l;let z,R,V;if(l.startsWith("#")){const y=l.replace("#","");z=parseInt(y.substring(0,2),16),R=parseInt(y.substring(2,4),16),V=parseInt(y.substring(4,6),16)}else if(l.startsWith("rgb")){const y=l.match(/\d+/g);if(y&&y.length>=3)z=parseInt(y[0]),R=parseInt(y[1]),V=parseInt(y[2]);else return"hsl(var(--primary))"}else return"hsl(var(--primary))";const C=(.299*z+.587*R+.114*V)/255;if(C<.5){const ee=Math.max(.6,C*2.5)/C;let ge=Math.min(255,Math.round(z*ee)),we=Math.min(255,Math.round(R*ee)),fe=Math.min(255,Math.round(V*ee));return Math.max(ge,we,fe)<150?"hsl(var(--primary))":`rgb(${ge}, ${we}, ${fe})`}return l},oe=!!(F&&String(F).trim()!==""),Se=!!(H&&H!=="all"),he=!!(v&&de&&de!=="all"),ve=(l,N)=>Y?Y===l?e.jsx(Ra,{className:"inline-block h-3.5 w-3.5 ml-1 opacity-70"}):Y===N?e.jsx(Oa,{className:"inline-block h-3.5 w-3.5 ml-1 opacity-70"}):null:null,ne=(l,N)=>{E&&E(Y===N?l:N)};return e.jsxs("div",{className:"rounded-lg border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(qs,{children:[e.jsx(Xs,{children:e.jsxs(Be,{children:[S&&e.jsx(G,{className:"w-[40px] align-middle",children:e.jsx("input",{type:"checkbox",className:"rounded accent-primary",checked:a.length>0&&a.every(l=>D.includes(l.id)),onChange:l=>U&&U(a.map(N=>N.id),l.target.checked),"aria-label":"Selecionar todos"})}),e.jsx(G,{className:"align-middle whitespace-nowrap w-[38%]",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[11px] uppercase text-muted-foreground",children:"Descri√ß√£o"}),ie&&e.jsxs(qe,{children:[e.jsx(Xe,{asChild:!0,children:e.jsx(T,{variant:"ghost",size:"icon",className:`h-6 w-6 p-0 ${oe?"text-primary bg-primary/10":"text-muted-foreground"} hover:text-foreground`,title:"Filtrar descri√ß√£o",children:e.jsx(Le,{className:"h-3.5 w-3.5"})})}),e.jsx(ze,{className:"w-72",align:"start",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Filtrar Descri√ß√£o"}),e.jsx(Aa,{value:F||"",onChange:l=>ie(l.target.value),placeholder:"Digite parte da descri√ß√£o",className:"h-8 text-sm"})]})})]})]})}),e.jsx(G,{className:"hidden sm:table-cell align-middle whitespace-nowrap w-[12%]",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[11px] uppercase text-muted-foreground",children:"Categoria"}),ce&&e.jsxs(qe,{children:[e.jsx(Xe,{asChild:!0,children:e.jsx(T,{variant:"ghost",size:"icon",className:`h-6 w-6 p-0 ${Se?"text-primary bg-primary/10":"text-muted-foreground"} hover:text-foreground`,title:"Filtrar categoria",children:e.jsx(Le,{className:"h-3.5 w-3.5"})})}),e.jsx(ze,{className:"w-56",align:"start",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Filtrar Categoria"}),e.jsxs(O,{value:H||"all",onValueChange:ce,children:[e.jsx(M,{className:"h-8 text-sm",children:e.jsx(_,{placeholder:"Todas"})}),e.jsxs($,{children:[e.jsx(w,{value:"all",children:"Todas"}),t.map(l=>e.jsx(w,{value:l.id,children:l.nome},l.id))]})]})]})})]})]})}),v&&e.jsx(G,{className:"hidden md:table-cell align-middle whitespace-nowrap w-[8%]",children:e.jsx("div",{className:"flex items-center justify-center gap-1.5",children:e.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Meio"})})}),!v&&e.jsx(G,{className:"hidden md:table-cell align-middle whitespace-nowrap w-[18%]",children:e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Institui√ß√£o"})})}),e.jsx(G,{className:"align-middle cursor-pointer select-none w-[15%]",children:e.jsxs("div",{className:"flex items-center gap-1.5",onClick:()=>ne("value-asc","value-desc"),children:[e.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Valor"}),ve("value-asc","value-desc")]})}),e.jsx(G,{className:"hidden md:table-cell align-middle cursor-pointer select-none w-[10%]",children:e.jsxs("div",{className:"flex items-center gap-1.5",onClick:()=>ne("date-asc","date-desc"),children:[e.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Data"}),ve("date-asc","date-desc")]})}),v&&e.jsx(G,{className:"hidden sm:table-cell align-middle whitespace-nowrap w-[10%]",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-[11px] uppercase text-muted-foreground",children:"Status"}),b&&e.jsxs(qe,{children:[e.jsx(Xe,{asChild:!0,children:e.jsx(T,{variant:"ghost",size:"icon",className:`h-6 w-6 p-0 ${he?"text-primary bg-primary/10":"text-muted-foreground"} hover:text-foreground`,title:"Filtrar status",children:e.jsx(Le,{className:"h-3.5 w-3.5"})})}),e.jsx(ze,{className:"w-56",align:"center",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Filtrar Status"}),e.jsxs(O,{value:de||"all",onValueChange:b,children:[e.jsx(M,{className:"h-8 text-sm",children:e.jsx(_,{placeholder:"Todos"})}),e.jsxs($,{children:[e.jsx(w,{value:"all",children:"Todos"}),e.jsx(w,{value:"paid",children:"Pagos"}),e.jsx(w,{value:"pending",children:"Pendentes"})]})]})]})})]})]})}),e.jsx(G,{className:"align-middle whitespace-nowrap w-[8%]",children:e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"A√ß√µes"})})})]})}),e.jsxs(Ls,{children:[e.jsx(ia,{children:a.map(l=>{const N=t.find(C=>C.id===l.categoria_id),z=o==null?void 0:o.find(C=>C.id===l.instituicao_id),R=v?l.valor:l.valor_aporte||l.valor,V=l.descricao;return e.jsxs(ca.tr,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"hover:bg-muted/50",children:[S&&e.jsx(B,{className:"w-[40px]",children:e.jsx("input",{type:"checkbox",className:"rounded accent-primary",checked:D.includes(l.id),onChange:C=>le&&le(l.id,C.target.checked),"aria-label":`Selecionar ${V}`})}),e.jsx(B,{className:"font-medium w-[38%]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:V}),e.jsx("div",{className:"sm:hidden",children:e.jsx(ue,{variant:"outline",className:"text-xs",children:(N==null?void 0:N.nome)||"Sem categoria"})}),v&&e.jsx("div",{className:"sm:hidden",children:l.pago?e.jsxs(ue,{variant:"default",className:"bg-green-100 text-green-800 border-green-200 text-xs",children:[e.jsx(Ce,{className:"w-3 h-3 mr-1"}),"Pago"]}):e.jsxs(ue,{variant:"outline",className:"text-orange-600 border-orange-200 text-xs",children:[e.jsx(es,{className:"w-3 h-3 mr-1"}),"Pendente"]})})]})}),e.jsx(B,{className:"hidden sm:table-cell w-[12%]",children:e.jsx(ue,{variant:"outline",children:(N==null?void 0:N.nome)||"Sem categoria"})}),v&&e.jsx(B,{className:"hidden md:table-cell w-[8%] align-middle",children:e.jsx("div",{className:"flex justify-center items-center",children:(()=>{const C=i==null?void 0:i.find(pe=>pe.id===l.meio_pagamento_id);if(!C)return e.jsx("button",{onClick:()=>te(l),className:"w-4 h-4 rounded-full bg-muted hover:bg-muted/80 transition-colors inline-flex items-center justify-center",title:"Adicionar meio de pagamento",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:"+"})});const y=Z(C.tipo),Ne=re(C.cor);return e.jsx("button",{onClick:()=>te(l),className:"w-4 h-4 hover:scale-110 transition-transform inline-flex items-center justify-center",title:`${C.nome} - Clique para alterar`,children:e.jsx(y,{className:"w-4 h-4",style:{color:Ne||"hsl(var(--primary))"}})})})()})}),!v&&e.jsx(B,{className:"hidden md:table-cell w-[18%]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{variant:"secondary",children:(z==null?void 0:z.nome_banco)||"Sem institui√ß√£o"}),l.is_reserva_emergencia&&e.jsx(da,{children:e.jsxs(ma,{children:[e.jsx(xa,{asChild:!0,children:e.jsx(Fa,{className:"h-4 w-4 text-emerald-500 flex-shrink-0"})}),e.jsx(ua,{side:"top",children:e.jsx("p",{className:"text-xs",children:"Reserva de Emerg√™ncia"})})]})})]})}),e.jsxs(B,{className:`font-semibold w-[15%] ${v?"text-destructive text-left":"text-green-500 text-left"}`,children:[v?"- R$ ":"+ R$ "," ",R.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx(B,{className:"hidden md:table-cell text-muted-foreground w-[10%] text-left",children:new Date(l.data).toLocaleDateString("pt-BR",{timeZone:"UTC"})}),v&&e.jsx(B,{className:"hidden sm:table-cell w-[10%]",children:e.jsx("div",{className:"flex items-center",children:l.pago?e.jsxs(ue,{variant:"default",className:"bg-green-100 text-green-800 border-green-200",children:[e.jsx(Ce,{className:"w-3 h-3 mr-1"}),"Pago"]}):e.jsxs(ue,{variant:"outline",className:"text-orange-600 border-orange-200",children:[e.jsx(es,{className:"w-3 h-3 mr-1"}),"Pendente"]})})}),e.jsx(B,{className:"w-[8%]",children:e.jsxs("div",{className:"flex items-center gap-1",children:[v&&K&&e.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>K(l.id),title:l.pago?"Marcar como n√£o pago":"Marcar como pago",children:l.pago?e.jsx(La,{className:"h-4 w-4 text-orange-600 hover:text-orange-700"}):e.jsx(Ce,{className:"h-4 w-4 text-green-600 hover:text-green-700"})}),e.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>j(l),children:e.jsx(Ta,{className:"h-4 w-4"})}),e.jsxs(et,{children:[e.jsx(st,{asChild:!0,children:e.jsx(T,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",children:e.jsx(Ea,{className:"h-4 w-4"})})}),e.jsxs(Fs,{children:[e.jsxs(Es,{children:[e.jsx(Os,{children:"Voc√™ tem certeza?"}),e.jsx(Ms,{children:"Esta a√ß√£o n√£o pode ser desfeita. Isso excluir√° permanentemente esta transa√ß√£o."})]}),e.jsxs(Rs,{children:[e.jsx($s,{children:"Cancelar"}),e.jsx(_s,{onClick:()=>u(l.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})]})]})})]},l.id)})}),a.length===0&&e.jsx(Be,{children:e.jsx(B,{colSpan:6,className:"py-10 text-center text-sm text-muted-foreground",children:"Nenhum resultado para os filtros aplicados."})})]})]})}),e.jsx(ls,{open:J,onOpenChange:Q,children:e.jsxs(is,{className:"sm:max-w-md",children:[e.jsxs(cs,{children:[e.jsx(ds,{children:"Alterar Meio de Pagamento"}),e.jsx(Sa,{children:"Selecione um novo meio de pagamento para esta despesa."})]}),e.jsx("div",{className:"space-y-3",children:i==null?void 0:i.map(l=>{const N=Z(l.tipo);return e.jsxs("button",{onClick:()=>me(l.id),className:"w-full flex items-center gap-3 p-3 rounded-lg border hover:bg-muted/50 transition-colors",children:[e.jsx(N,{className:"w-4 h-4",style:{color:re(l.cor)||"hsl(var(--primary))"}}),e.jsx("span",{className:"font-medium text-card-foreground",children:l.nome})]},l.id)})})]})})]})},kt=({currentPage:a,totalPages:t,onPageChange:o})=>t<=1?null:e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-6",children:[e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>o(a-1),disabled:a===1,children:[e.jsx(ha,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:"Anterior"})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["P√°gina ",a," de ",t]}),e.jsxs(T,{variant:"outline",size:"sm",onClick:()=>o(a+1),disabled:a===t,children:[e.jsx("span",{className:"mr-2",children:"Pr√≥xima"}),e.jsx(pa,{className:"h-4 w-4"})]})]}),as=typeof TextDecoder<"u"?new TextDecoder("utf-8"):null;async function ot(a){if(typeof a=="string")return a;if(typeof window<"u"&&a instanceof File)try{return await a.text()}catch(t){throw console.error("[OFX Parser] Erro ao ler arquivo como texto:",t),new Error(`Erro ao ler arquivo: ${(t==null?void 0:t.message)||"Arquivo pode estar corrompido"}`)}if(a&&a.byteLength!=null)return as?as.decode(a):String.fromCharCode.apply(null,new Uint8Array(a));throw console.error("[OFX Parser] Entrada inv√°lida:",typeof a,a),new Error("Entrada inv√°lida para leitura de texto OFX. Selecione um arquivo .ofx v√°lido.")}function nt(a){if(!a)return null;const t=String(a).match(/(\d{4})(\d{2})(\d{2})/);if(!t)return null;const[o,i,m,j]=t,u=Number(i),K=Number(m)-1,P=Number(j);return new Date(u,K,P).toISOString().split("T")[0]}function lt(a){if(a==null)return 0;const t=Number(String(a).replace(",","."));return isNaN(t)?0:t}function X(a,t){const o=new RegExp(`<${t}>([^\r
<]*)`,"i"),i=a.match(o);if(i)return i[1].trim();const m=new RegExp(`<${t}>([sS]*?)</${t}>`,"i"),j=a.match(m);return j?j[1].trim():""}function it(a){const t=/<STMTTRN>([\s\S]*?)<\/STMTTRN>/gi,o=[];let i;for(;(i=t.exec(a))!==null;)o.push(i[1]);if(o.length)return o;const m=/<STMTTRN>[\s\S]*?(?=<STMTTRN>|<\/BANKTRANLIST>|<\/STMTRS>|$)/gi;return(a.match(m)||[]).map(u=>u.replace(/^<STMTTRN>/i,""))}function ct(a){return/<OFX[>\s]/i.test(a)||/<OFX>/i.test(a)}function dt(a){if(console.log("[OFX Parser] Iniciando parse, tamanho do texto:",(a==null?void 0:a.length)||0),!a)throw new Error("Arquivo vazio ou n√£o p√¥de ser lido");if(!ct(a))throw console.error("[OFX Parser] Arquivo n√£o reconhecido como OFX. Primeiros 500 caracteres:",a.substring(0,500)),new Error("Arquivo OFX inv√°lido ou n√£o reconhecido. Verifique se o arquivo √© um OFX v√°lido do seu banco.");const t=/\<banktranlist\>([\s\S]*?)\<\/banktranlist\>/i.exec(a),o=(t==null?void 0:t[1])||a;console.log("[OFX Parser] Bloco BANKTRANLIST encontrado:",!!t);const i=it(o);if(console.log("[OFX Parser] Chunks de transa√ß√£o encontrados:",i.length),i.length===0)throw new Error("Nenhuma transa√ß√£o (STMTTRN) encontrada no arquivo OFX. O arquivo pode estar vazio ou em formato n√£o suportado.");const m=i.map((u,K)=>{const P=X(u,"TRNTYPE")||X(u,"trntype"),S=X(u,"DTPOSTED")||X(u,"dtposted")||X(u,"DTUSER"),D=X(u,"TRNAMT")||X(u,"trnamt"),le=X(u,"MEMO")||X(u,"memo")||X(u,"NAME"),U=X(u,"FITID")||X(u,"fitid"),F=nt(S),ie=lt(D),H=(le||"").trim(),ce=(P||"").toUpperCase();return{data:F,valor:ie,descricao:H,tipo:ce,identificador:U,_rawDt:S,_rawAmt:D}}),j=m.filter(u=>u.data&&(u.valor||u.valor===0));if(console.log("[OFX Parser] Transa√ß√µes totais:",m.length,"V√°lidas:",j.length),m.length>0&&j.length===0)throw console.warn("[OFX Parser] Transa√ß√µes encontradas mas nenhuma v√°lida. Exemplos:",m.slice(0,3)),new Error(`Foram encontradas ${m.length} transa√ß√µes, mas nenhuma com data e valor v√°lidos.`);return j}async function mt(a){try{console.log("[OFX Parser] Lendo arquivo...",(a==null?void 0:a.name)||"string input");const t=await ot(a);return console.log("[OFX Parser] Arquivo lido com sucesso, tamanho:",(t==null?void 0:t.length)||0),dt(t)}catch(t){throw console.error("[OFX Parser] Erro ao processar arquivo:",t),t}}function Pt({isOpen:a,onOpenChange:t,type:o="expense",categories:i=[],paymentMethods:m=[],institutions:j=[],existingTransactions:u=[],onImport:K,onUndoImport:P,onClose:S}){var Ye,Je;const{toast:D}=ga(),le=d.useRef(null),[U,F]=d.useState("upload"),[ie,H]=d.useState(!1),[ce,de]=d.useState(!1),[b,Y]=d.useState([]),[E,v]=d.useState({}),[J,Q]=d.useState({}),[L,ae]=d.useState({}),[te,me]=d.useState({}),[Z,re]=d.useState({}),[oe,Se]=d.useState(""),[he,ve]=d.useState(""),[ne,l]=d.useState(""),[N,z]=d.useState(!1),[R,V]=d.useState([]),[C,y]=d.useState({}),[Ne,pe]=d.useState(0),[ee,ge]=d.useState(0),[we,fe]=d.useState(0),[Pe,Fe]=d.useState(0),[Ie,Ee]=d.useState([]),[Ue,Re]=d.useState(!1),[be,He]=d.useState(""),g=d.useMemo(()=>{const s={expense:{title:"Importar Despesas do OFX",filterFn:r=>r.valor<0||String(r.tipo).toUpperCase()==="DEBIT",transformValue:r=>Math.abs(r),defaultDescription:"Lan√ßamento OFX",emptyMessage:"Nenhuma despesa encontrada no OFX",emptyDescription:"Verifique se o arquivo cont√©m lan√ßamentos de sa√≠da.",showPaymentMethods:!0,showInstitutions:!1,showPaidCheckbox:!0,valueColor:"text-red-600",icon:e.jsx(ke,{className:"h-5 w-5 text-red-600"})},income:{title:"Importar Receitas do OFX",filterFn:r=>r.valor>0||String(r.tipo).toUpperCase()==="CREDIT",transformValue:r=>Math.abs(r),defaultDescription:"Receita OFX",emptyMessage:"Nenhuma receita encontrada no OFX",emptyDescription:"Verifique se o arquivo cont√©m lan√ßamentos de entrada.",showPaymentMethods:!1,showInstitutions:!1,showPaidCheckbox:!1,valueColor:"text-green-600",icon:e.jsx(ke,{className:"h-5 w-5 text-green-600"})},investment:{title:"Importar Aportes do OFX",filterFn:r=>r.valor<0||String(r.tipo).toUpperCase()==="DEBIT",transformValue:r=>Math.abs(r),defaultDescription:"Aporte OFX",emptyMessage:"Nenhum aporte encontrado no OFX",emptyDescription:"Verifique se o arquivo cont√©m lan√ßamentos de sa√≠da relacionados a investimentos.",showPaymentMethods:!1,showInstitutions:!0,showPaidCheckbox:!1,valueColor:"text-blue-600",icon:e.jsx(ke,{className:"h-5 w-5 text-blue-600"})}};return s[o]||s.expense},[o]),xe=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}),zs=d.useCallback(s=>{if(!s||!u.length)return"";const r=s.toLowerCase().trim(),c=u.find(x=>{const n=(x.descricao||"").toLowerCase().trim();return n===r||n.includes(r)||r.includes(n)});return(c==null?void 0:c.categoria_id)||""},[u]),Vs=d.useCallback(s=>{const r=[];return s.forEach((c,x)=>{var f;const n=c.data,h=((f=c.descricao)==null?void 0:f.toLowerCase().trim())||"",I=Number(c.valor)||0,p=u.find(q=>{var Qe;const W=q.data,Me=((Qe=q.descricao)==null?void 0:Qe.toLowerCase().trim())||"",ra=Number(q.valor||q.valor_aporte)||0;return W===n&&Me===h&&Math.abs(ra-Math.abs(I))<.01});p&&r.push({ofxIndex:x,ofxTransaction:c,existingTransaction:p})}),r},[u]),Bs=s=>{s.preventDefault(),s.stopPropagation(),H(!0)},Us=s=>{s.preventDefault(),s.stopPropagation(),H(!1)},Hs=s=>{s.preventDefault(),s.stopPropagation()},Ws=async s=>{s.preventDefault(),s.stopPropagation(),H(!1);const r=s.dataTransfer.files;r&&r.length>0&&await We(Array.from(r))},Gs=async s=>{const r=s.target.files;r&&r.length>0&&await We(Array.from(r)),s.target&&(s.target.value="")},We=async s=>{if(!s||s.length===0)return;console.log("[OFX Import] Iniciando processamento de",s.length,"arquivo(s)"),de(!0);const r=[],c=[];try{for(const p of s){console.log("[OFX Import] Processando arquivo:",p.name,"Tamanho:",p.size,"bytes");try{const f=await mt(p);console.log("[OFX Import] Transa√ß√µes encontradas no arquivo:",f.length);const q=f.filter(g.filterFn).map(W=>({...W,valor:g.transformValue(W.valor),sourceFile:p.name}));console.log("[OFX Import] Transa√ß√µes ap√≥s filtro (",o,"):",q.length),r.push(...q)}catch(f){console.error("[OFX Import] Erro ao processar arquivo:",p.name,f),c.push(`${p.name}: ${(f==null?void 0:f.message)||"Erro desconhecido"}`)}}if(console.log("[OFX Import] Total de transa√ß√µes:",r.length,"Erros:",c.length),r.length===0){const p=c.length>0?`Erros: ${c.join(", ")}`:g.emptyDescription;console.warn("[OFX Import] Nenhuma transa√ß√£o encontrada:",p),D({title:g.emptyMessage,description:p,variant:"destructive"});return}c.length>0&&D({title:"Alguns arquivos tiveram erros",description:c.join("; "),variant:"destructive"});const x=Vs(r);V(x),y({}),Y(r);const n={};r.forEach((p,f)=>{n[f]=!0}),v(n);const h={},I={};r.forEach((p,f)=>{h[f]=p.descricao||g.defaultDescription;const q=zs(p.descricao);q&&(I[f]=q)}),Q(h),ae(I),me({}),re({}),x.length>0?F("duplicates"):F("review")}catch(x){D({title:"Falha ao processar arquivos",description:(x==null?void 0:x.message)||"Erro desconhecido.",variant:"destructive"})}finally{de(!1)}},Ge=s=>{v(r=>({...r,[s]:!r[s]}))},Ks=()=>{const s={};b.forEach((r,c)=>{s[c]=!0}),v(s)},Ys=()=>{v({})},Ke=(s,r)=>{y(c=>({...c,[s]:r}))},Js=()=>{const s={};R.forEach(r=>{s[r.ofxIndex]="skip"}),y(s)},Qs=()=>{const s={};R.forEach(r=>{s[r.ofxIndex]="import"}),y(s)},Zs=()=>{const s=[],r={},c={},x={},n={},h={};b.forEach((I,p)=>{const f=R.some(Me=>Me.ofxIndex===p),q=C[p];if(f&&q==="skip")return;const W=s.length;s.push(I),J[p]!=null&&(r[W]=J[p]),L[p]!=null&&(c[W]=L[p]),te[p]!=null&&(x[W]=te[p]),Z[p]!=null&&(n[W]=Z[p]),h[W]=E[p]??!0}),Y(s),Q(r),ae(c),me(x),re(n),v(h),V([]),y({}),s.length>0?F("review"):(D({title:"Nenhuma transa√ß√£o para importar",description:"Todas as transa√ß√µes foram ignoradas."}),ye())},ea=async()=>{var c;if(!b.some((x,n)=>E[n]&&(L[n]||oe))){D({title:"Selecione uma categoria",description:"Defina ao menos a categoria padr√£o ou por item.",variant:"destructive"});return}if(g.showInstitutions&&!b.some((n,h)=>E[h]&&(Z[h]||ne))){D({title:"Selecione uma institui√ß√£o",description:"Defina ao menos a institui√ß√£o padr√£o ou por item.",variant:"destructive"});return}F("importing"),pe(0),ge(0),fe(0),Fe(0),Ee([]);const r=[];b.forEach((x,n)=>{if(!E[n])return;const h=L[n]||oe;if(!h)return;const I={descricao:J[n]??x.descricao??g.defaultDescription,categoria_id:h,data:x.data||new Date().toISOString().split("T")[0]};o==="investment"?I.valor_aporte=Number(x.valor)||0:I.valor=Number(x.valor)||0,g.showPaymentMethods&&(I.meio_pagamento_id=te[n]||he||null,I.pago=N,I.recorrente=!1),g.showInstitutions&&(I.instituicao_id=Z[n]||ne),r.push(I)});try{let x=0,n=0;const h=[];for(let p=0;p<r.length;p++){try{const f=await K([r[p]]);f&&Array.isArray(f)&&((c=f[0])!=null&&c.id)?h.push(f[0].id):f!=null&&f.id&&h.push(f.id),x++}catch{n++}pe(Math.round((p+1)/r.length*100)),ge(x),Fe(n)}Ee(h),F("complete");const I=b.length-r.length;fe(I)}catch(x){D({title:"Erro na importa√ß√£o",description:(x==null?void 0:x.message)||"Tente novamente.",variant:"destructive"}),F("review")}},sa=async()=>{if(!(!P||Ie.length===0)){Re(!0);try{await P(Ie),D({title:"Importa√ß√£o desfeita",description:`${Ie.length} transa√ß√µes removidas com sucesso.`}),ye()}catch(s){D({title:"Erro ao desfazer",description:(s==null?void 0:s.message)||"Tente novamente.",variant:"destructive"})}finally{Re(!1)}}},ye=()=>{F("upload"),Y([]),v({}),Q({}),ae({}),me({}),re({}),Se(""),ve(""),l(""),z(!1),V([]),y({}),pe(0),ge(0),fe(0),Fe(0),He(""),H(!1),de(!1),Ee([]),Re(!1),S==null||S(),t==null||t(!1)},aa=d.useMemo(()=>{if(!be)return b.map((r,c)=>({...r,originalIndex:c}));const s=be.toLowerCase();return b.map((r,c)=>({...r,originalIndex:c})).filter(r=>(J[r.originalIndex]||r.descricao||"").toLowerCase().includes(s)||String(r.valor).includes(be))},[b,J,be]),De=Object.values(E).filter(Boolean).length,Oe=b.reduce((s,r,c)=>E[c]?s+(Number(r.valor)||0):s,0),ta=s=>R.some(r=>r.ofxIndex===s);return e.jsx(ls,{open:a,onOpenChange:s=>!s&&ye(),children:e.jsxs(is,{className:"sm:max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(cs,{children:e.jsxs(ds,{className:"flex items-center gap-2",children:[g.icon,g.title]})}),U==="upload"&&e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:[e.jsx("input",{ref:le,type:"file",accept:".ofx,.qfx,.ofc,.xml,.txt",multiple:!0,className:"hidden",onChange:Gs}),e.jsx("div",{className:`
                w-full max-w-md p-8 border-2 border-dashed rounded-xl transition-all duration-300 cursor-pointer
                flex flex-col items-center justify-center gap-4
                ${ie?"border-primary bg-primary/10 scale-105":"border-muted-foreground/30 hover:border-primary/50 hover:bg-muted/50"}
                ${ce?"opacity-50 pointer-events-none":""}
              `,onDragEnter:Bs,onDragLeave:Us,onDragOver:Hs,onDrop:Ws,onClick:()=>{var s;return(s=le.current)==null?void 0:s.click()},children:ce?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-12 w-12 text-primary animate-spin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Processando arquivo..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 bg-primary/10 rounded-full",children:e.jsx(Xa,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:ie?"Solte o(s) arquivo(s) aqui":"Arraste arquivo(s) OFX"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"ou clique para selecionar (m√∫ltiplos arquivos suportados)"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(ms,{className:"h-4 w-4"}),e.jsx("span",{children:"Formatos: .ofx, .qfx, .ofc, .xml, .txt"})]})]})})]}),U==="duplicates"&&e.jsxs("div",{className:"flex-1 flex flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[e.jsx(Ae,{className:"h-5 w-5 text-yellow-600 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["Foram encontradas ",e.jsx("strong",{children:R.length})," transa√ß√£o(√µes) que podem ser duplicatas. Escolha o que fazer com cada uma."]})]}),e.jsxs("div",{className:"flex-1 overflow-auto border rounded-lg",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-2 p-3 bg-muted/50 text-xs font-medium text-muted-foreground border-b sticky top-0",children:[e.jsx("div",{className:"col-span-3",children:"Descri√ß√£o OFX"}),e.jsx("div",{className:"col-span-2",children:"Data"}),e.jsx("div",{className:"col-span-2 text-right",children:"Valor"}),e.jsx("div",{className:"col-span-3",children:"Existente"}),e.jsx("div",{className:"col-span-2",children:"A√ß√£o"})]}),R.map(s=>e.jsxs("div",{className:"p-3 border-b last:border-b-0 bg-yellow-50/50 dark:bg-yellow-900/10",children:[e.jsxs("div",{className:"md:hidden space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:s.ofxTransaction.descricao}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.ofxTransaction.data})]}),e.jsx("span",{className:`font-bold ${g.valueColor}`,children:xe.format(Number(s.ofxTransaction.valor)||0)})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Existente: ",s.existingTransaction.descricao]}),e.jsxs(O,{value:C[s.ofxIndex]||void 0,onValueChange:r=>Ke(s.ofxIndex,r),children:[e.jsx(M,{className:"w-full",children:e.jsx(_,{placeholder:"Escolher a√ß√£o"})}),e.jsxs($,{children:[e.jsx(w,{value:"import",children:"Importar mesmo assim"}),e.jsx(w,{value:"skip",children:"Ignorar (√© duplicata)"})]})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-2 items-center",children:[e.jsx("div",{className:"col-span-3 text-sm truncate",title:s.ofxTransaction.descricao,children:s.ofxTransaction.descricao}),e.jsx("div",{className:"col-span-2 text-xs",children:s.ofxTransaction.data}),e.jsx("div",{className:`col-span-2 text-right font-medium ${g.valueColor}`,children:xe.format(Number(s.ofxTransaction.valor)||0)}),e.jsx("div",{className:"col-span-3 text-xs text-muted-foreground truncate",title:s.existingTransaction.descricao,children:s.existingTransaction.descricao}),e.jsx("div",{className:"col-span-2",children:e.jsxs(O,{value:C[s.ofxIndex]||void 0,onValueChange:r=>Ke(s.ofxIndex,r),children:[e.jsx(M,{className:"w-full h-8 text-xs",children:e.jsx(_,{placeholder:"Escolher"})}),e.jsxs($,{children:[e.jsx(w,{value:"import",children:"Importar"}),e.jsx(w,{value:"skip",children:"Ignorar"})]})]})})]})]},s.ofxIndex))]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(T,{variant:"outline",size:"sm",onClick:Js,children:"Ignorar Todas"}),e.jsx(T,{variant:"outline",size:"sm",onClick:Qs,children:"Importar Todas"}),e.jsx("div",{className:"flex-1"}),e.jsx(T,{onClick:Zs,children:"Prosseguir"})]})]}),U==="review"&&e.jsxs("div",{className:"flex-1 flex flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(_e,{children:e.jsxs($e,{className:"p-3 flex items-center gap-3",children:[e.jsx(qa,{className:"h-8 w-8 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Selecionados"}),e.jsxs("p",{className:"text-lg font-bold",children:[De,"/",b.length]})]})]})}),e.jsx(_e,{children:e.jsxs($e,{className:"p-3 flex items-center gap-3",children:[g.icon,e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"}),e.jsx("p",{className:`text-lg font-bold ${g.valueColor}`,children:xe.format(Oe)})]})]})}),e.jsx(_e,{className:"col-span-2",children:e.jsxs($e,{className:"p-3 flex items-center gap-3",children:[e.jsx(ka,{className:"h-8 w-8 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Per√≠odo"}),e.jsx("p",{className:"text-sm font-medium",children:b.length>0?`${(Ye=b[b.length-1])==null?void 0:Ye.data} a ${(Je=b[0])==null?void 0:Je.data}`:"-"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Categoria padr√£o"}),e.jsxs(O,{value:oe||void 0,onValueChange:Se,children:[e.jsx(M,{className:"w-full mt-1",children:e.jsx(_,{placeholder:"Selecione uma categoria"})}),e.jsx($,{children:i.map(s=>e.jsx(w,{value:String(s.id),children:s.nome},s.id))})]})]}),g.showPaymentMethods&&m.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Meio de pagamento"}),e.jsxs(O,{value:he||void 0,onValueChange:s=>ve(s==="none"?"":s),children:[e.jsx(M,{className:"w-full mt-1",children:e.jsx(_,{placeholder:"Selecione"})}),e.jsxs($,{children:[e.jsx(w,{value:"none",children:"N√£o especificado"}),m.map(s=>e.jsx(w,{value:String(s.id),children:s.nome},s.id))]})]})]}),g.showInstitutions&&j.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Institui√ß√£o"}),e.jsxs(O,{value:ne||void 0,onValueChange:l,children:[e.jsx(M,{className:"w-full mt-1",children:e.jsx(_,{placeholder:"Selecione"})}),e.jsx($,{children:j.map(s=>e.jsx(w,{value:String(s.id),children:s.nome_banco||s.nome},s.id))})]})]}),g.showPaidCheckbox&&e.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[e.jsx("input",{id:"markAsPaid",type:"checkbox",className:"rounded accent-primary h-4 w-4",checked:N,onChange:s=>z(s.target.checked)}),e.jsx("label",{htmlFor:"markAsPaid",className:"text-sm",children:"Marcar como pago"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Buscar por descri√ß√£o ou valor...",className:"flex-1 min-w-[200px] px-3 py-2 border rounded-md text-sm",value:be,onChange:s=>He(s.target.value)}),e.jsx(T,{variant:"outline",size:"sm",onClick:Ks,children:"Selecionar Todas"}),e.jsx(T,{variant:"outline",size:"sm",onClick:Ys,children:"Desmarcar Todas"})]}),e.jsxs("div",{className:"flex-1 overflow-auto border rounded-lg",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-2 p-3 bg-muted/50 text-xs font-medium text-muted-foreground border-b sticky top-0 z-10",children:[e.jsx("div",{className:"col-span-1 text-center",children:"‚úì"}),e.jsx("div",{className:"col-span-3",children:"Descri√ß√£o"}),e.jsx("div",{className:"col-span-2",children:"Data"}),e.jsx("div",{className:"col-span-2 text-right",children:"Valor"}),e.jsx("div",{className:"col-span-2",children:"Categoria"}),e.jsx("div",{className:"col-span-2",children:g.showPaymentMethods?"Pagamento":g.showInstitutions?"Institui√ß√£o":""})]}),aa.map(s=>{const r=s.originalIndex,c=E[r],x=ta(r);return e.jsxs("div",{className:`
                      p-3 border-b last:border-b-0 transition-colors
                      ${c?"bg-white dark:bg-background":"bg-muted/30 opacity-60"}
                      ${x?"border-l-4 border-l-yellow-500":""}
                    `,children:[e.jsxs("div",{className:"md:hidden space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:()=>Ge(r),className:"mt-1 h-4 w-4 rounded accent-primary"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("input",{className:"w-full px-2 py-1 border rounded text-sm",value:J[r]??s.descricao??g.defaultDescription,onChange:n=>Q(h=>({...h,[r]:n.target.value})),disabled:!c}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:s.data}),e.jsx("span",{className:`font-bold ${g.valueColor}`,children:xe.format(Number(s.valor)||0)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pl-7",children:[e.jsxs(O,{value:L[r]||oe||void 0,onValueChange:n=>ae(h=>({...h,[r]:n})),disabled:!c,children:[e.jsx(M,{className:"w-full h-8 text-xs",children:e.jsx(_,{placeholder:"Categoria"})}),e.jsx($,{children:i.map(n=>e.jsx(w,{value:String(n.id),children:n.nome},n.id))})]}),g.showPaymentMethods&&e.jsxs(O,{value:te[r]||he||void 0,onValueChange:n=>me(h=>({...h,[r]:n==="none"?"":n})),disabled:!c,children:[e.jsx(M,{className:"w-full h-8 text-xs",children:e.jsx(_,{placeholder:"Pagamento"})}),e.jsxs($,{children:[e.jsx(w,{value:"none",children:"N√£o especificado"}),m.map(n=>e.jsx(w,{value:String(n.id),children:n.nome},n.id))]})]}),g.showInstitutions&&e.jsxs(O,{value:Z[r]||ne||void 0,onValueChange:n=>re(h=>({...h,[r]:n})),disabled:!c,children:[e.jsx(M,{className:"w-full h-8 text-xs",children:e.jsx(_,{placeholder:"Institui√ß√£o"})}),e.jsx($,{children:j.map(n=>e.jsx(w,{value:String(n.id),children:n.nome_banco||n.nome},n.id))})]})]}),x&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-yellow-600 pl-7",children:[e.jsx(Ae,{className:"h-3 w-3"}),e.jsx("span",{children:"Poss√≠vel duplicata"})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-2 items-center",children:[e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx("input",{type:"checkbox",checked:c,onChange:()=>Ge(r),className:"h-4 w-4 rounded accent-primary"})}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("input",{className:"w-full px-2 py-1 border rounded text-sm",value:J[r]??s.descricao??g.defaultDescription,onChange:n=>Q(h=>({...h,[r]:n.target.value})),disabled:!c}),x&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-yellow-600 mt-1",children:[e.jsx(Ae,{className:"h-3 w-3"}),e.jsx("span",{children:"Poss√≠vel duplicata"})]})]}),e.jsx("div",{className:"col-span-2 text-xs",children:s.data}),e.jsx("div",{className:`col-span-2 text-right font-medium ${g.valueColor}`,children:xe.format(Number(s.valor)||0)}),e.jsx("div",{className:"col-span-2",children:e.jsxs(O,{value:L[r]||oe||void 0,onValueChange:n=>ae(h=>({...h,[r]:n})),disabled:!c,children:[e.jsx(M,{className:"w-full h-8",children:e.jsx(_,{placeholder:"Categoria"})}),e.jsx($,{children:i.map(n=>e.jsx(w,{value:String(n.id),children:n.nome},n.id))})]})}),e.jsxs("div",{className:"col-span-2",children:[g.showPaymentMethods&&e.jsxs(O,{value:te[r]||he||void 0,onValueChange:n=>me(h=>({...h,[r]:n==="none"?"":n})),disabled:!c,children:[e.jsx(M,{className:"w-full h-8",children:e.jsx(_,{placeholder:"Pagamento"})}),e.jsxs($,{children:[e.jsx(w,{value:"none",children:"N√£o especificado"}),m.map(n=>e.jsx(w,{value:String(n.id),children:n.nome},n.id))]})]}),g.showInstitutions&&e.jsxs(O,{value:Z[r]||ne||void 0,onValueChange:n=>re(h=>({...h,[r]:n})),disabled:!c,children:[e.jsx(M,{className:"w-full h-8",children:e.jsx(_,{placeholder:"Institui√ß√£o"})}),e.jsx($,{children:j.map(n=>e.jsx(w,{value:String(n.id),children:n.nome_banco||n.nome},n.id))})]})]})]})]},r)})]}),e.jsxs(Ia,{className:"gap-2",children:[e.jsx(T,{variant:"ghost",onClick:ye,children:"Cancelar"}),e.jsxs(T,{onClick:ea,disabled:De===0,children:["Importar ",De," ",De===1?"item":"itens"]})]})]}),U==="importing"&&e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center gap-6 p-6",children:[e.jsx(Ve,{className:"h-12 w-12 text-primary animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-lg",children:"Importando transa√ß√µes..."}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[ee," de ",De," processados"]})]}),e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx(Pa,{value:Ne,className:"h-3"}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-2",children:[Ne,"%"]})]})]}),U==="complete"&&e.jsxs("div",{className:"flex-1 flex flex-col gap-6 p-6 overflow-auto",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-green-100 dark:bg-green-900/30 rounded-full",children:e.jsx(Ce,{className:"h-12 w-12 text-green-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-lg",children:"Importa√ß√£o conclu√≠da!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[ee," transa√ß√µes importadas com sucesso"]})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-4",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4 text-primary"}),"Resumo da Importa√ß√£o"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-background rounded-lg p-3 border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total importado"}),e.jsx("p",{className:`text-lg font-bold ${g.valueColor}`,children:xe.format(Oe)})]}),e.jsxs("div",{className:"bg-background rounded-lg p-3 border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Transa√ß√µes"}),e.jsx("p",{className:"text-lg font-bold",children:ee})]}),e.jsxs("div",{className:"bg-background rounded-lg p-3 border",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Valor m√©dio"}),e.jsx("p",{className:"text-lg font-bold",children:xe.format(ee>0?Oe/ee:0)})]})]}),(()=>{const s=b.filter((c,x)=>E[x]&&!L[x]&&oe).length,r=Object.values(L).filter(Boolean).length;return e.jsxs("div",{className:"space-y-2",children:[r>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-success",children:[e.jsx(Ce,{className:"h-4 w-4"}),e.jsxs("span",{children:[r," transa√ß√µes com categoria sugerida automaticamente"]})]}),s>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-warning",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsxs("span",{children:[s," transa√ß√µes usaram a categoria padr√£o"]})]})]})})(),e.jsx("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:"üí°"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-primary",children:"Dica:"}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[o==="expense"&&"Revise suas despesas e marque as recorrentes. Isso ajuda a prever gastos futuros!",o==="income"&&"Identifique suas fontes de renda principais para um melhor planejamento.",o==="investment"&&"Acompanhe seus aportes mensais para manter a consist√™ncia nos investimentos!"]})]})]})}),we>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[we," transa√ß√µes n√£o foram selecionadas para importa√ß√£o"]}),Pe>0&&e.jsxs("p",{className:"text-xs text-red-600",children:[Pe," transa√ß√µes tiveram erro durante a importa√ß√£o"]})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[P&&Ie.length>0&&e.jsx(T,{variant:"outline",onClick:sa,disabled:Ue,className:"flex items-center gap-2",children:Ue?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 animate-spin"}),"Desfazendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fa,{className:"h-4 w-4"}),"Desfazer Importa√ß√£o"]})}),e.jsx(T,{onClick:ye,children:"Concluir"})]})]})]})})}export{Tt as L,Pt as O,kt as P,At as T,Xa as U,St as u};
