import{c as Me,i as ze,r as X,j as n,B as ue,n as We,D as $e,o as dt,f as pt,H as mt,p as Te,C as oe,a as se,b as le,d as ht,e as ce}from"./index-4483945d.js";import{u as yt,L as vt,T as gt,P as xt,C as jt,a as bt}from"./Pagination-3ee3e9bb.js";import{L as he,I as Ee,C as wt}from"./label-5c6aff1b.js";import{S as _e,b as ke,c as Pe,d as Ne,f as Re,s as St,e as Tt,C as Ot,a as _t}from"./CompactHeader-842ee15d.js";import{D as Ue,a as kt,P as Pt,b as He,c as Xe,d as Ye,e as Nt,f as Rt}from"./dialog-aacaf9ba.js";import{E as Mt,C as Dt}from"./ExpenseTrendChart-250ad405.js";import{T as Et,a as Ct,b as Ce,c as Ie}from"./tabs-8348bb05.js";import{a as Le,b as Ae,p as Fe,s as It}from"./index-b30782cb.js";import{T as Lt}from"./trash-2-e81b75e4.js";import"./CategoryChart-b4c4616b.js";import"./generateCategoricalChart-33d062fe.js";import"./index-a53a69e9.js";import"./index-65722b09.js";import"./extends-4c19d496.js";import"./trending-down-6cba7773.js";import"./Area-2a822261.js";import"./YAxis-44481452.js";const At=Me("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),Ft=Me("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),Bt=Me("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function zt({onSubmit:M,expenseToEdit:O,onOpenChange:te,isOpen:g}){const{categories:o}=ze(),r=o.filter(u=>u.tipo==="gasto"),s={descricao:"",valor:"",categoria_id:"",recorrente:!1,pago:!1,data:new Date().toISOString().split("T")[0]},[c,f]=X.useState(s),[h,m]=X.useState(""),y=X.useRef(null),j=u=>{if(u==null||u==="")return"";const a=Number(u);return isNaN(a)?"":a.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})};X.useEffect(()=>{O!=null&&O.id?f({descricao:O.descricao||"",valor:j(O.valor),categoria_id:O.categoria_id||"",recorrente:O.recorrente||!1,pago:O.pago||!1,data:O.data?new Date(O.data).toISOString().split("T")[0]:s.data}):f(s),m("")},[O,g]),X.useEffect(()=>{var a;const u=(a=y.current)==null?void 0:a.input;if(u){const t=u.value.length;u.setSelectionRange(t,t)}},[c.valor]);const _=u=>{if(!u)return 0;const a=String(u).replace(/\./g,"").replace(",","."),t=parseFloat(a);return isNaN(t)?0:t},P=u=>{u.preventDefault();const a=_(c.valor);if(a<=0){m("Informe um valor válido maior que zero.");return}if(!c.categoria_id){m("Por favor, selecione uma categoria para a despesa.");return}M({...c,valor:a},O==null?void 0:O.id),w()},w=()=>{f(s),m("")},i=u=>{te(u),u||w()},e=u=>{f({...c,valor:u})};return n.jsxs(Ue,{open:g,onOpenChange:i,children:[!(O!=null&&O.id)&&n.jsx(kt,{asChild:!0,children:n.jsxs(ue,{children:[n.jsx(Pt,{className:"w-4 h-4 mr-2"}),"Nova Despesa"]})}),n.jsxs(He,{className:"sm:max-w-md",children:[n.jsxs(Xe,{children:[n.jsxs(Ye,{className:"flex items-center gap-2",children:[n.jsx(We,{className:"w-5 h-5"}),O!=null&&O.id?"Editar Despesa":"Adicionar Despesa"]}),n.jsx(Nt,{children:O!=null&&O.id?"Atualize os detalhes da sua despesa.":"Registre uma nova despesa para controlar seus gastos."})]}),n.jsxs("form",{onSubmit:P,className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(he,{htmlFor:"description",children:"Descrição"}),n.jsx(Ee,{id:"description",placeholder:"Ex: Almoço no restaurante",value:c.descricao,onChange:u=>f({...c,descricao:u.target.value}),required:!0})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(he,{htmlFor:"amount",children:"Valor (R$)"}),n.jsx(wt,{id:"amount",placeholder:"0,00",value:c.valor,onChange:e,ref:y,required:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(he,{htmlFor:"date",children:"Data"}),n.jsx(Ee,{id:"date",type:"date",value:c.data,onChange:u=>f({...c,data:u.target.value}),required:!0})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(he,{htmlFor:"category",children:"Categoria"}),r.length>0?n.jsxs(n.Fragment,{children:[n.jsxs(_e,{value:c.categoria_id,onValueChange:u=>{f({...c,categoria_id:u}),m("")},children:[n.jsx(ke,{children:n.jsx(Pe,{placeholder:"Selecione uma categoria"})}),n.jsx(Ne,{children:r.map(u=>n.jsx(Re,{value:u.id.toString(),children:u.nome},u.id))})]}),h&&n.jsx("p",{className:"text-sm text-red-600 mt-1",children:h})]}):n.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhuma categoria de gasto disponível."})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",id:"isRecurring",checked:c.recorrente,onChange:u=>f({...c,recorrente:u.target.checked}),className:"rounded accent-primary"}),n.jsxs(he,{htmlFor:"isRecurring",className:"flex items-center gap-2 text-sm",children:[n.jsx(Ft,{className:"w-4 h-4"}),"Despesa recorrente"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",id:"isPaid",checked:c.pago,onChange:u=>f({...c,pago:u.target.checked}),className:"rounded accent-primary"}),n.jsxs(he,{htmlFor:"isPaid",className:"flex items-center gap-2 text-sm",children:[n.jsx($e,{className:"w-4 h-4"}),"Despesa já paga"]})]})]}),n.jsx(ue,{type:"submit",className:"w-full",children:O!=null&&O.id?"Salvar Alterações":"Adicionar Despesa"})]})]})]})}var qe={exports:{}};(function(M,O){(function(g,o){M.exports=o(X)})(dt,function(te){return function(g){var o={};function r(s){if(o[s])return o[s].exports;var c=o[s]={i:s,l:!1,exports:{}};return g[s].call(c.exports,c,c.exports,r),c.l=!0,c.exports}return r.m=g,r.c=o,r.d=function(s,c,f){r.o(s,c)||Object.defineProperty(s,c,{configurable:!1,enumerable:!0,get:f})},r.n=function(s){var c=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(c,"a",c),c},r.o=function(s,c){return Object.prototype.hasOwnProperty.call(s,c)},r.p="/",r(r.s=11)}([function(g,o,r){(function(s){g.exports=r(16)()}).call(o,r(2))},function(g,o){g.exports=te},function(g,o){var r=g.exports={},s,c;function f(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=f}catch{s=f}try{typeof clearTimeout=="function"?c=clearTimeout:c=h}catch{c=h}})();function m(t){if(s===setTimeout)return setTimeout(t,0);if((s===f||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch{try{return s.call(null,t,0)}catch{return s.call(this,t,0)}}}function y(t){if(c===clearTimeout)return clearTimeout(t);if((c===h||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t)}catch{try{return c.call(null,t)}catch{return c.call(this,t)}}}var j=[],_=!1,P,w=-1;function i(){!_||!P||(_=!1,P.length?j=P.concat(j):w=-1,j.length&&e())}function e(){if(!_){var t=m(i);_=!0;for(var d=j.length;d;){for(P=j,j=[];++w<d;)P&&P[w].run();w=-1,d=j.length}P=null,_=!1,y(t)}}r.nextTick=function(t){var d=new Array(arguments.length-1);if(arguments.length>1)for(var v=1;v<arguments.length;v++)d[v-1]=arguments[v];j.push(new u(t,d)),j.length===1&&!_&&m(e)};function u(t,d){this.fun=t,this.array=d}u.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function a(){}r.on=a,r.addListener=a,r.once=a,r.off=a,r.removeListener=a,r.removeAllListeners=a,r.emit=a,r.prependListener=a,r.prependOnceListener=a,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(s){return s.reduce(function(c,f){return c+f})/s.length}},function(g,o,r){function s(f){return function(){return f}}var c=function(){};c.thatReturns=s,c.thatReturnsFalse=s(!1),c.thatReturnsTrue=s(!0),c.thatReturnsNull=s(null),c.thatReturnsThis=function(){return this},c.thatReturnsArgument=function(f){return f},g.exports=c},function(g,o,r){(function(s){function c(f,h,m,y,j,_,P,w){if(!f){var i;if(h===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var e=[m,y,j,_,P,w],u=0;i=new Error(h.replace(/%s/g,function(){return e[u++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}}g.exports=c}).call(o,r(2))},function(g,o,r){var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";g.exports=s},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(s){return Math.min.apply(Math,s)}},function(g,o,r){(function(s){var c=r(4),f=c;g.exports=f}).call(o,r(2))},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(s){return Math.max.apply(Math,s)}},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=r(3),c=f(s);function f(h){return h&&h.__esModule?h:{default:h}}o.default=function(h){var m=(0,c.default)(h),y=h.map(function(_){return Math.pow(_-m,2)}),j=(0,c.default)(y);return Math.sqrt(j)}},function(g,o,r){g.exports=r(12)},function(g,o,r){g.exports=r(13)},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.SparklinesText=o.SparklinesNormalBand=o.SparklinesReferenceLine=o.SparklinesSpots=o.SparklinesBars=o.SparklinesCurve=o.SparklinesLine=o.Sparklines=void 0;var s=function(){function I(T,U){for(var D=0;D<U.length;D++){var Y=U[D];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(T,Y.key,Y)}}return function(T,U,D){return U&&I(T.prototype,U),D&&I(T,D),T}}(),c=r(0),f=C(c),h=r(1),m=C(h),y=r(17),j=C(y),_=r(18),P=C(_),w=r(19),i=C(w),e=r(20),u=C(e),a=r(21),t=C(a),d=r(22),v=C(d),S=r(27),k=C(S),E=r(28),q=C(E);function C(I){return I&&I.__esModule?I:{default:I}}function Q(I,T){if(!(I instanceof T))throw new TypeError("Cannot call a class as a function")}function J(I,T){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:I}function K(I,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);I.prototype=Object.create(T&&T.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(I,T):I.__proto__=T)}var G=function(I){K(T,I);function T(U){return Q(this,T),J(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,U))}return s(T,[{key:"render",value:function(){var D=this.props,Y=D.data,ae=D.limit,l=D.width,x=D.height,B=D.svgWidth,z=D.svgHeight,L=D.preserveAspectRatio,W=D.margin,A=D.style,F=D.max,H=D.min;if(Y.length===0)return null;var N=(0,q.default)({data:Y,limit:ae,width:l,height:x,margin:W,max:F,min:H}),Z={style:A,viewBox:"0 0 "+l+" "+x,preserveAspectRatio:L};return B>0&&(Z.width=B),z>0&&(Z.height=z),m.default.createElement("svg",Z,m.default.Children.map(this.props.children,function(ie){return m.default.cloneElement(ie,{data:Y,points:N,width:l,height:x,margin:W})}))}}]),T}(h.PureComponent);G.propTypes={data:f.default.array,limit:f.default.number,width:f.default.number,height:f.default.number,svgWidth:f.default.number,svgHeight:f.default.number,preserveAspectRatio:f.default.string,margin:f.default.number,style:f.default.object,min:f.default.number,max:f.default.number,onMouseMove:f.default.func},G.defaultProps={data:[],width:240,height:60,preserveAspectRatio:"none",margin:2},o.Sparklines=G,o.SparklinesLine=P.default,o.SparklinesCurve=i.default,o.SparklinesBars=u.default,o.SparklinesSpots=t.default,o.SparklinesReferenceLine=v.default,o.SparklinesNormalBand=k.default,o.SparklinesText=j.default},function(g,o,r){(function(s){var c=r(4),f=r(5),h=r(8),m=r(6),y=r(15);g.exports=function(j,_){var P=typeof Symbol=="function"&&Symbol.iterator,w="@@iterator";function i(l){var x=l&&(P&&l[P]||l[w]);if(typeof x=="function")return x}var e="<<anonymous>>",u={array:v("array"),bool:v("boolean"),func:v("function"),number:v("number"),object:v("object"),string:v("string"),symbol:v("symbol"),any:S(),arrayOf:k,element:E(),instanceOf:q,node:K(),objectOf:Q,oneOf:C,oneOfType:J,shape:G};function a(l,x){return l===x?l!==0||1/l===1/x:l!==l&&x!==x}function t(l){this.message=l,this.stack=""}t.prototype=Error.prototype;function d(l){function x(z,L,W,A,F,H,N){return A=A||e,H=H||W,N!==m&&_&&f(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types"),L[W]==null?z?L[W]===null?new t("The "+F+" `"+H+"` is marked as required "+("in `"+A+"`, but its value is `null`.")):new t("The "+F+" `"+H+"` is marked as required in "+("`"+A+"`, but its value is `undefined`.")):null:l(L,W,A,F,H)}var B=x.bind(null,!1);return B.isRequired=x.bind(null,!0),B}function v(l){function x(B,z,L,W,A,F){var H=B[z],N=U(H);if(N!==l){var Z=D(H);return new t("Invalid "+W+" `"+A+"` of type "+("`"+Z+"` supplied to `"+L+"`, expected ")+("`"+l+"`."))}return null}return d(x)}function S(){return d(c.thatReturnsNull)}function k(l){function x(B,z,L,W,A){if(typeof l!="function")return new t("Property `"+A+"` of component `"+L+"` has invalid PropType notation inside arrayOf.");var F=B[z];if(!Array.isArray(F)){var H=U(F);return new t("Invalid "+W+" `"+A+"` of type "+("`"+H+"` supplied to `"+L+"`, expected an array."))}for(var N=0;N<F.length;N++){var Z=l(F,N,L,W,A+"["+N+"]",m);if(Z instanceof Error)return Z}return null}return d(x)}function E(){function l(x,B,z,L,W){var A=x[B];if(!j(A)){var F=U(A);return new t("Invalid "+L+" `"+W+"` of type "+("`"+F+"` supplied to `"+z+"`, expected a single ReactElement."))}return null}return d(l)}function q(l){function x(B,z,L,W,A){if(!(B[z]instanceof l)){var F=l.name||e,H=ae(B[z]);return new t("Invalid "+W+" `"+A+"` of type "+("`"+H+"` supplied to `"+L+"`, expected ")+("instance of `"+F+"`."))}return null}return d(x)}function C(l){if(!Array.isArray(l))return c.thatReturnsNull;function x(B,z,L,W,A){for(var F=B[z],H=0;H<l.length;H++)if(a(F,l[H]))return null;var N=JSON.stringify(l);return new t("Invalid "+W+" `"+A+"` of value `"+F+"` "+("supplied to `"+L+"`, expected one of "+N+"."))}return d(x)}function Q(l){function x(B,z,L,W,A){if(typeof l!="function")return new t("Property `"+A+"` of component `"+L+"` has invalid PropType notation inside objectOf.");var F=B[z],H=U(F);if(H!=="object")return new t("Invalid "+W+" `"+A+"` of type "+("`"+H+"` supplied to `"+L+"`, expected an object."));for(var N in F)if(F.hasOwnProperty(N)){var Z=l(F,N,L,W,A+"."+N,m);if(Z instanceof Error)return Z}return null}return d(x)}function J(l){if(!Array.isArray(l))return c.thatReturnsNull;for(var x=0;x<l.length;x++){var B=l[x];if(typeof B!="function")return h(!1,"Invalid argument supplid to oneOfType. Expected an array of check functions, but received %s at index %s.",Y(B),x),c.thatReturnsNull}function z(L,W,A,F,H){for(var N=0;N<l.length;N++){var Z=l[N];if(Z(L,W,A,F,H,m)==null)return null}return new t("Invalid "+F+" `"+H+"` supplied to "+("`"+A+"`."))}return d(z)}function K(){function l(x,B,z,L,W){return I(x[B])?null:new t("Invalid "+L+" `"+W+"` supplied to "+("`"+z+"`, expected a ReactNode."))}return d(l)}function G(l){function x(B,z,L,W,A){var F=B[z],H=U(F);if(H!=="object")return new t("Invalid "+W+" `"+A+"` of type `"+H+"` "+("supplied to `"+L+"`, expected `object`."));for(var N in l){var Z=l[N];if(Z){var ie=Z(F,N,L,W,A+"."+N,m);if(ie)return ie}}return null}return d(x)}function I(l){switch(typeof l){case"number":case"string":case"undefined":return!0;case"boolean":return!l;case"object":if(Array.isArray(l))return l.every(I);if(l===null||j(l))return!0;var x=i(l);if(x){var B=x.call(l),z;if(x!==l.entries){for(;!(z=B.next()).done;)if(!I(z.value))return!1}else for(;!(z=B.next()).done;){var L=z.value;if(L&&!I(L[1]))return!1}}else return!1;return!0;default:return!1}}function T(l,x){return l==="symbol"||x["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&x instanceof Symbol}function U(l){var x=typeof l;return Array.isArray(l)?"array":l instanceof RegExp?"object":T(x,l)?"symbol":x}function D(l){if(typeof l>"u"||l===null)return""+l;var x=U(l);if(x==="object"){if(l instanceof Date)return"date";if(l instanceof RegExp)return"regexp"}return x}function Y(l){var x=D(l);switch(x){case"array":case"object":return"an "+x;case"boolean":case"date":case"regexp":return"a "+x;default:return x}}function ae(l){return!l.constructor||!l.constructor.name?e:l.constructor.name}return u.checkPropTypes=y,u.PropTypes=u,u}}).call(o,r(2))},function(g,o,r){(function(s){function c(f,h,m,y,j){}g.exports=c}).call(o,r(2))},function(g,o,r){var s=r(4),c=r(5),f=r(6);g.exports=function(){function h(j,_,P,w,i,e){e!==f&&c(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}h.isRequired=h;function m(){return h}var y={array:h,bool:h,func:h,number:h,object:h,string:h,symbol:h,any:h,arrayOf:m,element:h,instanceOf:m,node:h,objectOf:m,oneOf:m,oneOfType:m,shape:m};return y.checkPropTypes=s,y.PropTypes=y,y}},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=function(){function i(e,u){for(var a=0;a<u.length;a++){var t=u[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,u,a){return u&&i(e.prototype,u),a&&i(e,a),e}}(),c=r(0),f=y(c),h=r(1),m=y(h);function y(i){return i&&i.__esModule?i:{default:i}}function j(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i}function P(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)}var w=function(i){P(e,i);function e(){return j(this,e),_(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,[{key:"render",value:function(){var a=this.props,t=a.point,d=a.text,v=a.fontSize,S=a.fontFamily,k=t.x,E=t.y;return m.default.createElement("g",null,m.default.createElement("text",{x:k,y:E,fontFamily:S||"Verdana",fontSize:v||10},d))}}]),e}(m.default.Component);w.propTypes={text:f.default.string,point:f.default.object,fontSize:f.default.number,fontFamily:f.default.string},w.defaultProps={text:"",point:{x:0,y:0}},o.default=w},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=function(){function i(e,u){for(var a=0;a<u.length;a++){var t=u[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,u,a){return u&&i(e.prototype,u),a&&i(e,a),e}}(),c=r(0),f=y(c),h=r(1),m=y(h);function y(i){return i&&i.__esModule?i:{default:i}}function j(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i}function P(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)}var w=function(i){P(e,i);function e(){return j(this,e),_(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,[{key:"render",value:function(){var a=this.props,t=a.data,d=a.points;a.width;var v=a.height,S=a.margin,k=a.color,E=a.style,q=a.onMouseMove,C=d.map(function(T){return[T.x,T.y]}).reduce(function(T,U){return T.concat(U)}),Q=[d[d.length-1].x,v-S,S,v-S,S,d[0].y],J=C.concat(Q),K={stroke:k||E.stroke||"slategray",strokeWidth:E.strokeWidth||"1",strokeLinejoin:E.strokeLinejoin||"round",strokeLinecap:E.strokeLinecap||"round",fill:"none"},G={stroke:E.stroke||"none",strokeWidth:"0",fillOpacity:E.fillOpacity||".1",fill:E.fill||k||"slategray",pointerEvents:"auto"},I=d.map(function(T,U){return m.default.createElement("circle",{key:U,cx:T.x,cy:T.y,r:2,style:G,onMouseEnter:function(Y){return q("enter",t[U],T)},onClick:function(Y){return q("click",t[U],T)}})});return m.default.createElement("g",null,I,m.default.createElement("polyline",{points:J.join(" "),style:G}),m.default.createElement("polyline",{points:C.join(" "),style:K}))}}]),e}(m.default.Component);w.propTypes={color:f.default.string,style:f.default.object},w.defaultProps={style:{},onMouseMove:function(){}},o.default=w},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=function(){function i(e,u){for(var a=0;a<u.length;a++){var t=u[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,u,a){return u&&i(e.prototype,u),a&&i(e,a),e}}(),c=r(0),f=y(c),h=r(1),m=y(h);function y(i){return i&&i.__esModule?i:{default:i}}function j(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i}function P(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)}var w=function(i){P(e,i);function e(){return j(this,e),_(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,[{key:"render",value:function(){var a=this.props,t=a.points;a.width;var d=a.height,v=a.margin,S=a.color,k=a.style,E=a.divisor,q=E===void 0?.25:E,C=void 0,Q=function(D){var Y=void 0;if(!C)Y=[D.x,D.y];else{var ae=(D.x-C.x)*q;Y=["C",C.x+ae,C.y,D.x-ae,D.y,D.x,D.y]}return C=D,Y},J=t.map(function(U){return Q(U)}).reduce(function(U,D){return U.concat(D)}),K=["L"+t[t.length-1].x,d-v,v,d-v,v,t[0].y],G=J.concat(K),I={stroke:S||k.stroke||"slategray",strokeWidth:k.strokeWidth||"1",strokeLinejoin:k.strokeLinejoin||"round",strokeLinecap:k.strokeLinecap||"round",fill:"none"},T={stroke:k.stroke||"none",strokeWidth:"0",fillOpacity:k.fillOpacity||".1",fill:k.fill||S||"slategray"};return m.default.createElement("g",null,m.default.createElement("path",{d:"M"+G.join(" "),style:T}),m.default.createElement("path",{d:"M"+J.join(" "),style:I}))}}]),e}(m.default.Component);w.propTypes={color:f.default.string,style:f.default.object},w.defaultProps={style:{}},o.default=w},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=function(){function i(e,u){for(var a=0;a<u.length;a++){var t=u[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,u,a){return u&&i(e.prototype,u),a&&i(e,a),e}}(),c=r(0),f=y(c),h=r(1),m=y(h);function y(i){return i&&i.__esModule?i:{default:i}}function j(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i}function P(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)}var w=function(i){P(e,i);function e(){return j(this,e),_(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,[{key:"render",value:function(){var a=this,t=this.props,d=t.points,v=t.height,S=t.style,k=t.barWidth,E=t.margin,q=t.onMouseMove,C=1*(S&&S.strokeWidth||0),Q=E?2*E:0,J=k||(d&&d.length>=2?Math.max(0,d[1].x-d[0].x-C-Q):0);return m.default.createElement("g",{transform:"scale(1,-1)"},d.map(function(K,G){return m.default.createElement("rect",{key:G,x:K.x-(J+C)/2,y:-v,width:J,height:Math.max(0,v-K.y),style:S,onMouseMove:q&&q.bind(a,K)})}))}}]),e}(m.default.Component);w.propTypes={points:f.default.arrayOf(f.default.object),height:f.default.number,style:f.default.object,barWidth:f.default.number,margin:f.default.number,onMouseMove:f.default.func},w.defaultProps={style:{fill:"slategray"}},o.default=w},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=function(){function i(e,u){for(var a=0;a<u.length;a++){var t=u[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,u,a){return u&&i(e.prototype,u),a&&i(e,a),e}}(),c=r(0),f=y(c),h=r(1),m=y(h);function y(i){return i&&i.__esModule?i:{default:i}}function j(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function _(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i}function P(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)}var w=function(i){P(e,i);function e(){return j(this,e),_(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,[{key:"lastDirection",value:function(a){return Math.sign=Math.sign||function(t){return t>0?1:-1},a.length<2?0:Math.sign(a[a.length-2].y-a[a.length-1].y)}},{key:"render",value:function(){var a=this.props,t=a.points;a.width,a.height;var d=a.size,v=a.style,S=a.spotColors,k=m.default.createElement("circle",{cx:t[0].x,cy:t[0].y,r:d,style:v}),E=m.default.createElement("circle",{cx:t[t.length-1].x,cy:t[t.length-1].y,r:d,style:v||{fill:S[this.lastDirection(t)]}});return m.default.createElement("g",null,v&&k,E)}}]),e}(m.default.Component);w.propTypes={size:f.default.number,style:f.default.object,spotColors:f.default.object},w.defaultProps={size:2,spotColors:{"-1":"red",0:"black",1:"green"}},o.default=w},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=function(){function a(t,d){for(var v=0;v<d.length;v++){var S=d[v];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(t,S.key,S)}}return function(t,d,v){return d&&a(t.prototype,d),v&&a(t,v),t}}(),c=r(0),f=P(c),h=r(1),m=P(h),y=r(23),j=_(y);function _(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(t[d]=a[d]);return t.default=a,t}function P(a){return a&&a.__esModule?a:{default:a}}function w(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function i(a,t){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:a}function e(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(a,t):a.__proto__=t)}var u=function(a){e(t,a);function t(){return w(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,[{key:"render",value:function(){var v=this.props,S=v.points,k=v.margin,E=v.type,q=v.style,C=v.value,Q=S.map(function(K){return K.y}),J=E=="custom"?C:j[E](Q);return m.default.createElement("line",{x1:S[0].x,y1:J+k,x2:S[S.length-1].x,y2:J+k,style:q})}}]),t}(m.default.Component);u.propTypes={type:f.default.oneOf(["max","min","mean","avg","median","custom"]),value:f.default.number,style:f.default.object},u.defaultProps={type:"mean",style:{stroke:"red",strokeOpacity:.75,strokeDasharray:"2, 2"}},o.default=u},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.variance=o.stdev=o.median=o.midRange=o.avg=o.mean=o.max=o.min=void 0;var s=r(7),c=u(s),f=r(3),h=u(f),m=r(24),y=u(m),j=r(25),_=u(j),P=r(10),w=u(P),i=r(26),e=u(i);function u(a){return a&&a.__esModule?a:{default:a}}o.min=c.default,o.max=c.default,o.mean=h.default,o.avg=h.default,o.midRange=y.default,o.median=_.default,o.stdev=w.default,o.variance=e.default},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=r(7),c=m(s),f=r(9),h=m(f);function m(y){return y&&y.__esModule?y:{default:y}}o.default=function(y){return(0,h.default)(y)-(0,c.default)(y)/2}},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(s){return s.sort(function(c,f){return c-f})[Math.floor(s.length/2)]}},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=r(3),c=f(s);function f(h){return h&&h.__esModule?h:{default:h}}o.default=function(h){var m=(0,c.default)(h),y=h.map(function(j){return Math.pow(j-m,2)});return(0,c.default)(y)}},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=function(){function t(d,v){for(var S=0;S<v.length;S++){var k=v[S];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(d,k.key,k)}}return function(d,v,S){return v&&t(d.prototype,v),S&&t(d,S),d}}(),c=r(0),f=w(c),h=r(1),m=w(h),y=r(3),j=w(y),_=r(10),P=w(_);function w(t){return t&&t.__esModule?t:{default:t}}function i(t,d){if(!(t instanceof d))throw new TypeError("Cannot call a class as a function")}function e(t,d){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:t}function u(t,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);t.prototype=Object.create(d&&d.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(t,d):t.__proto__=d)}var a=function(t){u(d,t);function d(){return i(this,d),e(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return s(d,[{key:"render",value:function(){var S=this.props,k=S.points,E=S.margin,q=S.style,C=k.map(function(K){return K.y}),Q=(0,j.default)(C),J=(0,P.default)(C);return m.default.createElement("rect",{x:k[0].x,y:Q-J+E,width:k[k.length-1].x-k[0].x,height:P.default*2,style:q})}}]),d}(m.default.Component);a.propTypes={style:f.default.object},a.defaultProps={style:{fill:"red",fillOpacity:.1}},o.default=a},function(g,o,r){Object.defineProperty(o,"__esModule",{value:!0});var s=r(7),c=m(s),f=r(9),h=m(f);function m(y){return y&&y.__esModule?y:{default:y}}o.default=function(y){var j=y.data,_=y.limit,P=y.width,w=P===void 0?1:P,i=y.height,e=i===void 0?1:i,u=y.margin,a=u===void 0?0:u,t=y.max,d=t===void 0?(0,h.default)(j):t,v=y.min,S=v===void 0?(0,c.default)(j):v,k=j.length;_&&_<k&&(j=j.slice(k-_));var E=(e-a*2)/(d-S||2),q=(w-a*2)/((_||k)-(k>1?1:0));return j.map(function(C,Q){return{x:Q*q+a,y:(d===S?1:d-C)*E+a}})}}])})})(qe);var ye=qe.exports;const Be=typeof TextDecoder<"u"?new TextDecoder("utf-8"):null;async function Wt(M){if(typeof M=="string")return M;if(typeof window<"u"&&M instanceof File)return await M.text();if(M&&M.byteLength!=null)return Be?Be.decode(M):String.fromCharCode.apply(null,new Uint8Array(M));throw new Error("Entrada inválida para leitura de texto OFX")}function $t(M){if(!M)return null;const O=String(M).match(/(\d{4})(\d{2})(\d{2})/);if(!O)return null;const[te,g,o,r]=O,s=Number(g),c=Number(o)-1,f=Number(r);return new Date(s,c,f).toISOString().split("T")[0]}function Ut(M){if(M==null)return 0;const O=Number(String(M).replace(",","."));return isNaN(O)?0:O}function re(M,O){const te=new RegExp(`<${O}>([^\r
<]*)`,"i"),g=M.match(te);if(g)return g[1].trim();const o=new RegExp(`<${O}>([sS]*?)</${O}>`,"i"),r=M.match(o);return r?r[1].trim():""}function Ht(M){const O=/<STMTTRN>([\s\S]*?)<\/STMTTRN>/gi,te=[];let g;for(;(g=O.exec(M))!==null;)te.push(g[1]);if(te.length)return te;const o=/<STMTTRN>[\s\S]*?(?=<STMTTRN>|<\/BANKTRANLIST>|<\/STMTRS>|$)/gi;return(M.match(o)||[]).map(s=>s.replace(/^<STMTTRN>/i,""))}function Xt(M){return/<OFX[>\s]/i.test(M)||/<OFX>/i.test(M)}function Yt(M){var o;if(!M||!Xt(M))throw new Error("Arquivo OFX inválido ou não reconhecido");M.toLowerCase();const O=((o=/\<banktranlist\>([\s\S]*?)\<\/banktranlist\>/i.exec(M))==null?void 0:o[1])||M;return Ht(O).map(r=>{const s=re(r,"TRNTYPE")||re(r,"trntype"),c=re(r,"DTPOSTED")||re(r,"dtposted")||re(r,"DTUSER"),f=re(r,"TRNAMT")||re(r,"trnamt"),h=re(r,"MEMO")||re(r,"memo")||re(r,"NAME"),m=re(r,"FITID")||re(r,"fitid"),y=$t(c),j=Ut(f),_=(h||"").trim(),P=(s||"").toUpperCase();return{data:y,valor:j,descricao:_,tipo:P,identificador:m}}).filter(r=>r.data&&(r.valor||r.valor===0))}async function qt(M){const O=await Wt(M);return Yt(O)}const Oe=10,Gt="expensesPage";function pn(){var De;const{expenses:M,categories:O,addExpense:te,updateExpense:g,deleteExpense:o,toggleExpensePayment:r}=ze(),{toast:s}=pt(),[c,f]=X.useState(!1),[h,m]=X.useState(null),[y,j]=X.useState(1),[_,P]=X.useState(""),[w,i]=X.useState("all"),[e,u]=X.useState("all"),[a,t]=X.useState("date-desc"),[d,v]=X.useState(!1),[S,k]=X.useState(!1),[E,q]=X.useState([]),[C,Q]=X.useState({}),[J,K]=X.useState({}),G=X.useMemo(()=>O.filter(p=>p.tipo==="gasto"),[O]),I=((De=G[0])==null?void 0:De.id)||"",[T,U]=X.useState(I),[D,Y]=X.useState(!1),ae="ofx-file-input",[l,x]=yt(`filter_${Gt}`,()=>({periodType:"monthly",dateRange:void 0,month:new Date().getMonth(),year:new Date().getFullYear()})),B=p=>{x({...l,dateRange:p})},z=p=>{x({dateRange:void 0,periodType:"monthly",month:p,year:l.year||new Date().getFullYear()})},L=p=>{x(b=>({...b,dateRange:void 0,year:p}))},W=p=>{x(b=>({...b,periodType:p,dateRange:void 0}))};X.useEffect(()=>{!T&&I&&U(I)},[I,T]);const A=()=>{const p=document.getElementById(ae);p&&p.click()},F=async p=>{const b=p.target.files&&p.target.files[0];if(b)try{const ee=(await qt(b)).filter(ne=>ne.valor<0||String(ne.tipo).toUpperCase()==="DEBIT").map(ne=>({...ne,valor:Math.abs(ne.valor)}));if(ee.length===0){s({title:"Nenhuma despesa encontrada no OFX",description:"Verifique se o arquivo contém lançamentos de saída.",variant:"destructive"}),p.target.value="";return}q(ee),Q({}),K(ee.reduce((ne,me,ge)=>(ne[ge]=me.descricao||"Lançamento OFX",ne),{})),v(!0)}catch(R){s({title:"Falha ao ler OFX",description:(R==null?void 0:R.message)||"Formato inválido.",variant:"destructive"})}finally{p.target.value=""}},H=async()=>{if(!(E.some((b,R)=>C[R])||!!T)){s({title:"Selecione uma categoria",description:"Defina ao menos a categoria padrão ou por item.",variant:"destructive"});return}k(!0);try{let b=0;for(let R=0;R<E.length;R++){const ee=E[R],ne=C[R]||T;if(!ne)continue;const me={descricao:J[R]??ee.descricao??"Lançamento OFX",valor:Number(ee.valor)||0,categoria_id:ne,pago:D,recorrente:!1,data:ee.data||new Date().toISOString().split("T")[0]};try{await te(me),b++}catch{}}s({title:"Importação concluída",description:`${b} despesas adicionadas`}),v(!1),q([]),Q({}),K({})}catch(b){s({title:"Erro na importação",description:(b==null?void 0:b.message)||"Tente novamente.",variant:"destructive"})}finally{k(!1)}},{filteredExpenses:N,totalSpent:Z,trendData:ie,paidExpenses:ve,pendingExpenses:be,totalPaid:Ge,totalPending:Qe}=X.useMemo(()=>{let p=[],b,R;l.dateRange&&l.dateRange.from?(b=l.dateRange.from,R=l.dateRange.to||l.dateRange.from):l.periodType==="yearly"&&l.year?(b=St(new Date(l.year,0,1)),R=Tt(new Date(l.year,11,31))):l.periodType==="monthly"&&l.month!==void 0&&l.year&&(b=Le(new Date(l.year,l.month,1)),R=Ae(new Date(l.year,l.month,1))),b&&R&&(R.setHours(23,59,59,999),p=M.filter($=>{const V=Fe($.data);return V>=b&&V<=R})),_&&(p=p.filter($=>$.descricao.toLowerCase().includes(_.toLowerCase()))),w!=="all"&&(p=p.filter($=>$.categoria_id===w)),e!=="all"&&(p=p.filter($=>e==="paid"?$.pago===!0:e==="pending"?$.pago===!1:!0)),p.sort(($,V)=>{switch(a){case"date-asc":return new Date($.data)-new Date(V.data);case"date-desc":return new Date(V.data)-new Date($.data);case"value-asc":return $.valor-V.valor;case"value-desc":return V.valor-$.valor;case"description":return $.descricao.localeCompare(V.descricao);default:return new Date(V.data)-new Date($.data)}});const ee=[];for(let $=6;$>=0;$--){const V=l.periodType==="monthly"?new Date(l.year,l.month-$,1):It(new Date,$),ct=Le(V),ut=Ae(V),ft=p.filter(Se=>{const je=Fe(Se.data);return je>=ct&&je<=ut});ee.push(ft.reduce((Se,je)=>Se+je.valor,0))}const ne=p.reduce(($,V)=>$+V.valor,0),me=p.filter($=>$.pago===!0),ge=p.filter($=>$.pago===!1),st=me.reduce(($,V)=>$+V.valor,0),lt=ge.reduce(($,V)=>$+V.valor,0);return{filteredExpenses:p,totalSpent:ne,trendData:ee,paidExpenses:me,pendingExpenses:ge,totalPaid:st,totalPending:lt}},[M,l,_,w,e,a]);X.useMemo(()=>{if(N.length===0)return[];const p=G.reduce((b,R)=>(b[R.id]={categoryName:R.nome,total:0},b),{});return N.forEach(b=>{p[b.categoria_id]&&(p[b.categoria_id].total+=b.valor)}),Object.values(p).filter(b=>b.total>0).sort((b,R)=>R.total-b.total)},[N,G]);const we=Math.ceil(N.length/Oe),Je=N.slice((y-1)*Oe,y*Oe),[fe,xe]=X.useState([]),de=fe.length,Ke=(p,b)=>{xe(R=>b?Array.from(new Set([...R,p])):R.filter(ee=>ee!==p))},Ze=(p,b)=>{xe(b?Array.from(new Set([...fe,...p])):fe.filter(R=>!p.includes(R)))},Ve=async()=>{if(de!==0)try{for(const p of fe)await r(p);s({title:"Atualização concluída",description:`${de} lançamento(s) atualizados`}),xe([])}catch(p){s({title:"Erro ao atualizar em lote",description:p.message,variant:"destructive"})}},et=async()=>{if(de!==0)try{for(const p of fe)await o(p);s({title:"Exclusão concluída",description:`${de} lançamento(s) excluídos`}),xe([])}catch(p){s({title:"Erro ao excluir em lote",description:p.message,variant:"destructive"})}},tt=async(p,b)=>{try{b?(await g(b,p),s({title:"Despesa atualizada com sucesso!"})):(await te(p),s({title:"Despesa adicionada com sucesso!"})),f(!1),m(null)}catch(R){s({title:"Erro ao salvar despesa",description:R.message,variant:"destructive"})}},nt=p=>{m({...p,categories:G}),f(!0)},rt=async p=>{try{await o(p),s({title:"Despesa excluída com sucesso!"})}catch(b){s({title:"Erro ao excluir despesa",description:b.message,variant:"destructive"})}},at=async p=>{try{await r(p),s({title:"Status de pagamento atualizado!"})}catch(b){s({title:"Erro ao atualizar status",description:b.message,variant:"destructive"})}},it=p=>{p>0&&p<=we&&j(p)},ot=p=>{p||m(null),f(p)},pe=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"});return n.jsxs(n.Fragment,{children:[n.jsxs(mt,{children:[n.jsx("title",{children:"Controle de Despesas - Lumify"}),n.jsx("meta",{name:"description",content:"Adicione e gerencie suas despesas."})]}),n.jsxs("div",{className:"space-y-3 md:space-y-4 page-top",children:[n.jsx(Ot,{title:"Controle de Despesas",subtitle:"Gerencie suas despesas e acompanhe seus gastos",actionButton:n.jsx(zt,{onSubmit:tt,expenseToEdit:h,isOpen:c,onOpenChange:ot})}),n.jsxs(Et,{defaultValue:"relatorio",className:"w-full",children:[n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[n.jsxs(Ct,{className:"grid w-full md:w-auto grid-cols-2",children:[n.jsxs(Ce,{value:"relatorio",className:"flex items-center gap-2",children:[n.jsx(vt,{className:"h-4 w-4"})," Relatório"]}),n.jsxs(Ce,{value:"dashboard",className:"flex items-center gap-2",children:[n.jsx(Te,{className:"h-4 w-4"})," Dashboard"]})]}),n.jsxs("div",{className:"w-full md:w-auto flex items-center gap-2",children:[n.jsx("input",{id:ae,type:"file",accept:".ofx,.qfx,.ofc,.xml,.txt",className:"hidden",onChange:F}),n.jsxs(ue,{variant:"outline",onClick:A,className:"flex items-center gap-2",children:[n.jsx(Bt,{className:"h-4 w-4"})," Importar OFX"]}),n.jsx(_t,{periodType:l.periodType,setPeriodType:W,dateRange:l.dateRange,setDateRange:B,month:l.month,setMonth:z,year:l.year,setYear:L})]})]}),n.jsx(Ie,{value:"relatorio",className:"mt-4 md:mt-5 space-y-4 md:space-y-5",children:n.jsxs(oe,{children:[n.jsxs(se,{children:[n.jsx(le,{children:"Suas Despesas"}),n.jsx(ht,{children:"Lista de todas as despesas no período selecionado."})]}),n.jsxs(ce,{children:[de>0&&n.jsxs("div",{className:"mb-2 flex items-center gap-2 text-sm",children:[n.jsxs("div",{className:"text-muted-foreground",children:["Selecionados: ",de]}),n.jsxs(ue,{variant:"outline",size:"sm",onClick:Ve,className:"flex items-center gap-2",children:[n.jsx(At,{className:"h-4 w-4"})," Marcar como pago"]}),n.jsxs(ue,{variant:"destructive",size:"sm",onClick:et,className:"flex items-center gap-2",children:[n.jsx(Lt,{className:"h-4 w-4"})," Excluir"]})]}),n.jsx(gt,{transactions:Je,categories:G,type:"expense",onEdit:nt,onDelete:rt,onTogglePayment:at,selectable:!0,selectedIds:fe,onSelectOne:Ke,onSelectAll:Ze,searchTerm:_,onSearchChange:P,selectedCategory:w,onCategoryChange:i,paymentStatus:e,onPaymentStatusChange:u,sortBy:a,onSortChange:t}),we>1&&n.jsx(xt,{currentPage:y,totalPages:we,onPageChange:it})]})]})}),n.jsxs(Ie,{value:"dashboard",className:"mt-4 md:mt-5 space-y-4 md:space-y-5",children:[n.jsxs("div",{className:"grid gap-3 md:gap-4 md:grid-cols-2 lg:grid-cols-4",children:[n.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[n.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(le,{className:"text-sm font-medium",children:"Despesas Pagas"}),n.jsx(jt,{className:"h-4 w-4 text-green-600"})]}),n.jsxs(ce,{children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:pe.format(Ge)}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[ve.length," despesa",ve.length!==1?"s":""," quitada",ve.length!==1?"s":""]})]})]}),n.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[n.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(le,{className:"text-sm font-medium",children:"Despesas Pendentes"}),n.jsx(bt,{className:"h-4 w-4 text-orange-600"})]}),n.jsxs(ce,{children:[n.jsx("div",{className:"text-2xl font-bold text-orange-600",children:pe.format(Qe)}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[be.length," despesa",be.length!==1?"s":""," pendente",be.length!==1?"s":""]})]})]}),n.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[n.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(le,{className:"text-sm font-medium",children:"Gasto Total"}),n.jsx($e,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ce,{children:[n.jsx("div",{className:"text-2xl font-bold text-red-600",children:pe.format(Z)}),n.jsx(ye.Sparklines,{data:ie,children:n.jsx(ye.SparklinesLine,{color:"#f87171"})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Total de despesas no período selecionado."})]})]}),n.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[n.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(le,{className:"text-sm font-medium",children:"Número de Despesas"}),n.jsx(We,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ce,{children:[n.jsx("div",{className:"text-2xl font-bold",children:N.length}),n.jsx(ye.Sparklines,{data:ie.map((p,b)=>N.length>0?N.length/ie.length:0),children:n.jsx(ye.SparklinesLine,{color:"#3b82f6"})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Quantidade de despesas registradas."})]})]}),n.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[n.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(le,{className:"text-sm font-medium",children:"Despesa Média"}),n.jsx(Te,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ce,{children:[n.jsx("div",{className:"text-2xl font-bold",children:N.length>0?pe.format(Z/N.length):"R$ 0,00"}),n.jsx(ye.Sparklines,{data:ie.map(p=>p/(N.length||1)),children:n.jsx(ye.SparklinesLine,{color:"#fbbf24"})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Valor médio por despesa."})]})]}),n.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[n.jsxs(se,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(le,{className:"text-sm font-medium",children:"Taxa de Quitação"}),n.jsx(Te,{className:"h-4 w-4 text-muted-foreground"})]}),n.jsxs(ce,{children:[n.jsx("div",{className:"text-2xl font-bold",children:N.length>0?`${Math.round(ve.length/N.length*100)}%`:"0%"}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:n.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:N.length>0?`${ve.length/N.length*100}%`:"0%"}})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Percentual de despesas quitadas."})]})]})]}),n.jsx(Mt,{}),n.jsx(Dt,{expenses:N,categories:O})]})]}),n.jsx(Ue,{open:d,onOpenChange:v,children:n.jsxs(He,{className:"sm:max-w-4xl",children:[n.jsx(Xe,{children:n.jsx(Ye,{children:"Importar despesas do OFX"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[n.jsxs("div",{className:"text-sm text-muted-foreground",children:[E.length," lançamento",E.length!==1?"s":""," de despesa encontrados."]}),n.jsxs("div",{className:"text-sm font-medium",children:["Total a importar: ",pe.format(E.reduce((p,b)=>p+(Number(b.valor)||0),0))]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium",children:"Categoria para as despesas"}),n.jsxs(_e,{value:T,onValueChange:U,children:[n.jsx(ke,{className:"w-full mt-1",children:n.jsx(Pe,{placeholder:"Selecione uma categoria"})}),n.jsx(Ne,{children:G.map(p=>n.jsx(Re,{value:String(p.id),children:p.nome},p.id))})]})]}),n.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[n.jsx("input",{id:"importPaid",type:"checkbox",className:"rounded accent-primary",checked:D,onChange:p=>Y(p.target.checked)}),n.jsx("label",{htmlFor:"importPaid",className:"text-sm",children:"Marcar como pago"})]})]}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Revise as descrições e categorias. Valores negativos são importados como despesas."}),n.jsxs("div",{className:"max-h-[60vh] overflow-auto border rounded-md",children:[n.jsxs("div",{className:"grid grid-cols-12 gap-2 p-2 text-xs text-muted-foreground border-b",children:[n.jsx("div",{className:"col-span-5",children:"Descrição"}),n.jsx("div",{className:"col-span-2",children:"Data"}),n.jsx("div",{className:"col-span-2 text-right",children:"Valor"}),n.jsx("div",{className:"col-span-3",children:"Categoria"})]}),E.map((p,b)=>n.jsxs("div",{className:"grid grid-cols-12 gap-2 p-2 items-center border-b last:border-b-0",children:[n.jsx("div",{className:"col-span-5",children:n.jsx("input",{className:"w-full px-2 py-1 border rounded text-sm",value:J[b]??p.descricao??"Lançamento OFX",onChange:R=>K(ee=>({...ee,[b]:R.target.value}))})}),n.jsx("div",{className:"col-span-2 text-xs",children:p.data}),n.jsx("div",{className:"col-span-2 text-right font-medium",children:pe.format(Number(p.valor)||0)}),n.jsx("div",{className:"col-span-3",children:n.jsxs(_e,{value:C[b]||T||"",onValueChange:R=>Q(ee=>({...ee,[b]:R})),children:[n.jsx(ke,{className:"w-full",children:n.jsx(Pe,{placeholder:"Categoria"})}),n.jsx(Ne,{children:G.map(R=>n.jsx(Re,{value:String(R.id),children:R.nome},R.id))})]})})]},b))]})]}),n.jsxs(Rt,{children:[n.jsx(ue,{variant:"ghost",onClick:()=>v(!1),disabled:S,children:"Cancelar"}),n.jsx(ue,{onClick:H,disabled:S||!T,children:S?"Importando...":"Confirmar importação"})]})]})})]})]})}export{pn as ExpensesPage};
