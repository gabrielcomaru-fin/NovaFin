import{e as z,g as R,r as M}from"./index-e054d3da.js";const G=z("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),T=()=>{const{expenses:h,investments:v,accounts:f,totalPatrimony:A,totalAccountBalance:g,totalInvestmentBalance:H}=R(),x=t=>t.filter(e=>e.is_reserva_emergencia===!0).reduce((e,s)=>e+(s.valor_aporte||0),0),S=t=>{if(t.investments.length<2)return 0;const e=[...t.investments].sort((i,u)=>new Date(i.data)-new Date(u.data)),s=e[0],c=e[e.length-1],n=(new Date(c.data)-new Date(s.data))/(1e3*60*60*24*30);return n<=0?0:t.investments.reduce((i,u)=>i+u.valor_aporte,0)/n},d=t=>{if(t.length===0)return 0;const e=new Set(t.map(c=>c.categoria_id)).size,s=t.length;return Math.min(e/s*100,100)},w=t=>{const e=t.expenses.reduce((n,o)=>n+o.valor,0),s=t.investments.reduce((n,o)=>n+o.valor_aporte,0);if(e===0)return 100;const c=s/(e+s)*100;return Math.min(c,100)},_=t=>{if(t.investments.length<3)return 0;const e={};t.investments.forEach(n=>{const o=new Date(n.data).toISOString().slice(0,7);e[o]=(e[o]||0)+n.valor_aporte});const s=Object.keys(e).length;return Object.values(e).filter(n=>n>0).length/s*100},D=t=>{if(t.length===0)return 0;const e=t.reduce((n,o)=>n+o.valor,0),s=new Set(t.map(n=>new Date(n.data).toISOString().slice(0,7))),c=Math.max(s.size,1);return e/c},E=(t,e,s)=>{const c=t.expenses.reduce((r,m)=>r+m.valor,0),n=t.investments.reduce((r,m)=>r+m.valor_aporte,0);let o=0;const l=c+n>0?n/(c+n)*100:0;o+=Math.min(l*.4,40);const i=e>0&&s>0?e/s:0;o+=Math.min(i*10,30);const u=d(t.investments);o+=u*.2;const a=_(t);return o+=a*.1,Math.min(Math.round(o),100)},p=(t,e)=>{const s=t.expenses.reduce((a,r)=>a+r.valor,0),c=t.investments.reduce((a,r)=>a+r.valor_aporte,0),n=D(t.expenses),l=new Set(t.expenses.map(a=>new Date(a.data).toISOString().slice(0,7))).size,i=x(t.investments);return{liquidityRatio:i>0&&n>0?i/n:0,emergencyFundTotal:i,emergencyFundFromAccounts:e,emergencyFundFromInvestments:i,totalExpenses:s,averageMonthlyExpenses:n,monthsOfData:l,savingsRate:s+c>0?c/(s+c)*100:0,wealthGrowthRate:S(t),investmentDiversification:d(t.investments),budgetEfficiency:w(t),financialHealthScore:E(t,i,n)}},y=t=>{const e=t.length,s=Array.from({length:e},(a,r)=>r),c=t,n=s.reduce((a,r)=>a+r,0),o=c.reduce((a,r)=>a+r,0),l=s.reduce((a,r,m)=>a+r*c[m],0),i=s.reduce((a,r)=>a+r*r,0),u=e*i-n*n;return u===0?0:(e*l-n*o)/u},F=t=>{if(t.length<3)return"insufficient_data";const e={};t.forEach(o=>{const l=new Date(o.data).toISOString().slice(0,7);e[l]=(e[l]||0)+o.valor});const s=Object.keys(e).sort();if(s.length<3)return"insufficient_data";const c=s.map(o=>e[o]),n=y(c);return n>.1?"increasing":n<-.1?"decreasing":"stable"},O=t=>{if(t.length<3)return"insufficient_data";const e={};t.forEach(o=>{const l=new Date(o.data).toISOString().slice(0,7);e[l]=(e[l]||0)+o.valor_aporte});const s=Object.keys(e).sort();if(s.length<3)return"insufficient_data";const c=s.map(o=>e[o]),n=y(c);return n>.1?"increasing":n<-.1?"decreasing":"stable"},I=t=>{const e={spending:F(t.expenses),investment:O(t.investments),overall:"stable"};return e.spending==="increasing"&&e.investment==="decreasing"?e.overall="concerning":e.spending==="decreasing"&&e.investment==="increasing"?e.overall="positive":e.spending==="increasing"&&e.investment==="increasing"&&(e.overall="mixed"),e},b=M.useMemo(()=>p({expenses:h,investments:v,accounts:f},g),[h,v,f,g]),k=M.useMemo(()=>I({expenses:h,investments:v}),[h,v]);return{financialHealth:b,trends:k,calculateFinancialHealth:t=>p(t,g),analyzeTrends:I}};export{G as I,T as u};
