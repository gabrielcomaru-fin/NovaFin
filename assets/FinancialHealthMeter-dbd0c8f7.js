import{e as R,r as d,g as E,i as D,j as e,C as O,d as A,m as p,K as G,M as V,N as z,O as W,B as _,a8 as U,o as K}from"./index-3b3513e8.js";import{P as j}from"./badge-10305eb2.js";import{u as Z,I as J}from"./useAdvancedMetrics-b77f76d4.js";import{T as Q}from"./trending-down-48cab13a.js";import{C as X,a as Y}from"./extends-9b64b82e.js";const H=R("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),ee=R("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),oe=d.memo(function({showBreakdownOption:C=!1}){const{financialHealth:t,trends:n}=Z(),{expenses:f,investments:g}=E(),[h,F]=d.useState(!1),s=d.useMemo(()=>{const a=f.reduce((r,u)=>r+u.valor,0),o=g.reduce((r,u)=>r+u.valor_aporte,0),c=new Set(f.map(r=>new Date(r.data).toISOString().slice(0,7))),m=Math.max(c.size,1),x=a/m,l=(t==null?void 0:t.savingsRate)||0,T=Math.min(l*.4,40),N=(t==null?void 0:t.liquidityRatio)||0,B=Math.min(N*10,30),M=(t==null?void 0:t.investmentDiversification)||0,$=M*.2,y={};g.forEach(r=>{const u=new Date(r.data).toISOString().slice(0,7);y[u]=(y[u]||0)+r.valor_aporte});const b=Object.keys(y).length,w=Object.values(y).filter(r=>r>0).length,P=b>0?w/b*100:0,q=P*.1,L=new Set(g.map(r=>r.categoria_id)).size;return{totalExpenses:a,totalInvestments:o,averageMonthlyExpenses:x,expenseMonthCount:m,savingsRate:l,liquidityRatio:N,diversification:M,consistencyRate:P,categoryCount:L,totalInvestmentsCount:g.length,totalMonths:b,monthsWithInvestments:w,emergencyFundTotal:(t==null?void 0:t.emergencyFundTotal)||0,emergencyFundFromAccounts:(t==null?void 0:t.emergencyFundFromAccounts)||0,emergencyFundFromInvestments:(t==null?void 0:t.emergencyFundFromInvestments)||0,savingsPoints:Math.round(T*10)/10,liquidityPoints:Math.round(B*10)/10,diversificationPoints:Math.round($*10)/10,consistencyPoints:Math.round(q*10)/10,savingsMax:40,liquidityMax:30,diversificationMax:20,consistencyMax:10}},[f,g,t]),i=d.useMemo(()=>{const a=(t==null?void 0:t.financialHealthScore)||0;return a>=80?{label:"Excelente",description:"ParabÃ©ns! Sua saÃºde financeira estÃ¡ Ã³tima.",color:"text-emerald-500",bgColor:"bg-emerald-500",bgGradient:"from-emerald-500 to-emerald-400",emoji:"ðŸŒŸ"}:a>=60?{label:"SaudÃ¡vel",description:"VocÃª estÃ¡ no caminho certo!",color:"text-green-500",bgColor:"bg-green-500",bgGradient:"from-green-500 to-green-400",emoji:"ðŸ’ª"}:a>=40?{label:"Equilibrado",description:"HÃ¡ espaÃ§o para melhorar, mas estÃ¡ bem.",color:"text-yellow-500",bgColor:"bg-yellow-500",bgGradient:"from-yellow-500 to-yellow-400",emoji:"âš–ï¸"}:a>=20?{label:"AtenÃ§Ã£o",description:"Alguns ajustes podem fazer diferenÃ§a.",color:"text-orange-500",bgColor:"bg-orange-500",bgGradient:"from-orange-500 to-orange-400",emoji:"âš ï¸"}:{label:"Precisa de Cuidado",description:"Vamos trabalhar juntos para melhorar!",color:"text-red-500",bgColor:"bg-red-500",bgGradient:"from-red-500 to-red-400",emoji:"ðŸ†˜"}},[t==null?void 0:t.financialHealthScore]),S=d.useMemo(()=>{const a=[],o=(t==null?void 0:t.savingsRate)||0;a.push({name:"Taxa de PoupanÃ§a",value:`${Math.round(o)}%`,status:o>=20?"good":o>=10?"medium":"bad",tip:o>=20?"Excelente! VocÃª estÃ¡ poupando bem.":"Tente poupar pelo menos 20% da sua renda."});const c=(t==null?void 0:t.liquidityRatio)||0,m=(t==null?void 0:t.emergencyFundFromInvestments)||0;let x="";m===0?x="Marque seus investimentos de reserva de emergÃªncia para calcular a cobertura.":c>=6?x=`Ã“timo! Sua reserva de R$ ${m.toLocaleString("pt-BR",{minimumFractionDigits:0})} cobre ${c.toFixed(1)} meses de gastos.`:x=`Sua reserva de R$ ${m.toLocaleString("pt-BR",{minimumFractionDigits:0})} cobre ${c.toFixed(1)} meses. O ideal Ã© ter 6 meses de gastos em reserva.`,a.push({name:"Reserva de EmergÃªncia",value:`${c.toFixed(1)} meses`,status:c>=6?"good":c>=3?"medium":"bad",tip:x});const l=(t==null?void 0:t.investmentDiversification)||0;return a.push({name:"DiversificaÃ§Ã£o",value:`${Math.round(l)}%`,status:l>=60?"good":l>=30?"medium":"bad",tip:l>=60?"Boa diversificaÃ§Ã£o nos investimentos!":"Considere diversificar mais seus investimentos."}),a},[t]),I=d.useMemo(()=>(n==null?void 0:n.overall)==="positive"?D:(n==null?void 0:n.overall)==="concerning"?Q:ee,[n==null?void 0:n.overall]),k=d.useMemo(()=>(n==null?void 0:n.overall)==="positive"?"text-green-500":(n==null?void 0:n.overall)==="concerning"?"text-red-500":"text-muted-foreground",[n==null?void 0:n.overall]),v=(t==null?void 0:t.financialHealthScore)||0;return e.jsx(O,{className:"overflow-hidden border-0 shadow-lg bg-gradient-to-br from-background via-background to-muted/30",children:e.jsxs(A,{className:"p-3 md:p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-3 md:gap-4",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsxs(p.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:15},className:"relative w-16 h-16 md:w-20 md:h-20",children:[e.jsxs("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"42",fill:"none",stroke:"currentColor",strokeWidth:"6",className:"text-muted/30"}),e.jsx(p.circle,{cx:"50",cy:"50",r:"42",fill:"none",strokeWidth:"6",strokeLinecap:"round",className:i.color,stroke:"currentColor",initial:{strokeDasharray:"0 264"},animate:{strokeDasharray:`${v/100*264} 264`},transition:{duration:1.5,ease:"easeOut"}})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(p.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:`text-xl md:text-2xl font-bold ${i.color}`,children:v}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"pontos"})]})]})}),e.jsxs("div",{className:"flex-1 text-center md:text-left space-y-1.5",children:[e.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-2",children:[e.jsx(H,{className:`h-4 w-4 ${i.color}`}),e.jsxs("h3",{className:"text-base md:text-lg font-semibold",children:["SaÃºde Financeira: ",e.jsx("span",{className:i.color,children:i.label})]}),e.jsx("span",{className:"text-xl",children:i.emoji})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.description}),e.jsxs("div",{className:`flex items-center justify-center md:justify-start gap-1 text-sm ${k}`,children:[e.jsx(I,{className:"h-4 w-4"}),e.jsxs("span",{children:[(n==null?void 0:n.overall)==="positive"&&"TendÃªncia positiva",(n==null?void 0:n.overall)==="concerning"&&"TendÃªncia de atenÃ§Ã£o",(n==null?void 0:n.overall)==="stable"&&"TendÃªncia estÃ¡vel",(n==null?void 0:n.overall)==="mixed"&&"TendÃªncia mista"]})]})]}),e.jsxs("div",{className:"w-full md:w-auto md:flex-1 max-w-xs",children:[e.jsx("div",{className:"relative h-3 bg-gradient-to-r from-red-500 via-yellow-500 to-emerald-500 rounded-full overflow-hidden",children:e.jsx(p.div,{className:"absolute top-1/2 -translate-y-1/2 w-4 h-4 bg-white rounded-full shadow-lg border-2 border-current",style:{borderColor:"currentColor"},initial:{left:"0%"},animate:{left:`calc(${v}% - 8px)`},transition:{duration:1.5,ease:"easeOut"},children:e.jsx("div",{className:`absolute inset-1 rounded-full ${i.bgColor}`})})}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-0.5",children:[e.jsx("span",{children:"0"}),e.jsx("span",{children:"50"}),e.jsx("span",{children:"100"})]})]})]}),e.jsx(G,{children:e.jsx("div",{className:"grid grid-cols-3 gap-2 md:gap-3 mt-3 pt-3 border-t border-border/50",children:S.map((a,o)=>e.jsxs(V,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2+o*.1},className:"text-center p-1.5 rounded-lg bg-muted/40 hover:bg-muted/60 transition-colors cursor-help",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${a.status==="good"?"bg-green-500":a.status==="medium"?"bg-yellow-500":"bg-red-500"}`}),e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:a.name})]}),e.jsx("span",{className:"text-xs md:text-sm font-semibold",children:a.value})]})}),e.jsx(W,{side:"bottom",className:"max-w-xs",children:e.jsx("p",{className:"text-sm",children:a.tip})})]},a.name))})}),C&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[e.jsxs(_,{variant:"ghost",size:"sm",onClick:()=>F(!h),className:"w-full flex items-center justify-center gap-2 text-muted-foreground hover:text-foreground",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsxs("span",{children:[h?"Ocultar":"Ver"," composiÃ§Ã£o do cÃ¡lculo"]}),h?e.jsx(X,{className:"h-4 w-4"}):e.jsx(Y,{className:"h-4 w-4"})]}),e.jsx(K,{children:h&&e.jsx(p.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/5 border border-primary/20",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-primary mt-0.5 flex-shrink-0"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["O score de saÃºde financeira Ã© calculado com base em ",e.jsx("strong",{children:"4 pilares"}),": Taxa de PoupanÃ§a, Reserva de EmergÃªncia, DiversificaÃ§Ã£o e ConsistÃªncia. A pontuaÃ§Ã£o mÃ¡xima Ã© ",e.jsx("strong",{children:"100 pontos"}),"."]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"1. Taxa de PoupanÃ§a"}),e.jsxs("span",{className:"text-xs px-1.5 py-0.5 rounded bg-primary/10 text-primary",children:["mÃ¡x ",s.savingsMax," pts"]})]}),e.jsxs("span",{className:`text-sm font-bold ${s.savingsPoints>=30?"text-green-500":s.savingsPoints>=15?"text-yellow-500":"text-red-500"}`,children:["+",s.savingsPoints," pts"]})]}),e.jsx(j,{value:s.savingsPoints/s.savingsMax*100,className:"h-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"FÃ³rmula:"})," (Investimentos Ã· (Gastos + Investimentos)) Ã— 100 Ã— 0.4"]}),e.jsxs("p",{className:"font-mono bg-background/50 p-1.5 rounded",children:["(",s.totalInvestments.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})," Ã· (",s.totalExpenses.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})," +",s.totalInvestments.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),")) Ã— 100 Ã— 0.4 = ",e.jsxs("strong",{children:[s.savingsPoints," pts"]})]}),e.jsxs("p",{className:"text-primary/80",children:["ðŸ’¡ Taxa atual: ",Math.round(s.savingsRate),"% â€”",s.savingsRate>=20?" Excelente!":" Meta: â‰¥20%"]})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"2. Reserva de EmergÃªncia"}),e.jsxs("span",{className:"text-xs px-1.5 py-0.5 rounded bg-primary/10 text-primary",children:["mÃ¡x ",s.liquidityMax," pts"]})]}),e.jsxs("span",{className:`text-sm font-bold ${s.liquidityPoints>=25?"text-green-500":s.liquidityPoints>=15?"text-yellow-500":"text-red-500"}`,children:["+",s.liquidityPoints," pts"]})]}),e.jsx(j,{value:s.liquidityPoints/s.liquidityMax*100,className:"h-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"FÃ³rmula:"})," (Reserva de EmergÃªncia Ã· MÃ©dia Mensal de Gastos) Ã— 10 (mÃ¡x 30)"]}),e.jsxs("p",{className:"font-mono bg-background/50 p-1.5 rounded",children:["(",s.emergencyFundFromInvestments.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})," Ã·",s.averageMonthlyExpenses.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),") Ã— 10 = ",e.jsxs("strong",{children:[s.liquidityPoints," pts"]})]}),e.jsxs("div",{className:"text-primary/80 space-y-0.5",children:[e.jsxs("p",{children:["ðŸ’¡ Cobertura: ",s.liquidityRatio.toFixed(1)," meses de gastos"]}),e.jsxs("p",{className:"text-xs",children:["ðŸ“Š MÃ©dia mensal de gastos: ",s.averageMonthlyExpenses.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),"(baseado em ",s.expenseMonthCount," mÃªs(es) de histÃ³rico)"]}),e.jsxs("p",{className:"text-xs",children:["ðŸ¦ Reserva de emergÃªncia: ",s.emergencyFundFromInvestments.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),"(investimentos marcados como reserva)"]})]})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"3. DiversificaÃ§Ã£o"}),e.jsxs("span",{className:"text-xs px-1.5 py-0.5 rounded bg-primary/10 text-primary",children:["mÃ¡x ",s.diversificationMax," pts"]})]}),e.jsxs("span",{className:`text-sm font-bold ${s.diversificationPoints>=15?"text-green-500":s.diversificationPoints>=8?"text-yellow-500":"text-red-500"}`,children:["+",s.diversificationPoints," pts"]})]}),e.jsx(j,{value:s.diversificationPoints/s.diversificationMax*100,className:"h-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"FÃ³rmula:"})," (Categorias Ãšnicas Ã· Total de Investimentos) Ã— 100 Ã— 0.2"]}),e.jsxs("p",{className:"font-mono bg-background/50 p-1.5 rounded",children:["(",s.categoryCount," categorias Ã· ",s.totalInvestmentsCount," aportes) Ã— 100 Ã— 0.2 = ",e.jsxs("strong",{children:[s.diversificationPoints," pts"]})]}),e.jsxs("p",{className:"text-primary/80",children:["ðŸ’¡ ",s.categoryCount," categoria(s) diferentes em ",s.totalInvestmentsCount," aporte(s)"]})]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"4. ConsistÃªncia"}),e.jsxs("span",{className:"text-xs px-1.5 py-0.5 rounded bg-primary/10 text-primary",children:["mÃ¡x ",s.consistencyMax," pts"]})]}),e.jsxs("span",{className:`text-sm font-bold ${s.consistencyPoints>=8?"text-green-500":s.consistencyPoints>=5?"text-yellow-500":"text-red-500"}`,children:["+",s.consistencyPoints," pts"]})]}),e.jsx(j,{value:s.consistencyPoints/s.consistencyMax*100,className:"h-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"FÃ³rmula:"})," (Meses com Investimentos Ã· Total de Meses) Ã— 100 Ã— 0.1"]}),e.jsxs("p",{className:"font-mono bg-background/50 p-1.5 rounded",children:["(",s.monthsWithInvestments," meses ativos Ã· ",s.totalMonths," meses) Ã— 100 Ã— 0.1 = ",e.jsxs("strong",{children:[s.consistencyPoints," pts"]})]}),e.jsxs("p",{className:"text-primary/80",children:["ðŸ’¡ VocÃª investiu em ",Math.round(s.consistencyRate),"% dos meses registrados"]})]})]})]}),e.jsx("div",{className:"p-4 rounded-lg bg-gradient-to-r from-primary/10 to-primary/5 border border-primary/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Score Total"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"text-xs text-muted-foreground block",children:[s.savingsPoints," + ",s.liquidityPoints," + ",s.diversificationPoints," + ",s.consistencyPoints]}),e.jsxs("span",{className:`text-xl font-bold ${i.color}`,children:["= ",v," pontos"]})]})]})})]})})})]})]})})});export{oe as F,ee as M};
