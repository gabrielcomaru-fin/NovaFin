import{c as xt,R as y,ad as tt,r as O,j as i,d as bt}from"./index-ae7326c1.js";import{C as U,a as Y,b as X,c as q,d as H}from"./card-4d905d8a.js";import{i as jt,D as At,b as Pt,c as V,d as K,e as wt,A as kt,h as R,j as Ot,k as J,l as Ct,m as Dt,G as St,n as lt,o as et,u as Et,E as Nt,g as _t,f as Lt,R as ct,C as Tt,T as ut,L as dt}from"./generateCategoricalChart-19c73fd6.js";import{P as Mt,a as It}from"./PieChart-5aaa0970.js";import{a as Ft,b as Rt,p as $t}from"./index-b5f65b9f.js";import{f as rt}from"./index-65722b09.js";import{T as nt}from"./trending-down-64b9ce0b.js";import{X as ft,Y as pt,C as Bt}from"./YAxis-f9d263d3.js";const at=xt("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);var Wt=["type","layout","connectNulls","ref"],Kt=["key"];function N(t){"@babel/helpers - typeof";return N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},N(t)}function it(t,r){if(t==null)return{};var n=zt(t,r),e,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(a=0;a<c.length;a++)e=c[a],!(r.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(t,e)&&(n[e]=t[e])}return n}function zt(t,r){if(t==null)return{};var n={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){if(r.indexOf(e)>=0)continue;n[e]=t[e]}return n}function $(){return $=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t},$.apply(this,arguments)}function ot(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,e)}return n}function x(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ot(Object(n),!0).forEach(function(e){j(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function E(t){return Yt(t)||Ut(t)||Vt(t)||Gt()}function Gt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vt(t,r){if(t){if(typeof t=="string")return Q(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(t,r)}}function Ut(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Yt(t){if(Array.isArray(t))return Q(t)}function Q(t,r){(r==null||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}function Xt(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function st(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,mt(e.key),e)}}function qt(t,r,n){return r&&st(t.prototype,r),n&&st(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ht(t,r,n){return r=z(r),Jt(t,ht()?Reflect.construct(r,n||[],z(t).constructor):r.apply(t,n))}function Jt(t,r){if(r&&(N(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qt(t)}function Qt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ht(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ht=function(){return!!t})()}function z(t){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},z(t)}function Zt(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&Z(t,r)}function Z(t,r){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,a){return e.__proto__=a,e},Z(t,r)}function j(t,r,n){return r=mt(r),r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function mt(t){var r=te(t,"string");return N(r)=="symbol"?r:r+""}function te(t,r){if(N(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var e=n.call(t,r||"default");if(N(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}var C=function(t){function r(){var n;Xt(this,r);for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return n=Ht(this,r,[].concat(a)),j(n,"state",{isAnimationFinished:!0,totalLength:0}),j(n,"generateSimpleStrokeDasharray",function(o,s){return"".concat(s,"px ").concat(o-s,"px")}),j(n,"getStrokeDasharray",function(o,s,d){var l=d.reduce(function(A,w){return A+w});if(!l)return n.generateSimpleStrokeDasharray(s,o);for(var p=Math.floor(o/l),m=o%l,h=s-o,f=[],u=0,v=0;u<d.length;v+=d[u],++u)if(v+d[u]>m){f=[].concat(E(d.slice(0,u)),[m-v]);break}var b=f.length%2===0?[0,h]:[h];return[].concat(E(r.repeat(d,p)),E(f),b).map(function(A){return"".concat(A,"px")}).join(", ")}),j(n,"id",Et("recharts-line-")),j(n,"pathRef",function(o){n.mainCurve=o}),j(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),j(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Zt(r,t),qt(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();this.setState({totalLength:e})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var e=this.getTotalLength();e!==this.state.totalLength&&this.setState({totalLength:e})}}},{key:"getTotalLength",value:function(){var e=this.mainCurve;try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(e,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,o=c.points,s=c.xAxis,d=c.yAxis,l=c.layout,p=c.children,m=Pt(p,Nt);if(!m)return null;var h=function(v,b){return{x:v.x,y:v.y,value:v.value,errorVal:lt(v.payload,b)}},f={clipPath:e?"url(#clipPath-".concat(a,")"):null};return y.createElement(V,f,m.map(function(u){return y.cloneElement(u,{key:"bar-".concat(u.props.dataKey),data:o,xAxis:s,yAxis:d,layout:l,dataPointFormatter:h})}))}},{key:"renderDots",value:function(e,a,c){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var s=this.props,d=s.dot,l=s.points,p=s.dataKey,m=K(this.props,!1),h=K(d,!0),f=l.map(function(v,b){var A=x(x(x({key:"dot-".concat(b),r:3},m),h),{},{index:b,cx:v.x,cy:v.y,value:v.value,dataKey:p,payload:v.payload,points:l});return r.renderDotItem(d,A)}),u={clipPath:e?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return y.createElement(V,$({className:"recharts-line-dots",key:"dots"},u),f)}},{key:"renderCurveStatically",value:function(e,a,c,o){var s=this.props,d=s.type,l=s.layout,p=s.connectNulls;s.ref;var m=it(s,Wt),h=x(x(x({},K(m,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(c,")"):null,points:e},o),{},{type:d,layout:l,connectNulls:p});return y.createElement(wt,$({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(e,a){var c=this,o=this.props,s=o.points,d=o.strokeDasharray,l=o.isAnimationActive,p=o.animationBegin,m=o.animationDuration,h=o.animationEasing,f=o.animationId,u=o.animateNewValues,v=o.width,b=o.height,A=this.state,w=A.prevPoints,_=A.totalLength;return y.createElement(kt,{begin:p,duration:m,isActive:l,easing:h,from:{t:0},to:{t:1},key:"line-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(D){var P=D.t;if(w){var L=w.length/s.length,k=s.map(function(g,G){var I=Math.floor(G*L);if(w[I]){var F=w[I],S=R(F.x,g.x),vt=R(F.y,g.y);return x(x({},g),{},{x:S(P),y:vt(P)})}if(u){var yt=R(v*2,g.x),gt=R(b/2,g.y);return x(x({},g),{},{x:yt(P),y:gt(P)})}return x(x({},g),{},{x:g.x,y:g.y})});return c.renderCurveStatically(k,e,a)}var B=R(0,_),T=B(P),M;if(d){var W="".concat(d).split(/[,\s]+/gim).map(function(g){return parseFloat(g)});M=c.getStrokeDasharray(T,_,W)}else M=c.generateSimpleStrokeDasharray(_,T);return c.renderCurveStatically(s,e,a,{strokeDasharray:M})})}},{key:"renderCurve",value:function(e,a){var c=this.props,o=c.points,s=c.isAnimationActive,d=this.state,l=d.prevPoints,p=d.totalLength;return s&&o&&o.length&&(!l&&p>0||!Ot(l,o))?this.renderCurveWithAnimation(e,a):this.renderCurveStatically(o,e,a)}},{key:"render",value:function(){var e,a=this.props,c=a.hide,o=a.dot,s=a.points,d=a.className,l=a.xAxis,p=a.yAxis,m=a.top,h=a.left,f=a.width,u=a.height,v=a.isAnimationActive,b=a.id;if(c||!s||!s.length)return null;var A=this.state.isAnimationFinished,w=s.length===1,_=tt("recharts-line",d),D=l&&l.allowDataOverflow,P=p&&p.allowDataOverflow,L=D||P,k=J(b)?this.id:b,B=(e=K(o,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},T=B.r,M=T===void 0?3:T,W=B.strokeWidth,g=W===void 0?2:W,G=Ct(o)?o:{},I=G.clipDot,F=I===void 0?!0:I,S=M*2+g;return y.createElement(V,{className:_},D||P?y.createElement("defs",null,y.createElement("clipPath",{id:"clipPath-".concat(k)},y.createElement("rect",{x:D?h:h-f/2,y:P?m:m-u/2,width:D?f:f*2,height:P?u:u*2})),!F&&y.createElement("clipPath",{id:"clipPath-dots-".concat(k)},y.createElement("rect",{x:h-S/2,y:m-S/2,width:f+S,height:u+S}))):null,!w&&this.renderCurve(L,k),this.renderErrorBar(L,k),(w||o)&&this.renderDots(L,F,k),(!v||A)&&Dt.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(e,a){return e.animationId!==a.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,prevPoints:a.curPoints}:e.points!==a.curPoints?{curPoints:e.points}:null}},{key:"repeat",value:function(e,a){for(var c=e.length%2!==0?[].concat(E(e),[0]):e,o=[],s=0;s<a;++s)o=[].concat(E(o),E(c));return o}},{key:"renderDotItem",value:function(e,a){var c;if(y.isValidElement(e))c=y.cloneElement(e,a);else if(jt(e))c=e(a);else{var o=a.key,s=it(a,Kt),d=tt("recharts-line-dot",typeof e!="boolean"?e.className:"");c=y.createElement(At,$({key:o},s,{className:d}))}return c}}])}(O.PureComponent);j(C,"displayName","Line");j(C,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!St.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});j(C,"getComposedData",function(t){var r=t.props,n=t.xAxis,e=t.yAxis,a=t.xAxisTicks,c=t.yAxisTicks,o=t.dataKey,s=t.bandSize,d=t.displayedData,l=t.offset,p=r.layout,m=d.map(function(h,f){var u=lt(h,o);return p==="horizontal"?{x:et({axis:n,ticks:a,bandSize:s,entry:h,index:f}),y:J(u)?null:e.scale(u),value:u,payload:h}:{x:J(u)?null:n.scale(u),y:et({axis:e,ticks:c,bandSize:s,entry:h,index:f}),value:u,payload:h}});return x({points:m,layout:p},l)});var ee=_t({chartName:"LineChart",GraphicalChild:C,axisComponents:[{axisType:"xAxis",AxisComp:ft},{axisType:"yAxis",AxisComp:pt}],formatAxisMap:Lt});const ue=O.memo(function({expenses:r,categories:n}){const e=O.useMemo(()=>{const d=n.filter(f=>f.tipo==="gasto"),l={};r.forEach(f=>{const u=f.categoria_id;l[u]||(l[u]=0),l[u]+=f.valor});const p=d.map(f=>({name:f.nome,value:l[f.id]||0,color:f.cor||"#8884d8"})).filter(f=>f.value>0).sort((f,u)=>u.value-f.value),m=p.slice(0,5),h=p.slice(5).reduce((f,u)=>f+u.value,0);return h>0&&m.push({name:"Outros",value:h,color:"#94a3b8"}),m},[r,n]),a=O.useMemo(()=>e.reduce((d,l)=>d+l.value,0),[e]),c=["#8884d8","#82ca9d","#ffc658","#ff7300","#00ff00","#ff00ff","#00ffff","#ffff00","#ff0000","#0000ff"],o=({active:d,payload:l})=>{if(d&&l&&l.length){const p=l[0],m=(p.value/a*100).toFixed(1);return i.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[i.jsx("p",{className:"font-medium text-foreground",children:p.name}),i.jsxs("p",{className:"text-sm",style:{color:p.color},children:["R$ ",p.value.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[m,"% do total"]})]})}return null},s=({payload:d})=>i.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:d.map((l,p)=>i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:l.color}}),i.jsx("span",{className:"text-muted-foreground",children:l.value})]},p))});return e.length===0?i.jsxs(U,{children:[i.jsxs(Y,{children:[i.jsxs(X,{className:"flex items-center gap-2",children:[i.jsx(at,{className:"h-5 w-5 text-primary"}),"Gastos por Categoria"]}),i.jsx(q,{children:"Distribuição dos gastos por categoria"})]}),i.jsx(H,{children:i.jsx("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:i.jsx("p",{children:"Nenhum gasto encontrado para exibir"})})})]}):i.jsxs(U,{children:[i.jsxs(Y,{children:[i.jsxs(X,{className:"flex items-center gap-2",children:[i.jsx(at,{className:"h-5 w-5 text-primary"}),"Gastos por Categoria"]}),i.jsx(q,{children:"Distribuição dos gastos por categoria"})]}),i.jsx(H,{children:i.jsx("div",{className:"h-80",children:i.jsx(ct,{width:"100%",height:"100%",children:i.jsxs(Mt,{children:[i.jsx(It,{data:e,cx:"50%",cy:"50%",labelLine:!1,label:({name:d,percent:l})=>`${d} ${(l*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:e.map((d,l)=>i.jsx(Tt,{fill:c[l%c.length]},`cell-${l}`))}),i.jsx(ut,{content:i.jsx(o,{})}),i.jsx(dt,{content:i.jsx(s,{})})]})})})})]})}),de=O.memo(function({expenses:r,categories:n}){const e=O.useMemo(()=>Ft({start:Rt(new Date,5),end:new Date}).map(s=>{const d=new Date(s.getFullYear(),s.getMonth(),1),l=new Date(s.getFullYear(),s.getMonth()+1,0),p=r.filter(u=>{const v=$t(u.data);return v>=d&&v<=l}),m=p.reduce((u,v)=>u+v.valor,0),h=p.filter(u=>u.pago).reduce((u,v)=>u+v.valor,0),f=m-h;return{month:rt(s,"MMM/yy"),total:m,paid:h,pending:f,fullMonth:rt(s,"MMMM yyyy")}}),[r]),a=O.useMemo(()=>{if(e.length<2)return 0;const o=e[e.length-1].total,s=e[e.length-2].total;return(o-s)/s*100},[e]),c=({active:o,payload:s,label:d})=>o&&s&&s.length?i.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[i.jsx("p",{className:"font-medium text-foreground",children:d}),s.map((l,p)=>i.jsxs("p",{className:"text-sm",style:{color:l.color},children:[l.name,": R$ ",l.value.toLocaleString("pt-BR",{minimumFractionDigits:2})]},p))]}):null;return i.jsxs(U,{children:[i.jsxs(Y,{children:[i.jsxs(X,{className:"flex items-center gap-2",children:[i.jsx(nt,{className:"h-5 w-5 text-destructive"}),"Tendência de Gastos"]}),i.jsxs(q,{children:["Evolução dos gastos nos últimos 6 meses",a!==0&&i.jsxs("span",{className:`ml-2 flex items-center gap-1 ${a>0?"text-destructive":"text-green-600"}`,children:[a>0?i.jsx(bt,{className:"h-3 w-3"}):i.jsx(nt,{className:"h-3 w-3"}),Math.abs(a).toFixed(1),"% vs mês anterior"]})]})]}),i.jsx(H,{children:i.jsx("div",{className:"h-80",children:i.jsx(ct,{width:"100%",height:"100%",children:i.jsxs(ee,{data:e,margin:{top:5,right:30,left:20,bottom:5},children:[i.jsx(Bt,{strokeDasharray:"3 3",className:"opacity-30"}),i.jsx(ft,{dataKey:"month",tick:{fontSize:12},tickLine:{stroke:"hsl(var(--muted-foreground))"}}),i.jsx(pt,{tick:{fontSize:12},tickLine:{stroke:"hsl(var(--muted-foreground))"},tickFormatter:o=>`R$ ${(o/1e3).toFixed(0)}k`}),i.jsx(ut,{content:i.jsx(c,{})}),i.jsx(dt,{}),i.jsx(C,{type:"monotone",dataKey:"total",stroke:"hsl(var(--destructive))",strokeWidth:2,name:"Total",dot:{fill:"hsl(var(--destructive))",strokeWidth:2,r:4}}),i.jsx(C,{type:"monotone",dataKey:"paid",stroke:"hsl(var(--green-500))",strokeWidth:2,name:"Pago",dot:{fill:"hsl(var(--green-500))",strokeWidth:2,r:4}}),i.jsx(C,{type:"monotone",dataKey:"pending",stroke:"hsl(var(--yellow-500))",strokeWidth:2,name:"Pendente",dot:{fill:"hsl(var(--yellow-500))",strokeWidth:2,r:4}})]})})})})]})});export{ue as C,de as E};
