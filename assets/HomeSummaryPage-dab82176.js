import{r,i as re,k as ne,R as y,j as e,H as oe,C as g,a as h,b as f,e as j,T,d as L,l as ie,A as G,h as B,L as M}from"./index-4214a3df.js";import{P as ce,L as I}from"./progress-7291fe9e.js";import{s as le,e as me,C as de,a as xe}from"./CompactHeader-d249c32c.js";import{a as P,b as S,p as $,e as q,s as ue}from"./index-b30782cb.js";import{f as pe}from"./index-65722b09.js";import{p as ge}from"./index-23bf3cd3.js";import{P as he}from"./piggy-bank-5fbe0e85.js";import"./select-2a702a5a.js";import"./index-a53a69e9.js";import"./trash-2-7dc5b03a.js";const Ce=r.memo(function(){const{expenses:A,investments:w,categories:je,accounts:be,investmentGoal:k,totalPatrimony:z,totalInvestmentBalance:ve}=re(),{evaluateAchievements:E}=ne(),[x,V]=y.useState("monthly"),[a,U]=y.useState(void 0),[b,_]=y.useState(new Date().getMonth()),[n,Q]=y.useState(new Date().getFullYear()),J=r.useCallback(s=>V(s),[]),K=r.useCallback(s=>U(s),[]),W=r.useCallback(s=>_(s),[]),X=r.useCallback(s=>Q(s),[]),{startDate:m,endDate:u}=r.useMemo(()=>{let s,t;if(a&&a.from)s=a.from,t=a.to||a.from;else if(x==="yearly"&&n)s=le(new Date(n,0,1)),t=me(new Date(n,11,31));else if(x==="monthly"&&b!==void 0&&n)s=P(new Date(n,b,1)),t=S(new Date(n,b,1));else{const l=new Date;s=P(l),t=S(l)}return t.setHours(23,59,59,999),{startDate:s,endDate:t}},[a,x,b,n]),F=r.useMemo(()=>A.filter(s=>{const t=$(s.data);return t>=m&&t<=u}),[A,m,u]),Z=r.useMemo(()=>w.filter(s=>{const t=$(s.data);return t>=m&&t<=u}),[w,m,u]),ee=F.reduce((s,t)=>s+t.valor,0),v=F.filter(s=>s.pago).reduce((s,t)=>s+t.valor,0),p=F.filter(s=>!s.pago).reduce((s,t)=>s+t.valor,0),i=Z.reduce((s,t)=>s+t.valor_aporte,0),se=r.useMemo(()=>{if(a&&a.from)return q({start:P(a.from),end:S(a.to||a.from)}).length;if(x==="yearly"&&n){const s=new Date;return n<s.getFullYear()?12:n>s.getFullYear()?0:s.getMonth()+1}return 1},[a,x,n]),o=(Number(k)||0)*se,c=o>0?i/o*100:0,D=i+v>0?i/(i+v)*100:0,N=r.useMemo(()=>{const s=Number(k)||0;return q({start:ue(new Date,5),end:new Date}).map(l=>{const te=P(l),ae=S(l),O=w.filter(C=>{const R=$(C.data);return R>=te&&R<=ae}).reduce((C,R)=>C+R.valor_aporte,0);return{label:pe(l,"MMM/yy",{locale:ge}),invested:O,achieved:s>0?O>=s:!1}})},[w,k]),Y=r.useMemo(()=>{const s=new Date,t=u.getTime()-m.getTime(),l=Math.min(Math.max(s.getTime()-m.getTime(),0),t);return t>0?l/t:1},[m,u]),d=r.useMemo(()=>{let s=0;for(let t=N.length-1;t>=0&&N[t].achieved;t--)s++;return s},[N]);y.useEffect(()=>{E({monthlyStreak:d})},[d,E]);const H=r.useMemo(()=>{const s=[];if(o>0){const t=Y*100;c>=100?s.push({type:"success",message:"Parabéns! Você bateu a meta do período. Mantenha a consistência com pequenos aportes recorrentes."}):c<t*.9?s.push({type:"tip",message:"Você está abaixo do ritmo esperado para a meta. Antecipe um aporte menor hoje para aliviar o fim do período."}):s.push({type:"tip",message:"Bom ritmo! Um pequeno aporte extra pode garantir que você bata a meta antes do fim do período."})}return p>0&&p>=v*.5&&s.push({type:"warning",message:"Pendências elevadas neste período. Priorize quitar para liberar fluxo para os aportes."}),D<15?s.push({type:"tip",message:"Sua taxa de poupança está baixa. Avalie reduzir uma categoria de gasto e redirecionar a diferença para aportes."}):D>=25&&s.push({type:"success",message:"Excelente taxa de poupança! Considere automatizar aportes para manter esse padrão."}),d>=2&&s.push({type:"success",message:`Ótimo hábito! Você bateu a meta por ${d} meses seguidos.`}),s.slice(0,3)},[c,Y,o,p,v,D,d]);return e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:"Resumo Geral - Lumify"})}),e.jsxs("div",{className:"space-y-4 md:space-y-5 page-top",children:[e.jsx(de,{title:"Olá! 👋",subtitle:"Aqui está seu resumo financeiro",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(xe,{periodType:x,setPeriodType:J,dateRange:a,setDateRange:K,month:b,setMonth:W,year:n,setYear:X}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary",children:["R$ ",z.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Patrimônio Total"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[e.jsxs(g,{className:"border-l-4 border-l-destructive",children:[e.jsx(h,{className:"pb-2",children:e.jsx(f,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:"Gastos no Período"})}),e.jsxs(j,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:["R$ ",ee.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["✅ R$ ",v.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("span",{children:["⏳ R$ ",p.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})]}),e.jsxs(g,{className:"border-l-4 border-l-income",children:[e.jsx(h,{className:"pb-2",children:e.jsx(f,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:"Aportes no Período"})}),e.jsxs(j,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:["R$ ",i.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:e.jsxs("span",{children:["Taxa de poupança: ",Math.round(D),"%"]})})]})]}),e.jsxs(g,{className:"border-l-4 border-l-primary",children:[e.jsx(h,{className:"pb-2",children:e.jsx(f,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:"Progresso da Meta"})}),e.jsx(j,{children:o>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(c),"%"]}),e.jsx(ce,{value:Math.min(c,100),className:"h-3 mt-3"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["R$ ",i.toLocaleString("pt-BR",{minimumFractionDigits:2})," de R$ ",o.toLocaleString("pt-BR",{minimumFractionDigits:2}),c>100&&e.jsxs("span",{className:"block text-green-600 font-medium",children:["R$ ",(i-o).toLocaleString("pt-BR",{minimumFractionDigits:2})," além da meta! 🎉"]})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(T,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Defina uma meta mensal"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 md:gap-4",children:[H.length>0&&e.jsxs(g,{children:[e.jsxs(h,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-warning"}),"Insights para você"]}),e.jsx(L,{children:"Dicas personalizadas baseadas no seu momento atual"})]}),e.jsxs(j,{className:"space-y-3",children:[d>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full border bg-card text-xs",children:[e.jsx(ie,{className:"h-3.5 w-3.5 text-primary"}),"Streak mensal: ",d,"m"]}),H.map((s,t)=>e.jsxs("div",{className:"p-4 rounded-lg bg-secondary/50 text-sm flex items-start gap-3",children:[s.type==="warning"&&e.jsx(G,{className:"h-5 w-5 text-warning mt-0.5 flex-shrink-0"}),s.type==="success"&&e.jsx(B,{className:"h-5 w-5 text-success mt-0.5 flex-shrink-0"}),s.type==="tip"&&e.jsx(I,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:s.message})]},t))]})]}),e.jsxs(g,{children:[e.jsxs(h,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-income"}),"Próximos passos"]}),e.jsx(L,{children:"Ações sugeridas baseadas no seu progresso"})]}),e.jsxs(j,{className:"space-y-3",children:[p>0&&e.jsx(M,{to:"/gastos",className:"block p-3 rounded-lg border border-warning bg-warning-muted hover:bg-warning-muted/80 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Quitar pendências"}),e.jsxs("p",{className:"text-sm text-warning",children:["R$ ",p.toLocaleString("pt-BR",{minimumFractionDigits:2})," em aberto"]})]}),e.jsx(G,{className:"h-5 w-5 text-warning"})]})}),c<100&&o>0&&e.jsx(M,{to:"/investimentos",className:"block p-3 rounded-lg border border-primary/20 bg-primary/5 hover:bg-primary/10 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Fazer aporte"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Faltam R$ ",(o-i).toLocaleString("pt-BR",{minimumFractionDigits:2})," para a meta"]})]}),e.jsx(B,{className:"h-5 w-5 text-primary"})]})}),c>=100&&e.jsx(M,{to:"/projecao-investimentos",className:"block p-3 rounded-lg border border-success bg-success-muted hover:bg-success-muted/80 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Meta atingida! 🎉"}),e.jsx("p",{className:"text-sm text-success",children:"Veja projeções para o futuro"})]}),e.jsx(T,{className:"h-5 w-5 text-success"})]})}),e.jsx(M,{to:"/investimentos",className:"block p-3 rounded-lg border border-muted hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Gerenciar metas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ajustar objetivos de investimento"})]}),e.jsx(T,{className:"h-5 w-5 text-muted-foreground"})]})})]})]})]}),N.some(s=>s.invested>0)&&e.jsxs(g,{className:"bg-muted/30",children:[e.jsxs(h,{children:[e.jsxs(f,{className:"text-lg flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-muted-foreground"}),"Evolução dos Aportes"]}),e.jsx(L,{children:"Últimos 6 meses de atividade"})]}),e.jsx(j,{children:e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-3",children:N.map((s,t)=>e.jsxs("div",{className:`p-3 rounded-lg text-center ${s.achieved?"bg-success-muted border border-success":"bg-background border border-border"}`,children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:s.label}),e.jsxs("div",{className:"text-sm font-semibold",children:["R$ ",s.invested.toLocaleString("pt-BR",{minimumFractionDigits:0})]}),s.achieved&&e.jsx("div",{className:"text-xs text-success mt-1",children:"✓ Meta"})]},t))})})]})]})]})});export{Ce as HomeSummaryPage};
