import{r,g as oe,h as le,R as w,j as e,H as ce,L as D,B as de,S as me,C as d,a as m,b as x,e as u,D as q,T as $,d as k,A as T,i as V,k as A}from"./index-f09e9372.js";import{u as xe,P as ue,L as I}from"./useIncomeInsights-2177f88d.js";import{s as pe,e as ge,C as he,a as je}from"./CompactHeader-ab4c6809.js";import{s as F,e as P,p as E,a as fe}from"./index-a49341d7.js";import{e as U}from"./index-9eaf3fc2.js";import{f as be}from"./index-65722b09.js";import{p as Ne}from"./index-23bf3cd3.js";import{P as ve}from"./piggy-bank-21d8ee85.js";import"./select-157e3a99.js";import"./index-a53a69e9.js";import"./trash-2-90f3cb39.js";const Ie=r.memo(function(){const{expenses:Y,investments:R,categories:we,accounts:De,investmentGoal:B,totalPatrimony:_,totalInvestmentBalance:Re}=oe(),h=xe(),{evaluateAchievements:H}=le(),[j,Q]=w.useState("monthly"),[a,J]=w.useState(void 0),[N,K]=w.useState(new Date().getMonth()),[n,W]=w.useState(new Date().getFullYear()),X=r.useCallback(s=>Q(s),[]),Z=r.useCallback(s=>J(s),[]),ee=r.useCallback(s=>K(s),[]),se=r.useCallback(s=>W(s),[]),{startDate:p,endDate:f}=r.useMemo(()=>{let s,t;if(a&&a.from)s=a.from,t=a.to||a.from;else if(j==="yearly"&&n)s=pe(new Date(n,0,1)),t=ge(new Date(n,11,31));else if(j==="monthly"&&N!==void 0&&n)s=F(new Date(n,N,1)),t=P(new Date(n,N,1));else{const c=new Date;s=F(c),t=P(c)}return t.setHours(23,59,59,999),{startDate:s,endDate:t}},[a,j,N,n]),C=r.useMemo(()=>Y.filter(s=>{const t=E(s.data);return t>=p&&t<=f}),[Y,p,f]),te=r.useMemo(()=>R.filter(s=>{const t=E(s.data);return t>=p&&t<=f}),[R,p,f]),ae=C.reduce((s,t)=>s+t.valor,0),v=C.filter(s=>s.pago).reduce((s,t)=>s+t.valor,0),b=C.filter(s=>!s.pago).reduce((s,t)=>s+t.valor,0),o=te.reduce((s,t)=>s+t.valor_aporte,0),re=r.useMemo(()=>{if(a&&a.from)return U({start:F(a.from),end:P(a.to||a.from)}).length;if(j==="yearly"&&n){const s=new Date;return n<s.getFullYear()?12:n>s.getFullYear()?0:s.getMonth()+1}return 1},[a,j,n]),i=(Number(B)||0)*re,l=i>0?o/i*100:0,M=o+v>0?o/(o+v)*100:0,y=r.useMemo(()=>{const s=Number(B)||0;return U({start:fe(new Date,5),end:new Date}).map(c=>{const ne=F(c),ie=P(c),G=R.filter(L=>{const S=E(L.data);return S>=ne&&S<=ie}).reduce((L,S)=>L+S.valor_aporte,0);return{label:be(c,"MMM/yy",{locale:Ne}),invested:G,achieved:s>0?G>=s:!1}})},[R,B]),O=r.useMemo(()=>{const s=new Date,t=f.getTime()-p.getTime(),c=Math.min(Math.max(s.getTime()-p.getTime(),0),t);return t>0?c/t:1},[p,f]),g=r.useMemo(()=>{let s=0;for(let t=y.length-1;t>=0&&y[t].achieved;t--)s++;return s},[y]);w.useEffect(()=>{H({monthlyStreak:g})},[g,H]);const z=r.useMemo(()=>{const s=[];if(i>0){const t=O*100;l>=100?s.push({type:"success",message:"ParabÃ©ns! VocÃª bateu a meta do perÃ­odo. Mantenha a consistÃªncia com pequenos aportes recorrentes."}):l<t*.9?s.push({type:"tip",message:"VocÃª estÃ¡ abaixo do ritmo esperado para a meta. Antecipe um aporte menor hoje para aliviar o fim do perÃ­odo."}):s.push({type:"tip",message:"Bom ritmo! Um pequeno aporte extra pode garantir que vocÃª bata a meta antes do fim do perÃ­odo."})}return b>0&&b>=v*.5&&s.push({type:"warning",message:"PendÃªncias elevadas neste perÃ­odo. Priorize quitar para liberar fluxo para os aportes."}),M<15?s.push({type:"tip",message:"Sua taxa de poupanÃ§a estÃ¡ baixa. Avalie reduzir uma categoria de gasto e redirecionar a diferenÃ§a para aportes."}):M>=25&&s.push({type:"success",message:"Excelente taxa de poupanÃ§a! Considere automatizar aportes para manter esse padrÃ£o."}),g>=2&&s.push({type:"success",message:`Ã“timo hÃ¡bito! VocÃª bateu a meta por ${g} meses seguidos.`}),s.slice(0,3)},[l,O,i,b,v,M,g]);return e.jsxs(e.Fragment,{children:[e.jsx(ce,{children:e.jsx("title",{children:"Resumo Geral - Lumify"})}),e.jsxs("div",{className:"space-y-4 md:space-y-5 page-top",children:[e.jsx(he,{title:"OlÃ¡! ðŸ‘‹",subtitle:"Aqui estÃ¡ seu resumo financeiro",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(je,{periodType:j,setPeriodType:X,dateRange:a,setDateRange:Z,month:N,setMonth:ee,year:n,setYear:se}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold text-primary",children:["R$ ",_.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"PatrimÃ´nio Total"})]}),e.jsx(D,{to:"/configuracoes",children:e.jsx(de,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(me,{className:"h-4 w-4"})})})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 md:gap-4",children:[e.jsxs(d,{className:"border-l-4 border-l-destructive",children:[e.jsx(m,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:"Gastos no PerÃ­odo"})}),e.jsxs(u,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:["R$ ",ae.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["âœ… R$ ",v.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("span",{children:["â³ R$ ",b.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})]}),e.jsxs(d,{className:`border-l-4 ${h.availableBalance>=0?"border-l-green-500":"border-l-red-500"}`,children:[e.jsx(m,{className:"pb-2",children:e.jsxs(x,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Saldo DisponÃ­vel"]})}),e.jsxs(u,{children:[e.jsxs("div",{className:`text-3xl font-bold ${h.availableBalance>=0?"text-green-600":"text-red-600"}`,children:["R$ ",h.availableBalance.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:e.jsxs("span",{children:["Pode gastar: R$ ",h.dailySpendingCapacity.toLocaleString("pt-BR",{minimumFractionDigits:2}),"/dia"]})})]})]}),e.jsxs(d,{className:"border-l-4 border-l-income",children:[e.jsx(m,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:"Aportes no PerÃ­odo"})}),e.jsxs(u,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:["R$ ",o.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:e.jsxs("span",{children:["Taxa de poupanÃ§a: ",Math.round(M),"%"]})})]})]}),e.jsxs(d,{className:"border-l-4 border-l-primary",children:[e.jsx(m,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:"Progresso da Meta"})}),e.jsx(u,{children:i>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(l),"%"]}),e.jsx(ue,{value:Math.min(l,100),className:"h-3 mt-3"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["R$ ",o.toLocaleString("pt-BR",{minimumFractionDigits:2})," de R$ ",i.toLocaleString("pt-BR",{minimumFractionDigits:2}),l>100&&e.jsxs("span",{className:"block text-green-600 font-medium",children:["R$ ",(o-i).toLocaleString("pt-BR",{minimumFractionDigits:2})," alÃ©m da meta! ðŸŽ‰"]})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx($,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Defina uma meta mensal"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 md:gap-4",children:[h.recommendations.length>0&&e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-primary"}),"Insights Financeiros"]}),e.jsx(k,{children:"RecomendaÃ§Ãµes baseadas na sua situaÃ§Ã£o atual"})]}),e.jsx(u,{className:"space-y-3",children:h.recommendations.slice(0,3).map((s,t)=>e.jsxs("div",{className:`p-4 rounded-lg text-sm flex items-start gap-3 ${s.type==="warning"?"bg-red-50 border border-red-200":s.type==="success"?"bg-green-50 border border-green-200":"bg-blue-50 border border-blue-200"}`,children:[s.type==="warning"&&e.jsx(T,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),s.type==="success"&&e.jsx(V,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),s.type==="tip"&&e.jsx(I,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.message}),s.action&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["ðŸ’¡ ",s.action]})]})]},t))})]}),z.length>0&&e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-warning"}),"Insights para vocÃª"]}),e.jsx(k,{children:"Dicas personalizadas baseadas no seu momento atual"})]}),e.jsxs(u,{className:"space-y-3",children:[g>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full border bg-card text-xs",children:[e.jsx(V,{className:"h-3.5 w-3.5 text-primary"}),"Streak mensal: ",g,"m"]}),z.map((s,t)=>e.jsxs("div",{className:"p-4 rounded-lg bg-secondary/50 text-sm flex items-start gap-3",children:[s.type==="warning"&&e.jsx(T,{className:"h-5 w-5 text-warning mt-0.5 flex-shrink-0"}),s.type==="success"&&e.jsx(A,{className:"h-5 w-5 text-success mt-0.5 flex-shrink-0"}),s.type==="tip"&&e.jsx(I,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:s.message})]},t))]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5 text-income"}),"PrÃ³ximos passos"]}),e.jsx(k,{children:"AÃ§Ãµes sugeridas baseadas no seu progresso"})]}),e.jsxs(u,{className:"space-y-3",children:[b>0&&e.jsx(D,{to:"/gastos",className:"block p-3 rounded-lg border border-warning bg-warning-muted hover:bg-warning-muted/80 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Quitar pendÃªncias"}),e.jsxs("p",{className:"text-sm text-warning",children:["R$ ",b.toLocaleString("pt-BR",{minimumFractionDigits:2})," em aberto"]})]}),e.jsx(T,{className:"h-5 w-5 text-warning"})]})}),l<100&&i>0&&e.jsx(D,{to:"/investimentos",className:"block p-3 rounded-lg border border-primary/20 bg-primary/5 hover:bg-primary/10 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Fazer aporte"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Faltam R$ ",(i-o).toLocaleString("pt-BR",{minimumFractionDigits:2})," para a meta"]})]}),e.jsx(A,{className:"h-5 w-5 text-primary"})]})}),l>=100&&e.jsx(D,{to:"/projecao-investimentos",className:"block p-3 rounded-lg border border-success bg-success-muted hover:bg-success-muted/80 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Meta atingida! ðŸŽ‰"}),e.jsx("p",{className:"text-sm text-success",children:"Veja projeÃ§Ãµes para o futuro"})]}),e.jsx($,{className:"h-5 w-5 text-success"})]})}),e.jsx(D,{to:"/investimentos",className:"block p-3 rounded-lg border border-muted hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Gerenciar metas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ajustar objetivos de investimento"})]}),e.jsx($,{className:"h-5 w-5 text-muted-foreground"})]})})]})]})]}),y.some(s=>s.invested>0)&&e.jsxs(d,{className:"bg-muted/30",children:[e.jsxs(m,{children:[e.jsxs(x,{className:"text-lg flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-muted-foreground"}),"EvoluÃ§Ã£o dos Aportes"]}),e.jsx(k,{children:"Ãšltimos 6 meses de atividade"})]}),e.jsx(u,{children:e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-6 gap-3",children:y.map((s,t)=>e.jsxs("div",{className:`p-3 rounded-lg text-center ${s.achieved?"bg-success-muted border border-success":"bg-background border border-border"}`,children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:s.label}),e.jsxs("div",{className:"text-sm font-semibold",children:["R$ ",s.invested.toLocaleString("pt-BR",{minimumFractionDigits:0})]}),s.achieved&&e.jsx("div",{className:"text-xs text-success mt-1",children:"âœ“ Meta"})]},t))})})]})]})]})});export{Ie as HomeSummaryPage};
