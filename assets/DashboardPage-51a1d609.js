import{r as u,R as I,j as e,m as v,b as O,d as ee,D as he,T as re,L as fe,e as ge,H as je}from"./index-ae7326c1.js";import{s as ve,e as ye,C as be,a as Ne}from"./CompactHeader-a84bba81.js";import{f as E,M as we}from"./MonthlyComparisonChart-acda16d5.js";import{T as De}from"./trending-down-64b9ce0b.js";import{P as ie,L as X}from"./progress-ba87324f.js";import{A as oe}from"./alert-triangle-0e714880.js";import{G as Pe}from"./GamificationPanel-05476ad8.js";import{s as T,e as L,p as P,a as Z,b as U}from"./index-b5f65b9f.js";import{f as Me}from"./index-65722b09.js";import"./index-a53a69e9.js";import"./extends-4c19d496.js";import"./trash-2-1116d365.js";import"./card-4d905d8a.js";import"./index-23bf3cd3.js";import"./generateCategoricalChart-19c73fd6.js";import"./YAxis-f9d263d3.js";const B=()=>{const n={smooth:{duration:.2,ease:[.4,0,.2,1]},quick:{duration:.15,ease:[.4,0,.2,1]},fade:{duration:.3,ease:[.4,0,.2,1]},slide:{duration:.25,ease:[.4,0,.2,1]},scale:{duration:.2,ease:[.4,0,.2,1]}},t={button:{initial:{scale:1},hover:{scale:1.02,transition:n.quick},tap:{scale:.98,transition:n.quick}},card:{initial:{scale:1,boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)"},hover:{scale:1.02,boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)",transition:n.smooth}},cardSubtle:{initial:{scale:1,y:0},hover:{scale:1.01,y:-2,transition:n.smooth}},fadeIn:{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:n.fade},exit:{opacity:0,y:-10,transition:n.fade}},slideIn:{initial:{opacity:0,x:-20},animate:{opacity:1,x:0,transition:n.slide},exit:{opacity:0,x:20,transition:n.slide}},scaleIn:{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1,transition:n.scale},exit:{opacity:0,scale:.9,transition:n.scale}},loading:{initial:{opacity:.5},animate:{opacity:[.5,1,.5],transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}}},pulse:{initial:{scale:1},animate:{scale:[1,1.05,1],transition:{duration:2,repeat:1/0,ease:"easeInOut"}}},shake:{initial:{x:0},animate:{x:[-10,10,-10,10,0],transition:{duration:.5,ease:"easeInOut"}}}},s=u.useCallback(l=>({initial:l.initial||{},animate:l.animate||{},exit:l.exit||{},transition:l.transition||n.smooth}),[n]),m=u.useCallback((l=.1)=>({initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{...n.fade,delay:l}}}),[n]);return{transitions:n,variants:t,createCustomAnimation:s,createStaggerAnimation:m}},M=I.forwardRef(({className:n,hover:t=!0,animation:s="subtle",children:m,...l},f)=>{const{variants:i}=B(),h=s==="subtle"?i.cardSubtle:i.card;return e.jsx(v.div,{ref:f,className:O("rounded-lg border bg-card text-card-foreground shadow-sm transition-shadow duration-200",t&&"cursor-pointer",n),variants:h,initial:"initial",whileHover:t?"hover":void 0,...l,children:m})});M.displayName="Card";const R=I.forwardRef(({className:n,...t},s)=>e.jsx(v.div,{ref:s,className:O("flex flex-col space-y-1.5 p-6",n),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.1},...t}));R.displayName="CardHeader";const C=I.forwardRef(({className:n,...t},s)=>e.jsx(v.h3,{ref:s,className:O("text-lg font-semibold leading-none tracking-tight",n),initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.2,delay:.15},...t}));C.displayName="CardTitle";const q=I.forwardRef(({className:n,...t},s)=>e.jsx(v.p,{ref:s,className:O("text-sm text-muted-foreground",n),initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},...t}));q.displayName="CardDescription";const S=I.forwardRef(({className:n,...t},s)=>e.jsx(v.div,{ref:s,className:O("p-6 pt-0",n),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.25},...t}));S.displayName="CardContent";const Re=I.forwardRef(({className:n,...t},s)=>e.jsx(v.div,{ref:s,className:O("flex items-center p-6 pt-0",n),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.3},...t}));Re.displayName="CardFooter";const Ce=u.memo(function({totalMonthlyExpenses:t,totalMonthlyInvestments:s,totalPaidExpenses:m,totalPendingExpenses:l,savingsRate:f,periodInvestmentGoal:i,investmentProgress:h,previousMonthExpenses:b=0,previousMonthInvestments:$=0,isLoading:p=!1}){const{createStaggerAnimation:H}=B(),N=t-b,F=s-$,g=[{title:"Gastos no Período",value:t,icon:De,iconColor:"text-expense",subtitle:`Pago: ${E(m)} • Pendente: ${E(l)}`,href:"/gastos",delta:N,delay:.1},{title:"Aportes no Período",value:s,icon:ee,iconColor:"text-income",subtitle:null,href:"/investimentos",delta:F,delay:.2},{title:"Taxa de Poupança",value:`${Math.round(f)}%`,icon:he,iconColor:"text-primary",subtitle:"Aportes / (Aportes + Gastos pagos)",href:"/resumo",delay:.3},{title:"Progresso da Meta",value:i>0?`${Math.round(h)}%`:"-",icon:re,iconColor:"text-primary",subtitle:i>0?`${E(s)} de ${E(i)}`:"Defina uma meta mensal para acompanhar o progresso.",href:"/projecao-investimentos",delay:.4}];return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 auto-rows-fr",children:g.map((o,d)=>{const Y=o.icon;return e.jsx(v.div,{...H(o.delay),children:e.jsx(fe,{to:o.href,className:"block focus:outline-none focus:ring-2 focus:ring-primary rounded-md",children:e.jsxs(M,{className:"h-full",hover:!0,animation:"subtle",children:[e.jsxs(R,{className:"flex flex-row items-center justify-between space-y-0 pb-1.5",children:[e.jsx(C,{className:"text-sm font-medium text-muted-foreground",children:o.title}),e.jsx(Y,{className:`h-4 w-4 ${o.iconColor}`})]}),e.jsxs(S,{children:[e.jsx("div",{className:"text-xl md:text-2xl font-bold",children:p?e.jsx("div",{className:"h-6 w-24 bg-muted rounded animate-pulse"}):typeof o.value=="number"?E(o.value):o.value}),o.subtitle&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:o.subtitle}),typeof o.delta=="number"&&(o.title==="Gastos no Período"||o.title==="Aportes no Período")&&e.jsxs("p",{className:`text-xs mt-1 ${o.delta>=0?"text-warning":"text-success"}`,children:[(o.title==="Gastos no Período",o.delta>=0?"▲":"▼")," ",E(Math.abs(o.delta))," vs mês anterior"]})]})]})})},o.title)})})}),Se=u.memo(function({totalMonthlyInvestments:t,periodInvestmentGoal:s,investmentProgress:m,totalMonthlyExpenses:l,totalExpenseLimit:f,expenseLimitProgress:i}){const{createStaggerAnimation:h}=B();return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(v.div,{...h(.5),children:e.jsxs(M,{hover:!0,animation:"subtle",children:[e.jsxs(R,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-primary"}),"Meta de Aportes (período)"]}),e.jsx(q,{children:s>0?`Progresso: R$ ${t.toLocaleString("pt-BR",{minimumFractionDigits:2})} de R$ ${s.toLocaleString("pt-BR",{minimumFractionDigits:2})}`:"Defina uma meta de aportes nos investimentos."})]}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(ie,{value:Math.min(m,100),className:"h-4 [&>*]:bg-gradient-to-r [&>*]:from-income [&>*]:to-income [&>*]:transition-all [&>*]:duration-500"}),s>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:m>=100?`🎉 Meta superada! ${Math.round(m)}% alcançado!`:`${Math.round(m)}% da meta alcançada`}),m<100?e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Faltam R$ ",(s-t).toLocaleString("pt-BR",{minimumFractionDigits:2})]}):e.jsxs("p",{className:"text-xs text-muted-foreground",children:["R$ ",(t-s).toLocaleString("pt-BR",{minimumFractionDigits:2})," além da meta!"]})]})]})})]})}),e.jsx(v.div,{...h(.6),children:e.jsxs(M,{hover:!0,animation:"subtle",children:[e.jsxs(R,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5 text-warning"}),"Teto de Gastos Mensal"]}),e.jsx(q,{children:f>0?`Utilizado: R$ ${l.toLocaleString("pt-BR",{minimumFractionDigits:2})} de R$ ${f.toLocaleString("pt-BR",{minimumFractionDigits:2})}`:"Defina tetos de gastos nas configurações."})]}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(ie,{value:Math.min(i,100),className:`h-4 transition-all duration-500 ${i>90?"[&>*]:bg-gradient-to-r [&>*]:from-error [&>*]:to-error":i>70?"[&>*]:bg-gradient-to-r [&>*]:from-warning [&>*]:to-warning":"[&>*]:bg-gradient-to-r [&>*]:from-info [&>*]:to-info"}`}),f>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:i>=100?"⚠️ Limite de gastos atingido!":`${Math.round(i)}% do limite utilizado`}),i<100&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Restam R$ ",(f-l).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})})]})})]})}),$e=u.memo(function({projection12m:t}){const{createStaggerAnimation:s}=B();return e.jsx(v.div,{...s(.7),children:e.jsxs(M,{className:"h-full",hover:!0,animation:"subtle",children:[e.jsxs(R,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5 text-income"})," Projeção de 12 meses (aporte médio 3m)"]}),e.jsx(q,{children:"Estimativa simples baseada no aporte médio recente. Use a página Projeção para um modelo detalhado."})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",t.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Não considera rendimentos; apenas constância de aportes."})]})]})})}),Fe=u.memo(function({expensesByCategory:t,totalMonthlyExpenses:s,expenseCategories:m}){const{createStaggerAnimation:l}=B();return Object.keys(t).some(i=>t[i]>0)?e.jsx(v.div,{...l(.8),children:e.jsxs(M,{hover:!0,animation:"subtle",children:[e.jsxs(R,{children:[e.jsx(C,{children:"Gastos por Categoria"}),e.jsx(q,{children:"Distribuição dos seus gastos no período"})]}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex w-full h-3 rounded-full overflow-hidden",children:m.filter(i=>(t[i.id]||0)>0).map(i=>{const h=t[i.id]/s*100;return e.jsx("div",{className:"bg-primary",style:{width:`${h}%`,backgroundColor:`hsl(213, 77%, ${60-h/5}%)`}},i.id)})}),m.filter(i=>(t[i.id]||0)>0).sort((i,h)=>(t[h.id]||0)-(t[i.id]||0)).map(i=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm font-semibold",children:i.nome})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["R$ ",(t[i.id]||0).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]},i.id))]})})]})}):null}),Ae=u.memo(function({tips:t}){const{createStaggerAnimation:s}=B(),m=l=>{switch(l){case"warning":return e.jsx(oe,{className:"h-5 w-5 text-warning mt-0.5 flex-shrink-0"});case"success":return e.jsx(ee,{className:"h-5 w-5 text-success mt-0.5 flex-shrink-0"});case"tip":return e.jsx(X,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"});default:return e.jsx(X,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"})}};return e.jsx(v.div,{...s(.9),children:e.jsxs(M,{hover:!0,animation:"subtle",children:[e.jsx(R,{children:e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-warning"}),"Dicas Financeiras"]})}),e.jsx(S,{className:"space-y-3",children:t.map((l,f)=>e.jsxs(v.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2+f*.1},className:"p-3 rounded-lg flex items-start gap-3 bg-secondary",children:[m(l.type),e.jsx("p",{className:"text-sm text-muted-foreground",children:l.message})]},f))})]})})}),Ee=u.memo(function({totalMonthlyExpenses:t,totalMonthlyInvestments:s,totalPaidExpenses:m,totalPendingExpenses:l,expensesByCategory:f,investmentGoal:i,periodInvestmentGoal:h,savingsRate:b,projection12m:$,categories:p,previousMonthExpenses:H=0,previousMonthInvestments:N=0,isLoading:F=!1}){const g=u.useMemo(()=>h>0?s/h*100:0,[s,h]),o=u.useMemo(()=>p.filter(c=>c.tipo==="gasto"),[p]),d=u.useMemo(()=>o.reduce((c,x)=>c+(x.limite||0),0),[o]),Y=u.useMemo(()=>d>0?t/d*100:0,[t,d]),K=u.useMemo(()=>{const c=[];return o.forEach(x=>{const w=f[x.id]||0;if(x.limite&&w>x.limite*.8){const D=Math.round(w/x.limite*100);c.push({type:"warning",message:`Seu gasto em ${x.nome} já chegou a ${D}% do limite. Considere ajustar para sobrar mais para investimentos!`})}}),s<i*.5&&i>0&&c.push({type:"tip",message:"Que tal aumentar seus aportes? Mesmo pequenos valores fazem diferença no longo prazo!"}),t>0&&s===0&&c.push({type:"tip",message:"Tente aplicar a regra 50/30/20: 50% para necessidades, 30% para desejos e 20% para poupança e investimentos."}),c.length===0&&c.push({type:"success",message:"Parabéns! Você está no caminho certo para uma vida financeira saudável! 🎉"}),c},[o,f,s,i,t]);return e.jsxs("div",{className:"space-y-4 md:space-y-5",children:[e.jsx(Ce,{totalMonthlyExpenses:t,totalMonthlyInvestments:s,totalPaidExpenses:m,totalPendingExpenses:l,savingsRate:b,periodInvestmentGoal:h,investmentProgress:g,previousMonthExpenses:H,previousMonthInvestments:N,isLoading:F}),e.jsx(Pe,{}),e.jsx(Se,{totalMonthlyInvestments:s,periodInvestmentGoal:h,investmentProgress:g,totalMonthlyExpenses:t,totalExpenseLimit:d,expenseLimitProgress:Y}),e.jsx($e,{projection12m:$}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(Fe,{expensesByCategory:f,totalMonthlyExpenses:t,expenseCategories:o}),e.jsx(Ae,{tips:K})]})]})});function Xe(){const{expenses:n,investments:t,accounts:s,categories:m,investmentGoal:l,totalPatrimony:f,totalInvestmentBalance:i,isLoading:h}=ge(),[b,$]=u.useState("monthly"),[p,H]=u.useState(void 0),[N,F]=u.useState(new Date().getMonth()),[g,o]=u.useState(new Date().getFullYear());u.useEffect(()=>{p&&($("monthly"),F(void 0))},[p]);const d=u.useMemo(()=>{let c,x;if(p&&p.from)c=p.from,x=p.to?p.to:p.from;else if(b==="yearly"&&g)c=ve(new Date(g,0,1)),x=ye(new Date(g,11,31));else if(b==="monthly"&&N!==void 0&&g)c=T(new Date(g,N,1)),x=L(new Date(g,N,1));else{const a=new Date;c=T(a),x=L(a)}x.setHours(23,59,59,999);const w=n.filter(a=>{const r=new Date(P(a.data));return r>=c&&r<=x}),D=t.filter(a=>{const r=new Date(P(a.data));return r>=c&&r<=x}),_=w.reduce((a,r)=>a+r.valor,0),G=w.filter(a=>a.pago).reduce((a,r)=>a+r.valor,0),Q=w.filter(a=>!a.pago).reduce((a,r)=>a+r.valor,0),j=D.reduce((a,r)=>a+r.valor_aporte,0),y=m.filter(a=>a.tipo==="gasto").reduce((a,r)=>(a[r.id]=w.filter(V=>V.categoria_id===r.id).reduce((V,J)=>V+J.valor,0),a),{});let A=1;if(p&&p.from)A=Z({start:T(p.from),end:L(p.to||p.from)}).length;else if(b==="yearly"&&g){const a=new Date;g<a.getFullYear()?A=12:g>a.getFullYear()?A=0:A=a.getMonth()+1}else b==="monthly"&&N!==void 0&&g&&(A=1);const k=(Number(l)||0)*A,ce=k>0?j/k*100:0,te=s.reduce((a,r)=>a+(r.teto_gasto||1/0),1/0),le=te<1/0?Math.min(_/te*100,100):0,de=j+G>0?j/(j+G)*100:0,se=Z({start:U(new Date,2),end:new Date}),me=se.reduce((a,r)=>{const V=T(r),J=L(r),xe=t.filter(W=>{const z=P(W.data);return z>=V&&z<=J}).reduce((W,z)=>W+z.valor_aporte,0);return a+xe},0)/(se.length||1)*12,ae=T(U(c,1)),ne=L(U(x,1)),ue=n.filter(a=>{const r=P(a.data);return r>=ae&&r<=ne}).reduce((a,r)=>a+r.valor,0),pe=t.filter(a=>{const r=P(a.data);return r>=ae&&r<=ne}).reduce((a,r)=>a+r.valor_aporte,0);return{filteredExpenses:w,filteredInvestments:D,totalMonthlyExpenses:_,totalPaidExpenses:G,totalPendingExpenses:Q,totalMonthlyInvestments:j,expensesByCategory:y,investmentProgress:ce,expenseProgress:le,periodInvestmentGoal:k,savingsRate:de,projection12m:me,previousMonthExpenses:ue,previousMonthInvestments:pe}},[n,t,m,b,p,N,g,s,l]),Y=u.useMemo(()=>Z({start:U(new Date,11),end:new Date}).map(x=>{const w=Me(x,"MMM/yy"),D=T(x),_=L(x),G=n.filter(j=>{const y=P(j.data);return y>=D&&y<=_}).reduce((j,y)=>j+y.valor,0),Q=t.filter(j=>{const y=P(j.data);return y>=D&&y<=_}).reduce((j,y)=>j+y.valor_aporte,0);return{name:w,Gastos:G,Aportes:Q}}),[n,t]),K=u.useMemo(()=>{const c=[];return d.expenseProgress>90?c.push("Você está próximo do teto de gastos. Evite despesas extras!"):d.expenseProgress>70?c.push("Atenção: seus gastos estão aumentando, revise suas categorias."):c.push("Gastos dentro do limite. Continue assim!"),d.investmentProgress<50?c.push("Meta de investimentos baixa. Considere aumentar aportes!"):d.investmentProgress>=100?c.push("Parabéns! Meta de investimentos atingida."):c.push("Você está progredindo bem na meta de investimentos."),c},[d.expenseProgress,d.investmentProgress]);return e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsx("title",{children:"Dashboard - Lumify"}),e.jsx("meta",{name:"description",content:"Seu controle financeiro."})]}),e.jsxs("div",{className:"space-y-4 page-top",children:[e.jsx(be,{title:"Dashboard Financeiro",subtitle:"Visão geral das suas finanças",children:e.jsx(Ne,{periodType:b,setPeriodType:$,dateRange:p,setDateRange:H,month:N,setMonth:F,year:g,setYear:o})}),e.jsx(Ee,{totalMonthlyExpenses:d.totalMonthlyExpenses,totalMonthlyInvestments:d.totalMonthlyInvestments,totalPaidExpenses:d.totalPaidExpenses,totalPendingExpenses:d.totalPendingExpenses,expensesByCategory:d.expensesByCategory,totalAccountBalance:f,totalInvestmentBalance:i,investmentGoal:Number(l)||0,periodInvestmentGoal:d.periodInvestmentGoal,savingsRate:d.savingsRate,projection12m:d.projection12m,categories:m,expenseProgress:d.expenseProgress,investmentProgress:d.investmentProgress,educationTips:K,previousMonthExpenses:d.previousMonthExpenses,previousMonthInvestments:d.previousMonthInvestments,isLoading:h}),e.jsx(we,{data:Y})]})]})}export{Xe as DashboardPage};
